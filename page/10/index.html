<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wonderful-sea-04900b000.6.azurestaticapps.net","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Shawn Lin&#39;s Blog">
<meta property="og:url" content="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/10/index.html">
<meta property="og:site_name" content="Shawn Lin&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Xiao Lin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Shawn Lin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Shawn Lin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/10/windows11%E4%B8%8B%E4%BD%BF%E7%94%A8wslg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/10/windows11%E4%B8%8B%E4%BD%BF%E7%94%A8wslg/" class="post-title-link" itemprop="url">Windows11下使用wslg</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-10 17:33:34" itemprop="dateCreated datePublished" datetime="2021-10-10T17:33:34+08:00">2021-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>微软不愧是最佳Linux和MacOS应用开发团队。微软推出了WSL的拓展：WSLG，可以在linux子系统下运行GUI图形程序了。原理上，依然是基于Hyper-V的虚拟机，但是因为包装的很好，性能上损失比较小，运行起来也如同Windows原生GUI图形程序一样丝滑（对于第一方软件来说），但是美中不足的在于，目前对高分屏的支持不是很好。</p>
<h2 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h2><p>开始之前，首先想想为什么要用到Linux系统呢？对我来说，是因为ROS和Ignition在Ubuntu下的支持更好，所以要使用Ubuntu。但是另一方面，Autodesk全家桶只能在Windows下运行。所以，看到WSLG后我是非常兴奋的，这恰好满足了我的需求。因此，对我来说WSLG值得折腾。</p>
<h2 id="安装Win11"><a href="#安装Win11" class="headerlink" title="安装Win11"></a>安装Win11</h2><p>目前安装Windows11要在预览计划中加入Dev渠道：</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-1024x671.png"></a></p>
<p>然后检查更新后就可以升级到Windows11.</p>
<h2 id="安装WSL和WSLG"><a href="#安装WSL和WSLG" class="headerlink" title="安装WSL和WSLG"></a>安装WSL和WSLG</h2><p><a target="_blank" rel="noopener" href="https://github.com/microsoft/wslg">https://github.com/microsoft/wslg</a></p>
<p>参考wslg的github页面，我这里是之前没有安装过wsl的，所以按照以下步骤：</p>
<h2 id="Install-instructions-Fresh-Install-no-prior-WSL-installation"><a href="#Install-instructions-Fresh-Install-no-prior-WSL-installation" class="headerlink" title="Install instructions (Fresh Install - no prior WSL installation)"></a>Install instructions (Fresh Install - no prior WSL installation)</h2><p>From a command prompt with administrator privileges, run the command <code>wsl --install -d Ubuntu</code>, then reboot when prompted.</p>
<p>After reboot the installation will continue. You’ll be asked to enter a username and password. These will be your Linux credentials, they can be anything you want and don’t have to match your Windows credentials.</p>
<p>Voilà! WSL and WSLg are installed and ready to be used!</p>
<p>不过这样安装后，还需要运行一次wsl –update才能正常使用WSLg。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>首先来测试一下gedit：</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image-2.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-2-1024x554.png"></a></p>
<p>瞬间启动。再来试一试Ignition：</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image-3.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-3-1024x576.png"></a></p>
<p>也没有问题！很强。</p>
<h2 id="强大的VScode"><a href="#强大的VScode" class="headerlink" title="强大的VScode"></a>强大的VScode</h2><p>VScode瞬间变得无比强大。因为只要在当前路径下输入code .就可以<strong>在Windows的VScode中</strong>打开当前路径。</p>
<p>这还不是最强的，最强的是，<strong>在VScode的终端中，也可以打开Linux的GUI程序</strong>！</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image-4.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-4-1024x550.png"></a></p>
<p>目前暂时没有发现什么Bug。只能说一句巨硬牛逼！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/07/%E5%9C%A8linux%E4%B8%8A%E7%8E%A9%E8%8B%B1%E9%9B%84%E6%97%A0%E6%95%8C3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/07/%E5%9C%A8linux%E4%B8%8A%E7%8E%A9%E8%8B%B1%E9%9B%84%E6%97%A0%E6%95%8C3/" class="post-title-link" itemprop="url">在Linux上玩英雄无敌3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-07 13:09:13" itemprop="dateCreated datePublished" datetime="2021-10-07T13:09:13+08:00">2021-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/" itemprop="url" rel="index"><span itemprop="name">bolgs</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/%E6%9D%82%E8%B0%88/" itemprop="url" rel="index"><span itemprop="name">杂谈</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/" itemprop="url" rel="index"><span itemprop="name">thought</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/%E6%96%B0%E9%B2%9C%E4%BA%8B/" itemprop="url" rel="index"><span itemprop="name">新鲜事</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>英雄无敌3是一款非常经典的战旗游戏，小时候的我爱不释手，但实际上对我来说这款1999年的游戏还是过老了一点，所以也不算暴露年龄了。 刚开始发行的时候英雄无敌3是面向windows的，后来也出了原生的linux版本。不过linux版本的非常老旧，而且也没有继续维护了。因此就要请出今天的主角：vicm。 VICM是面向英雄无敌3的多平台开源引擎，使用它就可以在linux上畅玩英雄无敌3了。</p>
<h2 id="安装VICM"><a href="#安装VICM" class="headerlink" title="安装VICM"></a>安装VICM</h2><p><a target="_blank" rel="noopener" href="https://wiki.vcmi.eu/Installation/_on/_Linux">https://wiki.vcmi.eu/Installation\_on\_Linux</a> 如果不需要编译源代码进行开发的话，直接安装即可： To add PPA type in Terminal:</p>
<p>sudo apt-add-repository ppa:vcmi&#x2F;ppa</p>
<p>To install VCMI from repository:</p>
<p>sudo apt-get update<br>sudo apt-get install vcmi</p>
<h2 id="安装英雄无敌3"><a href="#安装英雄无敌3" class="headerlink" title="安装英雄无敌3"></a>安装英雄无敌3</h2><p>安装一个原版的windows英雄无敌3，资源自行寻找。然后，将原版文件中的Data、Maps、MP3三个文件夹拷贝到：</p>
<p>&#x2F;home&#x2F;$USER&#x2F;.local&#x2F;share&#x2F;vcmi&#x2F;</p>
<p>然后试着运行：</p>
<p>vcmiclient</p>
<p>如果启动了，那就恭喜你可以开始玩了！</p>
<h2 id="安装一些MOD"><a href="#安装一些MOD" class="headerlink" title="安装一些MOD"></a>安装一些MOD</h2><p>有一些MOD可以大大提升可玩性，比如说WOG，我小时候经常玩。有一些Mod是可以直接傻瓜式安装的，输入 vcmilauncher 打开启动器界面，在启动器界面就可以安装一些mod了，其中就包括WOG。 还有一些MOD，启动器界面不提供下载，需要到官网： <a target="_blank" rel="noopener" href="https://wiki.vcmi.eu/Mod/_list">https://wiki.vcmi.eu/Mod\_list</a> 自行下载解压后，把文件拷贝到： &#x2F;home&#x2F;$USER&#x2F;.local&#x2F;share&#x2F;vcmi&#x2F;Mods 包括一些更改分辨率的Mod。不过更改分辨率并不会提高图像质量，只是可视范围大了一些。 <a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/2021-10-07-13-08-16%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/2021-10-07-13-08-16%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-300x181.png"></a> 真是慢慢的回忆啊~</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/06/git-in-15-minutes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/06/git-in-15-minutes/" class="post-title-link" itemprop="url">Git in 15 minutes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-06 16:31:42" itemprop="dateCreated datePublished" datetime="2021-10-06T16:31:42+08:00">2021-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p># What is the Git? <a target="_blank" rel="noopener" href="https://www.notion.so/Introduction-to-Git-ac396a0697704709a12b6a0e545db049">https://www.notion.so/Introduction-to-Git-ac396a0697704709a12b6a0e545db049</a> Git is officially defined as a distributed version control system (VCS). It can be used by many people to efficiently work together, in realistic, it is mainly used by programmer and software developers. Knowing how to use git is a requirement for any developer nowadays - it doesn’t means that you can’t cooperate with others without git, but it refer to a more efficient way to work together on a project. And thanks to some git repository server such as github, you may use git as a synchronize tool or a code share tool. An important note: though github is the most popular git repository server nowadays, it IS NOT git itself. Git can run without github, even without network. It is just a control system, nothing else. You can use git in 15 minutes, but to connect your local repository to github, it may take 10 more minutes.</p>
<h2 id="1-Setup-instructions"><a href="#1-Setup-instructions" class="headerlink" title="1. Setup instructions"></a>1. Setup instructions</h2><p>Install the git: <code>sudo apt install git</code> Identify yourself with Git: NOTE: we have not talk about github, what your are identifying has nothing to do with your github account, so just set with your prefer. <code>git config --global user.name &quot;Your Name&quot; git config --global user.email &quot;your@email.com&quot;</code></p>
<h2 id="2-Repositoreis"><a href="#2-Repositoreis" class="headerlink" title="2. Repositoreis"></a>2. Repositoreis</h2><p>When working with Git, it’s important to be familiar with the term repository. A Git repository is a container for a project that is tracked by Git. There are two major types of repositories:</p>
<ol>
<li>Local repositoreis: the repositories which stored on your own local computer. You can work on it derectly.</li>
<li>Remote repositories: the repositories which stored on a remote server, such as your own server, or some popular git server provider such as Github. You can share or work with others by remote repositories.</li>
</ol>
<h2 id="3-Initializing-a-local-repository-git-init"><a href="#3-Initializing-a-local-repository-git-init" class="headerlink" title="3. Initializing a (local) repository (git init)"></a>3. Initializing a (local) repository (git init)</h2><p>To create a local repository, navigate to your work space (which means the folder storing your project), then: <code>git init</code> And it will generate a hidden .git file, which contains all data for the repository.</p>
<h2 id="4-Staging-and-committing-code-git-add-git-commit"><a href="#4-Staging-and-committing-code-git-add-git-commit" class="headerlink" title="4. Staging and committing code (git add &#x2F; git commit)"></a>4. Staging and committing code (git add &#x2F; git commit)</h2><p>Committing is the most used function in Git, it means adding your changes to the Git repository. One powerful function of Git is that it records all of your history committing, so you can compare the past commit and current commit to see changes you make. Usually you may want to commit your code to the repository after some important modifying, such as bug fixing and feature adding, etc. Before committing, you need to stage your code.</p>
<h2 id="4-1-Checking-the-status"><a href="#4-1-Checking-the-status" class="headerlink" title="4.1 Checking the status"></a>4.1 Checking the status</h2><p><code>git status</code> This is a command that is very often used when working with Git. It shows us which files have been changed, which files are tracked, etc. We can add the untracked project files to the <strong>staging area</strong> based on the information from the <code>git status</code> command.</p>
<h3 id="4-2-Staging-files"><a href="#4-2-Staging-files" class="headerlink" title="4.2 Staging files"></a>4.2 Staging files</h3><p>A most comment command is: <code>git add .</code> It add all of the current files and folders inside the current path. Also you can stage specif file by refering to the file name in the command: <code>git add file.js file2.js file3.js</code></p>
<h3 id="4-3-Making-commits"><a href="#4-3-Making-commits" class="headerlink" title="4.3 Making commits"></a>4.3 Making commits</h3><p>After adding all the files that we want to track to the staging area with the `git add` command, we are ready to make a commit. To commit the files from the staging area, we use the following command: <code>git commit -m &quot;Commit message&quot;</code> Inside the quotes, you should write a commit message. Usually, it is used to describe the changes that you make in this commit.</p>
<h3 id="4-4-Commit-history"><a href="#4-4-Commit-history" class="headerlink" title="4.4 Commit history"></a>4.4 Commit history</h3><p>To see all the commits that were made for our project, you can use the following command: <code>git log</code> This command will show you the details of each commit, such as auther name, generated hash, date, commit message. Remember that we can refer to your past commit, right? With Git, you even can GO BACK to your past commit status: <code>git checkout &lt;commit-hash&gt;</code> Replace <code>&lt;commit-hash&gt;</code> with the actual hash for the specific commit that you want to visit, which is listed with the <code>git log</code> command. And you will get a elder version of your code, your file. To go back to the latest commit (the newest version of our project code), you can type this command: <code>git checkout master</code></p>
<h3 id="4-5-Ignoring-files"><a href="#4-5-Ignoring-files" class="headerlink" title="4.5 Ignoring files"></a>4.5 Ignoring files</h3><p>To ignore files that you don’t want to be tracked or added to the staging area, you can create a file called <code>.gitignore</code> in your main project folder. Inside of that file, you can list all the file and folder names that you definitely do not want to track (each ignored file and folder should go to a new line inside the <strong>.gitignore</strong> file).</p>
<h2 id="5-Branches-git-branch-git-checkout-git-merge"><a href="#5-Branches-git-branch-git-checkout-git-merge" class="headerlink" title="5. Branches (git branch &#x2F; git checkout &#x2F; git merge)"></a>5. Branches (git branch &#x2F; git checkout &#x2F; git merge)</h2><p>What is branch? Imagine you have a strong and stable code, but now you want to do some experiment with your code. It is not a good idea to do it with your stable code, so a wise choice is to make a experiment branch on your stable code (which is called as <strong>master branch</strong>) , and edit and commit on this branch. After you are sure there is no bug, you can merge it to your master branch. By default, once you commit the code, you will get a <strong>master branch</strong>.</p>
<h3 id="5-1-Creaing-a-new-branch"><a href="#5-1-Creaing-a-new-branch" class="headerlink" title="5.1 Creaing a new branch"></a>5.1 Creaing a new branch</h3><p>You can create a new branch using the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch &lt;new-branch-name&gt;</span><br></pre></td></tr></table></figure>

<p>The new branch that gets created will be the reference to the <strong>current state</strong> of your repository.</p>
<h3 id="5-2-Changing-branches"><a href="#5-2-Changing-branches" class="headerlink" title="5.2. Changing branches"></a>5.2. Changing branches</h3><p>To switch to a different branch, you use the <strong>git checkout</strong> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;branch-name&gt;</span><br></pre></td></tr></table></figure>

<p>With that, you switch to a different isolated timeline of your project by changing branches. For example, you could be working on different features in your code and have a separate branch for each feature. When you switch to a branch, you can commit code changes which only affect that particular branch. Then, you can switch to another branch to work on a different feature, which won’t be affected by the changes and commits made from the previous branch. To create a new branch and change to it at the same time, you can use the <strong>-b</strong> flag:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b &lt;new-branch-name&gt;</span><br></pre></td></tr></table></figure>

<p>To list the branches for your project, use this command: <code>git branch</code> To go back to the <strong>master</strong> branch, use this command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br></pre></td></tr></table></figure>

<h3 id="5-3-Merging-branches"><a href="#5-3-Merging-branches" class="headerlink" title="5.3. Merging branches"></a>5.3. Merging branches</h3><p>You can merge branches in situations where you want to implement the code changes that you made in an individual branch to a different branch. For example, after you fully implemented and tested a new feature in your code, you would want to merge those changes to the stable branch of your project (which is usually the default <strong>master</strong> branch). To merge the changes from a different branch into your current branch, you can use this command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge &lt;branch-name&gt;</span><br></pre></td></tr></table></figure>

<p>You would replace <code>&lt;branch-name&gt;</code> with the branch that you want to integrate into your current branch.</p>
<h3 id="5-4-Deleting-a-branch"><a href="#5-4-Deleting-a-branch" class="headerlink" title="5.4. Deleting a branch"></a>5.4. Deleting a branch</h3><p>To delete a branch, you can run the <strong>git branch</strong> command with the <strong>-d</strong> flag:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d &lt;branch-name&gt;</span><br></pre></td></tr></table></figure>

<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6 Conclusion"></a>6 Conclusion</h2><p>Now we have most of the knowledge to use Git on our local computer. Make sure you are familiar with below command:</p>
<ol>
<li> git init</li>
<li>git add</li>
<li>git commit -m “xxxxx”</li>
<li>git status</li>
<li>git log</li>
<li>git checkout</li>
<li>git branch</li>
<li>git merge</li>
</ol>
<p>After that, you can learn how to link your local repository to the biggest and most popular online git repositories: Github.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/05/ros2%E4%B8%AD%E7%9A%84tf2%EF%BC%9A%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/05/ros2%E4%B8%AD%E7%9A%84tf2%EF%BC%9A%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">ROS2中的tf2：基本使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-05 22:46:49" itemprop="dateCreated datePublished" datetime="2021-10-05T22:46:49+08:00">2021-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="什么是TF2"><a href="#什么是TF2" class="headerlink" title="什么是TF2"></a>什么是TF2</h2><p>tf2是一个用来描述物体空间位置的工具。我们知道，用一个三维向量和一个四元数就可以描述一个物体相对于一个参考系的位置与姿态，tf2的工作属于“小而美”，它只专注于在ROS2中提供这样一个功能，就是描述一组物体之间的相对位置关系。</p>
<h2 id="为什么要使用TF2"><a href="#为什么要使用TF2" class="headerlink" title="为什么要使用TF2"></a>为什么要使用TF2</h2><p>TF2可以用于描述机器人各关节的相对位置，大大方便了运动学求解。不仅如此，在多机器人的场景中，tf2还可以用于描述机器人之间的相对位置，从而执行跟随、避障等操作。此外，tf2也可以用于描述目标物体与机器人的相对位置。总而言之，定位是机器人控制中不可或缺的一环，而tf2大大方便了ros2中对机器人的定位。</p>
<h2 id="如何使用TF2：发布tf消息"><a href="#如何使用TF2：发布tf消息" class="headerlink" title="如何使用TF2：发布tf消息"></a>如何使用TF2：发布tf消息</h2><p>和所有ROS应用一样，使用tf2的主体也是Node。简介起见，这里我们跳过所有的package create、build和setup.py修改环节，只来看ROS2官方的实例程序：</p>
<p>from geometry_msgs.msg import TransformStamped</p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from tf2_ros import TransformBroadcaster</p>
<p>import tf_transformations</p>
<p>from turtlesim.msg import Pose</p>
<p>class FramePublisher(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;turtle\_tf2\_frame\_publisher&#39;)

    # Declare and acquire \`turtlename\` parameter
    self.declare\_parameter(&#39;turtlename&#39;, &#39;turtle&#39;)
    self.turtlename = self.get\_parameter(
        &#39;turtlename&#39;).get\_parameter\_value().string\_value

    # Initialize the transform broadcaster
    self.br = TransformBroadcaster(self)

    # Subscribe to a turtle&#123;1&#125;&#123;2&#125;/pose topic and call handle\_turtle\_pose
    # callback function on each message
    self.subscription = self.create\_subscription(
        Pose,
        f&#39;/&#123;self.turtlename&#125;/pose&#39;,
        self.handle\_turtle\_pose,
        1)
    self.subscription

def handle\_turtle\_pose(self, msg):
    t = TransformStamped()

    # Read message content and assign it to
    # corresponding tf variables
    t.header.stamp = self.get\_clock().now().to\_msg()
    t.header.frame\_id = &#39;world&#39;
    t.child\_frame\_id = self.turtlename

    # Turtle only exists in 2D, thus we get x and y translation
    # coordinates from the message and set the z coordinate to 0
    t.transform.translation.x = msg.x
    t.transform.translation.y = msg.y
    t.transform.translation.z = 0.0

    # For the same reason, turtle can only rotate around one axis
    # and this why we set rotation in x and y to 0 and obtain
    # rotation in z axis from the message
    q = tf\_transformations.quaternion\_from\_euler(0, 0, msg.theta)
    t.transform.rotation.x = q\[0\]
    t.transform.rotation.y = q\[1\]
    t.transform.rotation.z = q\[2\]
    t.transform.rotation.w = q\[3\]

    # Send the transformation
    self.br.sendTransform(t)
</code></pre>
<p>def main():<br>    rclpy.init()<br>    node &#x3D; FramePublisher()<br>    try:<br>        rclpy.spin(node)<br>    except KeyboardInterrupt:<br>        pass</p>
<pre><code>rclpy.shutdown()
</code></pre>
<h3 id="代码导读"><a href="#代码导读" class="headerlink" title="代码导读"></a>代码导读</h3><p>from geometry_msgs.msg import TransformStamped</p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from tf2_ros import TransformBroadcaster</p>
<p>import tf_transformations</p>
<p>from turtlesim.msg import Pose</p>
<p>TF2的数据传递格式为geometry_msgs中的TransformStamped。</p>
<p>此外，还需要从tf2_ros中导入TransformBroadcaster，用于发布消息，这和一般的Node不同。</p>
<p>tf_transformations提供将方位角转化为四元数的功能。</p>
<p>turtlesim.msg中的Pose属于自定义的数据类型，由一个Vector3和一个方位角数组组成。</p>
<p>class FramePublisher(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;turtle\_tf2\_frame\_publisher&#39;)

    # Declare and acquire \`turtlename\` parameter
    self.declare\_parameter(&#39;turtlename&#39;, &#39;turtle&#39;)
    self.turtlename = self.get\_parameter(
        &#39;turtlename&#39;).get\_parameter\_value().string\_value

    # Initialize the transform broadcaster
    self.br = TransformBroadcaster(self)

    # Subscribe to a turtle&#123;1&#125;&#123;2&#125;/pose topic and call handle\_turtle\_pose
    # callback function on each message
    self.subscription = self.create\_subscription(
        Pose,
        f&#39;/&#123;self.turtlename&#125;/pose&#39;,
        self.handle\_turtle\_pose,
        1)
    self.subscription
</code></pre>
<p>首先使用self.declare_parameter(‘turtlename’, ‘turtle’)声明了一个参数，其值为“turtle”。然后赋值给self.turtlename。</p>
<p>下一步比较特殊：self.br &#x3D; TransformBroadcaster(self)，这样声明了一个TransformBroadcaster。</p>
<p>另一方面，这个Node订阅了turtle&#x2F;pose这个话题，在下面可以看到脚本是如何将Pose类型转化为TransformStamped类型的。</p>
<p>def handle_turtle_pose(self, msg):<br>    t &#x3D; TransformStamped()</p>
<pre><code># Read message content and assign it to
# corresponding tf variables
t.header.stamp = self.get\_clock().now().to\_msg()
t.header.frame\_id = &#39;world&#39;
t.child\_frame\_id = self.turtlename

# Turtle only exists in 2D, thus we get x and y translation
# coordinates from the message and set the z coordinate to 0
t.transform.translation.x = msg.x
t.transform.translation.y = msg.y
t.transform.translation.z = 0.0

# For the same reason, turtle can only rotate around one axis
# and this why we set rotation in x and y to 0 and obtain
# rotation in z axis from the message
q = tf\_transformations.quaternion\_from\_euler(0, 0, msg.theta)
t.transform.rotation.x = q\[0\]
t.transform.rotation.y = q\[1\]
t.transform.rotation.z = q\[2\]
t.transform.rotation.w = q\[3\]

# Send the transformation
self.br.sendTransform(t)
</code></pre>
<p>t &#x3D; TransformStamped()初始化了一个TransformStamped消息类型。</p>
<p>t.header.stamp &#x3D; self.get_clock().now().to_msg()指定了header中的时间戳，一般即为Node的内部时钟时间。</p>
<p>t.header.frame_id &#x3D; ‘world’指定了header中的参照系，这里使用的是world，也就是世界参考系。</p>
<p>t.child_frame_id &#x3D; self.turtlename指定了本征参考系，也就是turtle。</p>
<p>接下来的操作都是将Pose转化为TransformStamped的过程，其中使用到了tf_transformations.quaternion_from_euler来将姿态角转化为四元数。</p>
<p>最后，使用self.br.sendTransform(t)发送消息。</p>
<p>这里有人发现了，这都没有指定向哪个话题发送消息，这怎么就发出去了呢？实际上，所有的tf消息都会发送到一个话题内：&#x2F;tf。那么，如何处理多个tf消息呢？这个之后再谈。</p>
<h2 id="如何使用TF2：接受tf消息"><a href="#如何使用TF2：接受tf消息" class="headerlink" title="如何使用TF2：接受tf消息"></a>如何使用TF2：接受tf消息</h2><p>import math</p>
<p>from geometry_msgs.msg import Twist</p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from tf2_ros import TransformException<br>from tf2_ros.buffer import Buffer<br>from tf2_ros.transform_listener import TransformListener</p>
<p>from turtlesim.srv import Spawn</p>
<p>class FrameListener(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;turtle\_tf2\_frame\_listener&#39;)

    # Declare and acquire \`target\_frame\` parameter
    self.declare\_parameter(&#39;target\_frame&#39;, &#39;turtle1&#39;)
    self.target\_frame = self.get\_parameter(
        &#39;target\_frame&#39;).get\_parameter\_value().string\_value

    self.tf\_buffer = Buffer()
    self.tf\_listener = TransformListener(self.tf\_buffer, self)

    # Create a client to spawn a turtle
    self.spawner = self.create\_client(Spawn, &#39;spawn&#39;)
    # Boolean values to store the information
    # if the service for spawning turtle is available
    self.turtle\_spawning\_service\_ready = False
    # if the turtle was successfully spawned
    self.turtle\_spawned = False

    # Create turtle2 velocity publisher
    self.publisher = self.create\_publisher(Twist, &#39;turtle2/cmd\_vel&#39;, 1)

    # Call on\_timer function every second
    self.timer = self.create\_timer(1.0, self.on\_timer)

def on\_timer(self):
    # Store frame names in variables that will be used to
    # compute transformations
    from\_frame\_rel = self.target\_frame
    to\_frame\_rel = &#39;turtle2&#39;

    if self.turtle\_spawning\_service\_ready:
        if self.turtle\_spawned:
            # Look up for the transformation between target\_frame and turtle2 frames
            # and send velocity commands for turtle2 to reach target\_frame
            try:
                now = rclpy.time.Time()
                trans = self.tf\_buffer.lookup\_transform(
                    to\_frame\_rel,
                    from\_frame\_rel,
                    now)
            except TransformException as ex:
                self.get\_logger().info(
                    f&#39;Could not transform &#123;to\_frame\_rel&#125; to &#123;from\_frame\_rel&#125;: &#123;ex&#125;&#39;)
                return

            msg = Twist()
            scale\_rotation\_rate = 1.0
            msg.angular.z = scale\_rotation\_rate \* math.atan2(
                trans.transform.translation.y,
                trans.transform.translation.x)

            scale\_forward\_speed = 0.5
            msg.linear.x = scale\_forward\_speed \* math.sqrt(
                trans.transform.translation.x \*\* 2 +
                trans.transform.translation.y \*\* 2)

            self.publisher.publish(msg)
        else:
            if self.result.done():
                self.get\_logger().info(
                    f&#39;Successfully spawned &#123;self.result.result().name&#125;&#39;)
                self.turtle\_spawned = True
            else:
                self.get\_logger().info(&#39;Spawn is not finished&#39;)
    else:
        if self.spawner.service\_is\_ready():
            # Initialize request with turtle name and coordinates
            # Note that x, y and theta are defined as floats in turtlesim/srv/Spawn
            request = Spawn.Request()
            request.name = &#39;turtle2&#39;
            request.x = float(4)
            request.y = float(2)
            request.theta = float(0)
            # Call request
            self.result = self.spawner.call\_async(request)
            self.turtle\_spawning\_service\_ready = True
        else:
            # Check if the service is ready
            self.get\_logger().info(&#39;Service is not ready&#39;)
</code></pre>
<p>def main():<br>    rclpy.init()<br>    node &#x3D; FrameListener()<br>    try:<br>        rclpy.spin(node)<br>    except KeyboardInterrupt:<br>        pass</p>
<pre><code>rclpy.shutdown()
</code></pre>
<p>主要看着两个地方：</p>
<pre><code>self.tf\_buffer = Buffer()
self.tf\_listener = TransformListener(self.tf\_buffer, self)
</code></pre>
<p>这里相当于是初始化了一个对tf的subscriber。</p>
<pre><code>        # Look up for the transformation between target\_frame and turtle2 frames
        # and send velocity commands for turtle2 to reach target\_frame
        try:
            now = rclpy.time.Time()
            trans = self.tf\_buffer.lookup\_transform(
                to\_frame\_rel,
                from\_frame\_rel,
                now)
        except TransformException as ex:
            self.get\_logger().info(
                f&#39;Could not transform &#123;to\_frame\_rel&#125; to &#123;from\_frame\_rel&#125;: &#123;ex&#125;&#39;)
            return
</code></pre>
<p>这里可以看到，获取transform的方式为使用tf_buffer.lookup_transform。使用的时候，要提供to_frame_rel，from_frame_rel，和当前的时间戳。</p>
<h2 id="tf消息收发总结"><a href="#tf消息收发总结" class="headerlink" title="tf消息收发总结"></a>tf消息收发总结</h2><p>发送：</p>
<p>self.br &#x3D; TransformBroadcaster(self)</p>
<p>t &#x3D; TransformStamped()</p>
<p>self.br.sendTransform(t)</p>
<p>收取：</p>
<p>self.tf_buffer &#x3D; Buffer()</p>
<p>self.tf_listener &#x3D; TransformListener(self.tf_buffer, self)</p>
<p>now &#x3D; rclpy.time.Time()</p>
<p>trans &#x3D; self.tf_buffer.lookup_transform( to_frame_rel, from_frame_rel, now)</p>
<h2 id="增加参考系"><a href="#增加参考系" class="headerlink" title="增加参考系"></a>增加参考系</h2><p>前面说到，所有的tf消息都发送到一个话题&#x2F;tf上，那么tf是如何处理多参考系的呢？这里就需要提到“tf tree”了，这是一种组织参考系的方式：</p>
<p><img src="https://docs.ros.org/en/foxy/_images/turtlesim_frames.png" alt="..&#x2F;..&#x2F;_images&#x2F;turtlesim_frames.png"></p>
<p>如图所示，这样的一颗tf tree描述了world和turtle2、turtle1之间的关系。虽然没有给出turtle2和turtle1之间直接的参考关系，但是根据word-turtle1、world-turtle2之间的关系，前者也可以很方便的计算出来。</p>
<p>这也就是为什么TransformStamped的header中有parent_frame和child_frame了，为的就是将多个tf信息汇总到一个topic中，同时还能彼此区分。</p>
<p>下面就来展示，如何在现有的tf消息基础上增加一个frame。</p>
<p>from geometry_msgs.msg import TransformStamped</p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from tf2_ros import TransformBroadcaster</p>
<p>class FixedFrameBroadcaster(Node):</p>
<p>   def __init__(self):<br>      super().__init__(‘fixed_frame_tf2_broadcaster’)<br>      self.br &#x3D; TransformBroadcaster(self)<br>      self.timer &#x3D; self.create_timer(0.1, self.broadcast_timer_callback)</p>
<p>   def broadcast_timer_callback(self):<br>      t &#x3D; TransformStamped()<br>      t.header.stamp &#x3D; self.get_clock().now().to_msg()<br>      t.header.frame_id &#x3D; ‘turtle1’<br>      t.child_frame_id &#x3D; ‘carrot1’<br>      t.transform.translation.x &#x3D; 0.0<br>      t.transform.translation.y &#x3D; 2.0<br>      t.transform.translation.z &#x3D; 0.0<br>      t.transform.rotation.x &#x3D; 0.0<br>      t.transform.rotation.y &#x3D; 0.0<br>      t.transform.rotation.z &#x3D; 0.0<br>      t.transform.rotation.w &#x3D; 1.0</p>
<pre><code>  self.br.sendTransform(t)
</code></pre>
<p>def main():<br>   rclpy.init()<br>   node &#x3D; FixedFrameBroadcaster()<br>   try:<br>      rclpy.spin(node)<br>   except KeyboardInterrupt:<br>      pass</p>
<p>   rclpy.shutdown()</p>
<p>如上，只要用TransformBroadcaster再发送一个TransformStamped就行了。非常的快速，非常的便捷。下一篇博客我们来看看tf2的一些高级特性和debug方法。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/05/%E7%A9%BA%E5%9F%9F%E6%BB%A4%E6%B3%A2%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/05/%E7%A9%BA%E5%9F%9F%E6%BB%A4%E6%B3%A2%E5%99%A8/" class="post-title-link" itemprop="url">空域滤波器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-05 11:27:02" itemprop="dateCreated datePublished" datetime="2021-10-05T11:27:02+08:00">2021-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>仅根据单个点往往无法判断其属性（噪声、边缘），因此要考虑其领域。滤波器，或者说卷积核往往用来进行领域运算。在深度学习中，这个滤波器的参数是由学习得到的；而在传统图像处理中，卷积模板一般是人工设定的。那么根据不同的目标应当如何设计卷积模板呢？</p>
<p>滤波器可以笼统地分为两类：</p>
<ol>
<li>平滑&#x2F;锐化</li>
<li>线性&#x2F;非线性</li>
</ol>
<h1 id="平滑滤波器"><a href="#平滑滤波器" class="headerlink" title="平滑滤波器"></a>平滑滤波器</h1><h2 id="线性平滑滤波器"><a href="#线性平滑滤波器" class="headerlink" title="线性平滑滤波器"></a>线性平滑滤波器</h2><p>具体地，常用的平滑滤波器（以下都默认为3x3的卷积核）有：</p>
<ol>
<li>领域平均（平滑滤波器），所有系数大于0</li>
<li>加权平均（平滑滤波器），所有系数大于0<ol>
<li>特别的，高斯滤波器，距离像素点越近，系数越大。在平滑的同时，对图像模糊的程度较小。</li>
</ol>
</li>
<li>几何均值滤波器</li>
</ol>
<h3 id="影响线性平滑滤波器的因素"><a href="#影响线性平滑滤波器的因素" class="headerlink" title="影响线性平滑滤波器的因素"></a>影响线性平滑滤波器的因素</h3><ol>
<li>模板的形状<ol>
<li>方形：计算量大</li>
<li>其他形状：十字、X、空洞卷积、JRPG移动范围形……</li>
</ol>
</li>
<li>模板的尺寸，尺寸越大，丢失细节越多</li>
<li>模板的参数</li>
</ol>
<h3 id="平滑滤波器的问题"><a href="#平滑滤波器的问题" class="headerlink" title="平滑滤波器的问题"></a>平滑滤波器的问题</h3><ol>
<li>去除噪音的同时也钝化了边缘和尖锐的细节</li>
</ol>
<h2 id="非线性平滑滤波器"><a href="#非线性平滑滤波器" class="headerlink" title="非线性平滑滤波器"></a>非线性平滑滤波器</h2><ol>
<li>中值滤波：用卷积核内的中值作为结果值。处理空间密度很大的椒盐噪声时效果不好。<ol>
<li>改进：如果不太可能是椒盐噪声的，就保留当前中心点的像素值</li>
</ol>
</li>
<li>自适应中值滤波器：选择中值的时候可以适应，模板大小可以自适应</li>
<li>统计排序滤波器</li>
<li>最大值&#x2F;最小值&#x2F;中点&#x2F;百分比滤波器</li>
<li>自适应、局部噪声消除滤波器</li>
</ol>
<h2 id="双边滤波器"><a href="#双边滤波器" class="headerlink" title="双边滤波器"></a>双边滤波器</h2><h1 id="锐化滤波器"><a href="#锐化滤波器" class="headerlink" title="锐化滤波器"></a>锐化滤波器</h1><p>积分——钝化 微分——锐化</p>
<p>Sobel梯度算子：一阶微分用的最多的算子，对噪声有抑制作用，特征保持更好</p>
<p>Robert梯度算子</p>
<p>锐化后与源图像叠加，解决亮度丢失问题，同时增强边缘</p>
<p>拉普拉斯算子：二阶算子，更突出边缘</p>
<hr>
<h1 id="混合空间增强方法"><a href="#混合空间增强方法" class="headerlink" title="混合空间增强方法"></a>混合空间增强方法</h1><p>混合的基于空域变换的增强图片的方法</p>
<p>拉普拉斯算子锐化时不光增强边界，还增强了噪声区域：</p>
<p>再叠加一次sobel算子，去除噪声，然后与拉普拉斯算子处理的图像进行一次<strong>相乘</strong></p>
<p>最后整体偏暗，则进行直方图变换。</p>
<h2 id="边界处理"><a href="#边界处理" class="headerlink" title="边界处理"></a>边界处理</h2><ol>
<li>补0：方便，但是会使得边缘变暗</li>
<li>拷贝：对边缘的卷积不起作用</li>
<li>镜像：对梯度求解效果更好</li>
</ol>
<p>空域滤波的所有方法都是可迭代的——嵌套，大卷积核不如多个小卷积核的组合</p>
<p>卷积时用新值还是旧值？</p>
<ul>
<li>新值：节省空间，加快迭代；但是处理不平衡</li>
<li>旧值：效果更好</li>
</ul>
<p>医学等领域限制使用非线性滤波器（不能改变原来像素的分布）</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/04/%E5%9C%A8jetson-nano-raspberry-pi%E4%B8%8A%E6%90%AD%E5%BB%BAros2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/04/%E5%9C%A8jetson-nano-raspberry-pi%E4%B8%8A%E6%90%AD%E5%BB%BAros2/" class="post-title-link" itemprop="url">在Jetson nano/Raspberry Pi上搭建ROS2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-04 22:13:24" itemprop="dateCreated datePublished" datetime="2021-10-04T22:13:24+08:00">2021-10-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/embedded/" itemprop="url" rel="index"><span itemprop="name">embedded</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/embedded/%E6%A0%91%E8%8E%93%E6%B4%BE/" itemprop="url" rel="index"><span itemprop="name">树莓派</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Jetson Nano and Raspberry Pi have similar configuration and application scenario, which make it meaningful to compare these two popular single board computer to find out which is the best host for ros2.</p>
<p>A significant difference between Jetson Nano and Raspberry Pi is that Jetson Nano has a powerful GPU computer unit, which enable Jetson Nano process some machine learning related task such as object detection and face recognization.</p>
<p>However, another subtle difference is often overlooked, which is that Pi has a more powerful GPIO than Jetson Nano. Officially, Pi and Jetson can both output a 3.3v level through GPIO, however test shows thats Jetson Nano has lower level when pin is set to high level (1.4v-1.5v). Yes it can lit a LED, but if used to control a relay, it might won’t work. On the contrary, it is totally OK with Pi to output 3.3v precisely. Of course you can always use external control board such as Arduino to do hardware control work, but you may use a Pi to do some work which need a Jetson Nano and an Arduino.</p>
<p>And another import difference between Pi and Jetson: Jetson officially support only ubuntu18.04, which is the base of current JetPack. However ROS2 required ubuntu20.04, so there are two ways to run ROS2 on the Jetson:</p>
<ol>
<li>Install the xubuntu20.04 for Jetson Nano, it is not released by Nvidia but it works: <a target="_blank" rel="noopener" href="https://forums.developer.nvidia.com/t/xubuntu-20-04-focal-fossa-l4t-r32-3-1-custom-image-for-the-jetson-nano/121768">https://forums.developer.nvidia.com/t/xubuntu-20-04-focal-fossa-l4t-r32-3-1-custom-image-for-the-jetson-nano/121768</a></li>
<li>Use docker to install the ROS2 on a official JetPack OS: <a target="_blank" rel="noopener" href="https://developer.nvidia.com/blog/implementing-robotics-applications-with-ros-2-and-ai-on-jetson-platform-2/">https://developer.nvidia.com/blog/implementing-robotics-applications-with-ros-2-and-ai-on-jetson-platform-2/</a></li>
</ol>
<p>If GPIO is required, the solution 1 is suggest, because using docker may leads to a lot of permission issues.</p>
<p>For the Pi, you can install a ubuntu mate 20.04 , which is support officially for Raspberry Pi: <a target="_blank" rel="noopener" href="https://ubuntu-mate.org/raspberry-pi/download/">https://ubuntu-mate.org/raspberry-pi/download/</a></p>
<p>Or, you can install the official ubuntu 20.04, and install a desktop environment later. However ubuntu mate is strongly suggest, for it can minimize the configure work, in the while provide a quite stable and efficient desktop environment.</p>
<p>So, know your demand, choose your hardware and OS, let’s start to install ROS2.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Assume you have a board with a ubuntu20.04, it does not matter if you use a Jetson Nano or Pi.</p>
<h2 id="Install-Clash"><a href="#Install-Clash" class="headerlink" title="Install Clash"></a>Install Clash</h2><p>Special for Chinese user: If you visit Google and Github without any problem, just skip it.</p>
<p>Use Clash and proxychains to view, curl and wget from Github.</p>
<p>Release for Clash (ArmV7): <a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash/releases">https://github.com/Dreamacro/clash/releases</a></p>
<p>You need to buy an account to use Clash: <a target="_blank" rel="noopener" href="https://shadowfly.cloud/">https://shadowfly.cloud/</a></p>
<p>Follow the Linux installing introduction to use the Clash.</p>
<p>After you run the clash, it will generalize two bridge in default: <a target="_blank" rel="noopener" href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a>, socks5:&#x2F;&#x2F;127.0.0.1:7891. Configure the proxy regarding which operation system you are using.</p>
<h2 id="Install-Proxychains"><a href="#Install-Proxychains" class="headerlink" title="Install Proxychains"></a>Install Proxychains</h2><p>Even if the clash or other VPN is running, the bash will not use the proxy automatically, so proxychains is needed to use proxy with the bash.</p>
<p>First, install the proxychains:</p>
<p>sudo apt install proxychains</p>
<p>Then, configure the proxychains:</p>
<p>sudo nano &#x2F;etc&#x2F;proxychains.conf</p>
<p>Modify the last row to “http 127.0.0.1 7890”</p>
<p>There you can use proxychains after sudo and before other command to use the proxy.</p>
<h2 id="Install-ROS2-Package"><a href="#Install-ROS2-Package" class="headerlink" title="Install ROS2 Package"></a>Install ROS2 Package</h2><p>Follow the official document to install the ROS2. For some command, you may need to add proxychains, such as :</p>
<p>sudo proxychains curl -sSL <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/ros/rosdistro/master/ros.key">https://raw.githubusercontent.com/ros/rosdistro/master/ros.key</a>  -o &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;ros-archive-keyring.gpg</p>
<h2 id="Install-colcon-build"><a href="#Install-colcon-build" class="headerlink" title="Install colcon build"></a>Install colcon build</h2><p>sudo apt install python3-colcon-common-extensions</p>
<h2 id="Ready-to-GO"><a href="#Ready-to-GO" class="headerlink" title="Ready to GO"></a>Ready to GO</h2><p>Now you can build your own ros project and run it!</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/09/20/%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%96%87%E4%BB%B6%E5%B0%BA%E5%AF%B8%E8%B6%85%E8%BF%87upload-max-filesize%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84php-ini%E5%80%BC%E7%9A%84%E8%A7%A3%E5%86%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/20/%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%96%87%E4%BB%B6%E5%B0%BA%E5%AF%B8%E8%B6%85%E8%BF%87upload-max-filesize%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84php-ini%E5%80%BC%E7%9A%84%E8%A7%A3%E5%86%B3/" class="post-title-link" itemprop="url">上传的文件尺寸超过upload_max_filesize文件中定义的php.ini值的解决方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-20 17:35:20" itemprop="dateCreated datePublished" datetime="2021-09-20T17:35:20+08:00">2021-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/" itemprop="url" rel="index"><span itemprop="name">tech</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/wordpress/" itemprop="url" rel="index"><span itemprop="name">wordpress</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/live41/p/14736986.html">https://www.cnblogs.com/live41/p/14736986.html</a></p>
<p>WordPress上传主题，报“上传的文件尺寸超过upload_max_filesize文件中定义的php.ini值”错误。解决方法：</p>
<p>1.查找php.ini的位置</p>
<p>find &#x2F; -name php.ini</p>
<p>* 一般是&#x2F;etc&#x2F;php&#x2F;(版本号)&#x2F;apache2&#x2F;php.ini</p>
<p>2.打开php.ini</p>
<p>sudo vim php.ini</p>
<p>3.输入&#x2F;，分别搜索upload_max_filesize及post_max_size属性并改大属性值。</p>
<p>4.重启Apache</p>
<p>sudo systemctl restart apache2</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/09/20/ros2ignitionpython%E5%B7%A5%E4%BD%9C%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/20/ros2ignitionpython%E5%B7%A5%E4%BD%9C%E6%B5%81/" class="post-title-link" itemprop="url">ROS2+Ignition+Python工作流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-20 14:59:57" itemprop="dateCreated datePublished" datetime="2021-09-20T14:59:57+08:00">2021-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>之前和Dolly在the construction上一起探索了ROS2，下面来看看一个更加面向未来的开发工作流：ROS2+Ignition+Python。而且这次，我们从头在自己的电脑上开始配置环境。</p>
<h2 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h2><p>安装以下依赖：</p>
<p>sudo apt install python3-colcon-common-extensions<br>sudo apt install python3-catkin-pkg</p>
<p>有时候python3-catkin-pkg虽然安装了，在编译过程中还是会显示找不到catkin_pkg。我卸载重装后就好了，仅供参考。</p>
<h2 id="新建一个Work-space"><a href="#新建一个Work-space" class="headerlink" title="新建一个Work space"></a>新建一个Work space</h2><p>ROS的官网是这么说的：</p>
<blockquote>
<p>Our workspace, <code>ros2_examples_ws</code>, will be an <strong>overlay</strong> on top of the existing ROS 2 installation. In general, it is recommended to use an overlay when you plan to iterate on a small number of packages, rather than putting all of your packages into the same workspace.</p>
</blockquote>
<p>简单来说，就是为你的项目建立一个单独的work space，而不是把他们全部都堆在ROS2的主路径下。</p>
<p>新建一个work space很简单，一个有标识性的ws folder，然后在里面创建一个src空文件夹。你的文件夹应该是这样的：</p>
<p>.<br>└── src</p>
<p>1 directory, 0 files</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-6.png"></p>
<p>我这里已经编译过了，所以有别的文件夹。最开始时，除了src以外，不应该有其他任何文件。</p>
<h2 id="试运行：Dolly"><a href="#试运行：Dolly" class="headerlink" title="试运行：Dolly"></a>试运行：Dolly</h2><p>进入src文件夹，所有的package都应该在这里创建、编辑。下载Dolly：</p>
<p>git clone <a target="_blank" rel="noopener" href="https://github.com/chapulina/dolly.git">https://github.com/chapulina/dolly.git</a></p>
<p>然后<strong>到ws的主路径下进行编译</strong>，这很重要。这里要ignore dolly_gazebo这个包，因为我们只安装了ignition：</p>
<p>rosdep install –from-paths src –ignore-src -r -y<br>colcon build –symlink-install –packages-ignore dolly_gazebo</p>
<p>编译完成后，试着运行dolly。首先设置环境变量（你自己的路径）：</p>
<p> . ~&#x2F;ws&#x2F;install&#x2F;setup.bash</p>
<p>然后使用ros2 launch运行：</p>
<p> ros2 launch dolly_ignition dolly.launch.py</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-7-1024x361.png"></p>
<p>可以看到rviz2和ignition gazebo的窗口。</p>
<h2 id="创建package"><a href="#创建package" class="headerlink" title="创建package"></a>创建package</h2><p>接下来我们创建自己的package，不同之处在于，这次使用基于python的pkg。确保在ws的src文件下，新建一个pkg：</p>
<p>ros2 pkg create –build-type ament_python my_dolly</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-8.png"></p>
<p>python的ros2结构如上，其中launch这个文件夹一开始是没有的，这里也创建了，有用。然后在launch file里创建一个文件：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-9.png"></p>
<p>import os</p>
<p>from ament_index_python.packages import get_package_share_directory<br>from launch import LaunchDescription<br>from launch.actions import DeclareLaunchArgument<br>from launch.actions import IncludeLaunchDescription<br>from launch.conditions import IfCondition<br>from launch.launch_description_sources import PythonLaunchDescriptionSource<br>from launch.substitutions import LaunchConfiguration<br>from launch_ros.actions import Node</p>
<p>def generate_launch_description():</p>
<pre><code>pkg\_ros\_ign\_gazebo = get\_package\_share\_directory(&#39;ros\_ign\_gazebo&#39;)
pkg\_dolly\_ignition = get\_package\_share\_directory(&#39;dolly\_ignition&#39;)

# Gazebo launch
gazebo = IncludeLaunchDescription(
    PythonLaunchDescriptionSource(
        os.path.join(pkg\_ros\_ign\_gazebo, &#39;launch&#39;, &#39;ign\_gazebo.launch.py&#39;),
    ),
)

spawn = Node(package=&#39;ros\_ign\_gazebo&#39;, executable=&#39;create&#39;,
             arguments=\[
                &#39;-name&#39;, &#39;dolly&#39;,
                &#39;-x&#39;, &#39;5.0&#39;,
                &#39;-z&#39;, &#39;0.46&#39;,
                &#39;-Y&#39;, &#39;1.57&#39;,
                &#39;-file&#39;, os.path.join(pkg\_dolly\_ignition, &#39;models&#39;, &#39;dolly\_ignition&#39;,
                                      &#39;model.sdf&#39;)\],
             output=&#39;screen&#39;)

return LaunchDescription(\[
    DeclareLaunchArgument(
      &#39;ign\_args&#39;,
      default\_value=\[os.path.join(pkg\_dolly\_ignition, &#39;worlds&#39;, &#39;station.sdf&#39;) +
                     &#39; -v 2 --gui-config &#39; +
                     os.path.join(pkg\_dolly\_ignition, &#39;ign&#39;, &#39;gui.config&#39;), &#39;&#39;\],
      description=&#39;Ignition Gazebo arguments&#39;),
    gazebo,
    spawn,
\])
</code></pre>
<p>基本上照抄dolly_ignition里的launchfile，不过把好几个Node都删掉了，保留了_Gazebo launch_和Spawn dolly。不同的是，如果是c++的架构，编译后launch file就可以用了，<strong>在python架构里，需要修改setup.py里的内容，加上一行：</strong></p>
<p>from glob import glob</p>
<p>setup(<br>    …<br>    data_files&#x3D;[<br>        ….<br>        (‘share&#x2F;‘ + package_name, glob(‘launch&#x2F;*.launch.py’))<br>    ],<br>    …<br>)</p>
<p>接下来回到ws主目录，编译my_dolly：</p>
<p>colcon build –packages-select my_dolly</p>
<p>然后launch dolly：</p>
<p>ros2 launch my_dolly my_dolly.launch.py</p>
<p>效果相同。</p>
<h2 id="Python-Subscriber"><a href="#Python-Subscriber" class="headerlink" title="Python Subscriber"></a>Python Subscriber</h2><p>类似的，创建一个Node。所有的Node源码都放在同名文件夹下，与__init__.py放在一起：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-10.png"></p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from sensor_msgs.msg import LaserScan</p>
<p>class LaserScanner(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;laser\_scanner&#39;)
    self.subscription = self.create\_subscription(
        LaserScan,
        &#39;/dolly/laser\_scan&#39;,
        self.listener\_callback,
        10)
    self.subscription  # prevent unused variable warning

def listener\_callback(self, msg):
    self.get\_logger().info(&#39;I heard: &quot;%f&quot;&#39; % msg.ranges\[0\])
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>laser\_scanner = LaserScanner()

rclpy.spin(laser\_scanner)

# Destroy the node explicitly
# (optional - otherwise it will be done automatically
# when the garbage collector destroys the node object)
laser\_scanner.destroy\_node()
rclpy.shutdown()
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<p>不禁感叹，python真是高级语言啊，比c++写的简介多了。前面编辑launchfile的时候，需要到setup.py里调整参数，这里也是一样的，从而让ros2 run能找到源文件。</p>
<pre><code>entry\_points=&#123;
    &#39;console\_scripts&#39;: \[
        &#39;laser\_scan = my\_dolly.laser\_scan:main&#39;,
    \],
&#125;,
</code></pre>
<p>然后，我们再试试把它加到launch file里，让他和其他Node一起启动：（此时还需要启动ign_ros_bridge，怎么写参考dolly_ignition的Node）</p>
<pre><code>#laser
laser = Node(
    package=&#39;my\_dolly&#39;,
    executable=&#39;laser\_scan&#39;,
    output=&#39;screen&#39;,
)

return LaunchDescription(\[
    DeclareLaunchArgument(
      &#39;ign\_args&#39;,
      default\_value=\[os.path.join(pkg\_dolly\_ignition, &#39;worlds&#39;, &#39;station.sdf&#39;) +
                     &#39; -v 2 --gui-config &#39; +
                     os.path.join(pkg\_dolly\_ignition, &#39;ign&#39;, &#39;gui.config&#39;), &#39;&#39;\],
      description=&#39;Ignition Gazebo arguments&#39;),
    gazebo,
    spawn,
    bridge,
    laser,
\])
</code></pre>
<p>编译后启动，可以看到打印出来的传感器数据：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-11-1024x806.png"></p>
<p>总结一下，Node放在同名文件夹里，在setup.py里修改entry_point来让ros2找到启动路径。</p>
<h2 id="Python-Publisher"><a href="#Python-Publisher" class="headerlink" title="Python Publisher"></a>Python Publisher</h2><p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-13.png"></p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from geometry_msgs.msg import Twist</p>
<p>class MovingRobot(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;moving\_robot&#39;)
    self.publisher\_ = self.create\_publisher(Twist, &#39;/dolly/cmd\_vel&#39;, 10)
    timer\_period = 0.5  # seconds
    self.timer = self.create\_timer(timer\_period, self.timer\_callback)
    self.i = 0

def timer\_callback(self):
    msg = Twist()
    msg.linear.x = 0.5
    msg.angular.z = 0.3
    self.publisher\_.publish(msg)
    self.get\_logger().info(str(msg))
    self.i += 1
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>moving\_robot = MovingRobot()

rclpy.spin(moving\_robot)

# Destroy the node explicitly
# (optional - otherwise it will be done automatically
# when the garbage collector destroys the node object)
moving\_robot.destroy\_node()
rclpy.shutdown()
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<p>过于简单，感觉没有什么要讲的。setup.py里：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-14.png"></p>
<p>运行：</p>
<p>shaw@shaw-Inspiron-7590:<del>&#x2F;Data&#x2F;Seafile&#x2F;robot&#x2F;ros2_ws$ ros2 launch my_dolly my_dolly.launch.py<br>shaw@shaw-Inspiron-7590:</del>&#x2F;Data&#x2F;Seafile&#x2F;robot&#x2F;ros2_ws$ ros2 run my_dolly moving_robot</p>
<h2 id="避障"><a href="#避障" class="headerlink" title="避障"></a>避障</h2><p>最后来改写一下避障：</p>
<p>obstacle.py</p>
<p>import rclpy<br>from rclpy.node import Node</p>
<p>from geometry_msgs.msg import Twist<br>from sensor_msgs.msg import LaserScan</p>
<p>class Obstacle(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;obstacle&#39;)
    self.subscription = self.create\_subscription(
        LaserScan,
        &#39;/dolly/laser\_scan&#39;,
        self.listener\_callback,
        10)
    self.subscription  # prevent unused variable warning
    self.publisher\_ = self.create\_publisher(Twist, &#39;/dolly/cmd\_vel&#39;, 10)
    
def listener\_callback(self, msg):
    min\_distance = 10
    for each in msg.ranges:
        if each &lt; min\_distance:
            min\_distance = each
        else:
            continue
    message = Twist()
    if min\_distance &lt; 1:
        message.linear.x = 0.0
        message.angular.z = 0.3
    else:
        message.linear.x = 0.3
        message.linear.z = 0.0
    self.publisher\_.publish(message)
    
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>obstacle = Obstacle()

rclpy.spin(obstacle)

obstacle.destroy\_node()
rclpy.shutdown()
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/%E5%9B%BE%E7%89%87-15-1024x233.png"></p>
<p>这个地方必须按照这个顺序来，否则编译不通过，具体是为什么不太清楚。其他步骤类似上面。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结一下，使用python进行ROS2开发简单不少。首先，来分析一下ros2和ignition在仿真中的角色都是什么：</p>
<h3 id="ROS2与Ignition的角色"><a href="#ROS2与Ignition的角色" class="headerlink" title="ROS2与Ignition的角色"></a>ROS2与Ignition的角色</h3><p>ROS2：控制。对机器人的控制，都应当使用ROS2进行，这样迁移到真实机器人上的时候，更加快速。因为ROS2并不在乎它所控制的是真实机器人还是仿真中的机器人，它只与topic进行交互。</p>
<p>Ignition：仿真。Ignition也提供了topic一类的机制，他们的作用是与ROS2进行映射，从而使用ROS2来控制仿真中的机器人。在ROS2只关注与topic的交互时，ignition关注的是阅读topic中的信息，并基于信息对仿真机器人做出物理仿真，例如速度上的改变等。</p>
<h3 id="Python工作流"><a href="#Python工作流" class="headerlink" title="Python工作流"></a>Python工作流</h3><ol>
<li>建立workspace</li>
<li>在workspace下的src文件夹中建立package：ros2 pkg create –build-type ament_python my_dolly</li>
<li>在package同名子文件下编写Node脚本</li>
<li>在launch文件夹下编写launch file</li>
<li>在setup里修改data_files（for launch file）、entry_points（for node）</li>
<li>在worksapce下编译：colcon build –packages-select my_dolly</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/09/18/%E5%92%8Cdolly%E4%B8%80%E8%B5%B7%E6%8E%A2%E7%B4%A2ros2%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E5%8F%91%E5%B8%83%E8%AF%9D%E9%A2%98%EF%BC%8C%E9%81%BF%E9%9A%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/18/%E5%92%8Cdolly%E4%B8%80%E8%B5%B7%E6%8E%A2%E7%B4%A2ros2%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E5%8F%91%E5%B8%83%E8%AF%9D%E9%A2%98%EF%BC%8C%E9%81%BF%E9%9A%9C/" class="post-title-link" itemprop="url">和Dolly一起探索ROS2（三）：发布话题，避障</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 19:09:48" itemprop="dateCreated datePublished" datetime="2021-09-18T19:09:48+08:00">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="发布话题"><a href="#发布话题" class="headerlink" title="发布话题"></a>发布话题</h2><p>本章我们会写一个可执行程序来向特定话题发布一个消息，简单地说，就是创建一个Node，然后控制他发送一条消息。</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/image-7.png"></p>
<p>如图所示位置创建moving_robot.cpp，内容如下：</p>
<p>#include <chrono><br>#include <functional><br>#include <memory></p>
<p>#include “rclcpp&#x2F;rclcpp.hpp”<br>&#x2F;&#x2F;类型为旋转+平移的运动数值<br>#include “geometry_msgs&#x2F;msg&#x2F;twist.hpp”</p>
<p>using namespace std::chrono_literals;</p>
<p>&#x2F;&#x2F;创建Node<br>class MovingRobot : public rclcpp::Node {<br>public:<br>  MovingRobot() : Node(“minimal_publisher”) {<br>&#x2F;&#x2F;创建一个publisher<br>    publisher_ &#x3D; this-&gt;create_publisher&lt;geometry_msgs::msg::Twist&gt;(<br>        “&#x2F;dolly&#x2F;cmd_vel”, 10);<br>    timer_ &#x3D; this-&gt;create_wall_timer(<br>&#x2F;&#x2F;实际上，回调函数绑定在一个计时器上，500ms调用一次。如果只想发布一次的话，不用绑定计时器就行了。<br>        500ms, std::bind(&amp;MovingRobot::timer_callback, this));<br>  }</p>
<p>private:<br>&#x2F;&#x2F;回调函数，生成一个Twist msg，然后发布<br>  void timer_callback() {<br>    auto message &#x3D; geometry_msgs::msg::Twist();<br>    message.linear.x &#x3D; 0.5;<br>    message.angular.z &#x3D; 0.3;<br>    RCLCPP_INFO(this-&gt;get_logger(), “Publishing: ‘%f’ ‘%f’”, message.linear.x, message.angular.z);<br>    publisher_-&gt;publish(message);<br>  }<br>  rclcpp::TimerBase::SharedPtr timer_;<br>  rclcpp::Publisher&lt;geometry_msgs::msg::Twist&gt;::SharedPtr publisher_;<br>};</p>
<p>&#x2F;&#x2F;正常流程，上一章里提过了<br>int main(int argc, char *argv[]) {<br>  rclcpp::init(argc, argv);<br>  auto node &#x3D; std::make_shared<MovingRobot>();<br>  rclcpp::spin(node);<br>  rclcpp::shutdown();<br>  return 0;<br>}</p>
<p>cmakelist里做对应修改，主要是加入了新的依赖，以及要生成新的可执行文件：</p>
<p>find_package(geometry_msgs REQUIRED)</p>
<p>…</p>
<p>#moving robot<br>add_executable(moving_robot src&#x2F;moving_robot.cpp)<br>ament_target_dependencies(moving_robot rclcpp std_msgs geometry_msgs)</p>
<p>…</p>
<p>install(TARGETS<br>  reading_laser<br>  moving_robot<br>  DESTINATION lib&#x2F;${PROJECT_NAME}&#x2F;<br>)</p>
<p>编译方式和上一章一模一样，运行方式也类似。ros2 run之后，就可以看到小车开始打转儿了。</p>
<h2 id="避障"><a href="#避障" class="headerlink" title="避障"></a>避障</h2><p>写到这里发现这一张内容太少了，所以干脆把下一章的内容也写进来。接下来要做的是一个常见功能，就是避障。原理上很简单，激光雷达传感器探测到附近有物体后，控制dolly转向就好了。那么这个功能设计到对topic的subscribe和publish，而这些操作我们要在一个app里完成。</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/image-8-1024x585.png"></p>
<p>from launch import LaunchDescription<br>from launch_ros.actions import Node</p>
<p>def generate_launch_description():</p>
<pre><code>obstacle\_avoidance = Node(
    package=&#39;my\_package&#39;,
    executable=&#39;obstacle\_avoidance&#39;,
    output=&#39;screen&#39;,
    remappings=\[
        (&#39;laser\_scan&#39;, &#39;/dolly/laser\_scan&#39;),
        (&#39;cmd\_vel&#39;, &#39;/dolly/cmd\_vel&#39;)
    \]
)

return LaunchDescription(\[
    obstacle\_avoidance
\])
</code></pre>
<p>#include “rclcpp&#x2F;rclcpp.hpp”<br>#include “sensor_msgs&#x2F;msg&#x2F;laser_scan.hpp”<br>#include “geometry_msgs&#x2F;msg&#x2F;twist.hpp”</p>
<p>using std::placeholders::_1;</p>
<p>class ObstacleAvoidance : public rclcpp::Node {</p>
<p>public:<br>  ObstacleAvoidance() : Node(“ObstacleAvoidance”) {<br>    auto default_qos &#x3D; rclcpp::QoS(rclcpp::SystemDefaultsQoS());<br>    subscription_ &#x3D; this-&gt;create_subscription&lt;sensor_msgs::msg::LaserScan&gt;(<br>        “laser_scan”, default_qos,<br>        std::bind(&amp;ObstacleAvoidance::topic_callback, this, _1));<br>    publisher_ &#x3D;<br>        this-&gt;create_publisher&lt;geometry_msgs::msg::Twist&gt;(“cmd_vel”, 10);<br>  }</p>
<p>private:<br>  void topic_callback(const sensor_msgs::msg::LaserScan::SharedPtr _msg) {<br>    float min &#x3D; 10;<br>    for (int i &#x3D; 0; i &lt; 200; i++) {<br>        float current &#x3D; _msg-&gt;ranges[i];<br>        if (current&lt;min) {<br>            min &#x3D; current;<br>        }<br>    }<br>    auto message &#x3D; this-&gt;calculateVelMsg(min);<br>    publisher_-&gt;publish(message);<br>  }<br>  geometry_msgs::msg::Twist calculateVelMsg(float distance) {<br>      auto msg &#x3D; geometry_msgs::msg::Twist();<br>      RCLCPP_INFO(this-&gt;get_logger(), “Distance is : ‘%f’”, distance);<br>      if (distance&lt;1) {<br>          msg.linear.x &#x3D; 0;<br>          msg.angular.z &#x3D; 0.3;<br>      } else {<br>          msg.linear.x &#x3D; 0.3;<br>          msg.angular.z &#x3D; 0;<br>      }<br>      return msg;<br>  }<br>  rclcpp::Publisher&lt;geometry_msgs::msg::Twist&gt;::SharedPtr publisher_;<br>  rclcpp::Subscription&lt;sensor_msgs::msg::LaserScan&gt;::SharedPtr subscription_;<br>};</p>
<p>int main(int argc, char *argv[]) {<br>  rclcpp::init(argc, argv);<br>  auto node &#x3D; std::make_shared<ObstacleAvoidance>();<br>  RCLCPP_INFO(node-&gt;get_logger(), “hello my friends”);<br>  rclcpp::spin(node);<br>  rclcpp::shutdown();<br>  return 0;<br>}</p>
<p>#obstacle avoidance<br>add_executable(obstacle_avoidance src&#x2F;obstacle_avoidance.cpp)<br>ament_target_dependencies(obstacle_avoidance rclcpp std_msgs sensor_msgs geometry_msgs)</p>
<p>install(TARGETS<br>  reading_laser<br>  moving_robot<br>  obstacle_avoidance<br>  DESTINATION lib&#x2F;${PROJECT_NAME}&#x2F;<br>)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/09/18/%E5%92%8Cdolly%E4%B8%80%E8%B5%B7%E6%8E%A2%E7%B4%A2ros2%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%AE%A2%E9%98%85%E8%AF%9D%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/18/%E5%92%8Cdolly%E4%B8%80%E8%B5%B7%E6%8E%A2%E7%B4%A2ros2%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%AE%A2%E9%98%85%E8%AF%9D%E9%A2%98/" class="post-title-link" itemprop="url">和Dolly一起探索ROS2（二）：订阅话题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 11:31:15" itemprop="dateCreated datePublished" datetime="2021-09-18T11:31:15+08:00">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>订阅话题，主要是为了获取数据，从而进行其他的操作。但是，订阅话题这个工作只能由Node来完成。所以我们要做的事，使用C++编写一个可执行程序，在里面创建Node，并完成订阅话题的工作。不仅如此，我们还会创建一个launch file，用它来执行程序。</p>
<p>本章接触两个主要命令：ros2 run和ros2 launch。ros2 run用来执行单个的服务&#x2F;应用，比如说启动一个摄像机；ros2 launch则是启动一组应用，比如摄像机+仿真+执行器。那么第一步，我们先做一个监听某个topic的应用：</p>
<p>打开the construct，在如图位置创建以下文件：</p>
<p>&#x2F;&#x2F;基本的ros common libraries<br>#include “rclcpp&#x2F;rclcpp.hpp”<br>&#x2F;&#x2F;读取的是laser sensor的数据<br>#include “sensor_msgs&#x2F;msg&#x2F;laser_scan.hpp”</p>
<p>using std::placeholders::_1;</p>
<p>&#x2F;&#x2F;继承Node<br>class ReadingLaser : public rclcpp::Node {</p>
<p>public:<br>&#x2F;&#x2F;构造函数<br>  ReadingLaser() : Node(“reading_laser”) {<br>    auto default_qos &#x3D; rclcpp::QoS(rclcpp::SystemDefaultsQoS());<br>&#x2F;&#x2F;生成一个线程，监听数据<br>    subscription_ &#x3D; this-&gt;create_subscription&lt;sensor_msgs::msg::LaserScan&gt;(<br>        “laser_scan”, default_qos,<br>        std::bind(&amp;ReadingLaser::topic_callback, this, _1));<br>  }</p>
<p>&#x2F;&#x2F;线程里要执行的函数放在这里<br>private:<br>  void topic_callback(const sensor_msgs::msg::LaserScan::SharedPtr _msg) {<br>    RCLCPP_INFO(this-&gt;get_logger(), “I heard: ‘%f’ ‘%f’”, _msg-&gt;ranges[0],<br>                _msg-&gt;ranges[100]);<br>  }<br>  rclcpp::Subscription&lt;sensor_msgs::msg::LaserScan&gt;::SharedPtr subscription_;<br>};</p>
<p>&#x2F;&#x2F;init，spin，shutdown是基本的操作<br>int main(int argc, char *argv[]) {<br>  rclcpp::init(argc, argv);<br>  auto node &#x3D; std::make_shared<ReadingLaser>();<br>  RCLCPP_INFO(node-&gt;get_logger(), “hello my friends”);<br>  rclcpp::spin(node);<br>  rclcpp::shutdown();<br>  return 0;<br>}</p>
<p>同时，因为导入了rclcpp、sensor_msgs包，也在cmake里加入相应的行：</p>
<p>cmake_minimum_required(VERSION 3.5)<br>project(my_package)</p>
<p>…</p>
<h1 id="find-dependencies"><a href="#find-dependencies" class="headerlink" title="find dependencies"></a>find dependencies</h1><p>find_package(ament_cmake REQUIRED)<br>find_package(rclcpp REQUIRED)<br>find_package(sensor_msgs REQUIRED)</p>
<p>…</p>
<p>add_executable(reading_laser src&#x2F;reading_laser.cpp)<br>ament_target_dependencies(reading_laser rclcpp std_msgs sensor_msgs)</p>
<p>install(DIRECTORY<br>  launch<br>  DESTINATION share&#x2F;${PROJECT_NAME}<br>)</p>
<p>install(TARGETS<br>  reading_laser<br>  DESTINATION lib&#x2F;${PROJECT_NAME}&#x2F;<br>)</p>
<p>ament_package()</p>
<p>之后进行编译，编译路径为ros2的工作空间：</p>
<p>user:~&#x2F;ros2_ws$ colcon build –symlink-install –packages-select my_package</p>
<p>编译完成后，先用ros2 launch启动dolly（就不演示了），然后使用ros2 run执行程序：</p>
<p>可以看到程序执行成功了，但是并没有任何的数据。这是为什么呢？很简单， 因为我们订阅的topic是laser_scan，但是dolly传感器的topic是dolly&#x2F;laser_scan。实际上在源文件里改一下话题也可以，但是如果换了一个传感器，就又要改动源文件然后编译。所以我们用另外的方式来解决这个问题。在如图所示位置新建一个launch file：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/image-5.png"></p>
<p>from launch import LaunchDescription<br>from launch_ros.actions import Node</p>
<p>def generate_launch_description():</p>
<pre><code>reading\_laser = Node(
    package=&#39;my\_package&#39;,
    executable=&#39;reading\_laser&#39;,
    output=&#39;screen&#39;,
    remappings=\[
        (&#39;laser\_scan&#39;, &#39;/dolly/laser\_scan&#39;)
    \]
)

return LaunchDescription(\[
    reading\_laser
\])
</code></pre>
<p>在这个launch file里，我们对topic进行了remap，使得在不改动源文件的情况下，改变订阅的topic。然后ros2 launch：</p>
<p>user:~&#x2F;ros2_ws$ ros2 launch my_package reading_laser_launch.py</p>
<p>[reading_laser-1] [INFO] [1631935735.554381992] [reading_laser]: I heard: ‘inf’ ‘inf’<br>[reading_laser-1] [INFO] [1631935735.556166570] [reading_laser]: I heard: ‘inf’ ‘inf’<br>[reading_laser-1] [INFO] [1631935735.557396558] [reading_laser]: I heard: ‘inf’ ‘inf’<br>[reading_laser-1] [INFO] [1631935735.560346428] [reading_laser]: I heard: ‘inf’ ‘inf’<br>[reading_laser-1] [INFO] [1631935735.562563220] [reading_laser]: I heard: ‘inf’ ‘inf’</p>
<p>这样就能看到数据了，在仿真里放上一个障碍物：</p>
<p><img src="http://www.lxshaw.com/wp-content/uploads/2021/09/image-6-1024x633.png"></p>
<p>就能看到具体的数值。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xiao Lin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">173</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/linxiaoshaw@foxmail.com" title="E-Mail → linxiaoshaw@foxmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Lin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
