<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wonderful-sea-04900b000.6.azurestaticapps.net","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Shawn Lin&#39;s Blog">
<meta property="og:url" content="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/16/index.html">
<meta property="og:site_name" content="Shawn Lin&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Xiao Lin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/16/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Shawn Lin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Shawn Lin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/%E5%A1%94%E7%BD%97%E7%89%8C%EF%BC%9A%E5%AE%83%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E5%A6%82%E4%BD%95%E8%B5%B7%E4%BD%9C%E7%94%A8%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E5%A1%94%E7%BD%97%E7%89%8C%EF%BC%9A%E5%AE%83%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E5%A6%82%E4%BD%95%E8%B5%B7%E4%BD%9C%E7%94%A8%EF%BC%9F/" class="post-title-link" itemprop="url">塔罗牌：它是什么，如何起作用？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 14:39:17" itemprop="dateCreated datePublished" datetime="2021-04-09T14:39:17+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/" itemprop="url" rel="index"><span itemprop="name">thought</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/%E5%A1%94%E7%BD%97%E7%89%8C/" itemprop="url" rel="index"><span itemprop="name">塔罗牌</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>塔罗牌是一种西方的占卜工具，起源不详。塔罗牌由于和占卜的紧密关系，经常被认为是吉卜赛人创造的。塔罗牌总共有22张大阿卡那牌，56张小阿卡纳牌。大阿卡那牌想必很多人都有所耳闻，在许多文学、影视、游戏作品中都有出现，例如《赛博朋克2077》、《百变小樱》、《JOJO的奇妙冒险》等等。大阿卡那牌的象征意味比小阿卡纳牌要浓的多，当一个吉普赛老女人抽出一张死亡牌时，对面的少女一定吓得花容失色，但是如果抽出一张宝剑八，虽然意思差不多，但是难免还要再解释一下宝剑八的意思。所以说所谓“象征意味更浓”，“与灵魂联系更紧密”，无非是牌比较少大家印象比较深罢了。小阿卡纳牌则是后来扑克牌的来源，56张牌四个花色（宝剑-黑桃、圣杯-红桃、钱币-方片、权杖-梅花），以及国王、皇后、骑士、侍从的特殊牌型都直接影响了扑克牌的发展。如果你觉得对应性还是没有那么强的话，请注意宝剑和圣杯这一对富有阴阳对应以及生育意味的组合，以及黑桃和红桃这一对方向相反、形态相近的组合。</p>
<p>和所有的宗教一样，塔罗牌也有很多分支与体系。最为热门的是维特塔罗牌，但是它是从1910年才正式发行的。现在你能买到的大部分塔罗牌都是维特塔罗牌，它印刷比较精美，并且用英文注明牌面，小阿卡纳牌也有很生动的绘画方便使用者回忆牌意。马赛塔罗牌的小阿卡纳牌则没有绘画，与扑克牌一样，“钱币四”则在牌面上画四个钱币。还有一种托特塔罗牌，由近代极具争议的神秘学家—阿来斯特·克劳利(Aleister·Crowley,1875-1947)，在与佛莱达·哈里丝女士(Frieda·Harris)的合作之下，花了五年的时间(1938-1943)，融合了占星术、卡巴拉、易经、神话、炼金术、魔法等各种神秘学元素，所创作出这副以埃及为主题的塔罗牌（此段来自百度翻译）。总而言之，塔罗牌体系的成熟也只是近代的事情，在此之前塔罗牌的释义基本上是各家念各经。可能是塔罗牌的解释空间太大，现在也允许使用者对塔罗牌有自己的理解，据称不会影响塔罗的效果。</p>
<p>但是在追问“使用者对塔罗有自己的理解会不会影响塔罗的效果”，以及“存不存在牌灵”这种荒谬的问题前，不如先问问“塔罗牌到底有没有用？”。我的理解是，塔罗牌有用，但并不在于其“预言”的功能。或者说，塔罗牌完全没有预言的功能。为了让塔罗牌看起来有预言的功能，有许多约定俗成的规矩，比如不当面占卜就不准，间接占卜不准，太久的事情不准，直接问确切的结果不准，总而言之塔罗只能给出模棱两可的回答。心理学中有一个非常有趣的巴纳姆效应，指的就是人们常常认为一种笼统的、一般性的人格描述十分准确地揭示了自己的特点，当人们用一些普通、含糊不清、广泛的形容词来描述一个人的时候，人们往往很容易就接受这些描述，却认为描述中所说的就是自己。塔罗的一张牌存在多个释义，虽然这些释义在一定程度上存在共性，但是多张牌的组合依然能让塔罗的回答在一个很大的不确定性之间。就像雷军说小米的新车价格在10万到30万之间，最后出来发现真的是20万，但是比亚迪吉利大众丰田别克这些车企的车都在10万到30万啊，这属于几乎无效的信息。</p>
<p>但是塔罗牌还是存在一定的价值的，其价值不在于它和科学完全沾不上边的占卜功效，而在于其在心理学上的一些辅助功能。有些心理治疗师尝试使用塔罗牌进行心理治疗，当然这很看心理治疗师的编故事功底，无论患者抽到什么牌，心里治疗师都要编一个为治疗目标服务的故事。不过由于塔罗牌上好像存在一种超自然的力量，患者会更容易介绍心理治疗师的暗示。卡尔·荣格是和塔罗牌有所关系的最大咖了，他创立了荣格人格分析心理学理论，提出“情结“的概念，把人格分为内倾和外倾两种，主张把人格分为意识、个人无意识和集体无意识三层。集体无意识能和塔罗牌扯上一点关系，但是集体无意识也还是一种假设，它假设人类在进化的过程中有一些原始意象累计在集体无意识中被所有人类共享（这是一个假设），而塔罗牌可以反映出这种集体无意识（建立在假设上的假设）。我了解的很粗浅，就不对荣格理论妄加评论了，但可以确定的是，就算塔罗牌能够反映集体无意识，作为犹太人的集体无意识结晶也没法用在中国人身上。</p>
<p>所以你可能发现了，塔罗牌存在的价值还是在心理治疗上；或者我再说得直白一点，说对方想听的话或者自己想说的话却不让对方发现。除此之外，塔罗牌的艺术价值也是值得探讨的。《赛博朋克2077》中的塔罗牌绘画就非常精美，我非常想收藏一份。如果你真的想让别人用塔罗帮你认真地占卜，那至少找一个社会阅历丰富年龄大的，他&#x2F;她释出的牌意可能有更多的人生经验，相反你要是找个培训了一个月出来招摇的“占卜师”，ta为了赚钱可是什么都敢说，谁信谁笨蛋。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93/" class="post-title-link" itemprop="url">制作自己的中文字体</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:54:45" itemprop="dateCreated datePublished" datetime="2021-04-09T13:54:45+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/" itemprop="url" rel="index"><span itemprop="name">thought</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/%E6%96%B0%E9%B2%9C%E4%BA%8B/" itemprop="url" rel="index"><span itemprop="name">新鲜事</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>北大计院的同学们做了这么个网站：<a target="_blank" rel="noopener" href="http://www.flexifont.com/">www.flexifont.com</a><br>网站提供模版下载和字体文件生成。非常的好用。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210309211359867-2145457756-1024x715.png"></p>
<p>其他的网站要么是只针对英文，要么是需要付费。这个免费网站基本已经能够满足大部分人的需要了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8Emutt%E5%92%8Cpython%E7%88%AC%E8%99%AB%E7%9A%84%E6%AF%8F%E6%97%A5%E8%A6%81%E9%97%BB%E4%B8%8E%E5%A4%A9%E6%B0%94%E8%87%AA%E5%8A%A8%E5%8F%91%E9%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8Emutt%E5%92%8Cpython%E7%88%AC%E8%99%AB%E7%9A%84%E6%AF%8F%E6%97%A5%E8%A6%81%E9%97%BB%E4%B8%8E%E5%A4%A9%E6%B0%94%E8%87%AA%E5%8A%A8%E5%8F%91%E9%80%81/" class="post-title-link" itemprop="url">制作一个基于mutt和python爬虫的每日要闻与天气自动发送脚本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:53:12" itemprop="dateCreated datePublished" datetime="2021-04-09T13:53:12+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/" itemprop="url" rel="index"><span itemprop="name">bolgs</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/" itemprop="url" rel="index"><span itemprop="name">tech</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>脚本一开始运行在树莓派上，后来迁移到腾讯云服务器上。爬虫使用python，定时发送通过sh脚本和crontab定时任务完成，邮件发送使用mutt。一个稍微有点用的小玩意儿。</p>
<h2 id="爬虫编写"><a href="#爬虫编写" class="headerlink" title="爬虫编写"></a>爬虫编写</h2><p>import requests<br>from lxml import etree<br>import json<br>import re<br>from ast import literal_eval<br>import datetime<br>import time<br>import random<br>from writehtml import *</p>
<p>def get_weather():<br>    headers_weather &#x3D; {<br>        ‘Host’: ‘<a target="_blank" rel="noopener" href="http://www.weather.com.cn/">www.weather.com.cn</a>‘,<br>        ‘Referer’: ‘<a target="_blank" rel="noopener" href="http://www.weather.com.cn/">http://www.weather.com.cn/</a>‘,<br>        ‘Upgrade-Insecure-Requests’: ‘1’,<br>        ‘User-Agent’: ‘Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.182 Safari&#x2F;537.36 Edg&#x2F;88.0.705.81’<br>    }<br>    url &#x3D; “<a target="_blank" rel="noopener" href="http://www.weather.com.cn/weather/101010100.shtml">http://www.weather.com.cn/weather/101010100.shtml</a>“ #海淀<br>    res &#x3D; requests.get(url, headers&#x3D;headers_weather)<br>    res.encoding &#x3D; ‘utf-8’<br>    html &#x3D; etree.HTML(res.text)<br>    weather &#x3D; re.findall(‘“1d”:(.*?),”23d”‘, res.text)[0]<br>    weather &#x3D; literal_eval(weather)<br>    weather_list &#x3D; []<br>    for each in weather:<br>        hourlist &#x3D; each.split(‘,’)<br>        weather_list.append([hourlist[0]]+hourlist[2:-1])<br>    return weather_list</p>
<p>def get_baidutop10():<br>    headers &#x3D; {<br>        ‘Host’: ‘top.baidu.com’,<br>        ‘Referer’: ‘<a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com/</a>‘,<br>        ‘Upgrade-Insecure-Requests’: ‘1’,<br>        ‘User-Agent’: ‘Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.182 Safari&#x2F;537.36 Edg&#x2F;88.0.705.81’<br>    }<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="http://top.baidu.com/?fr=mhd%5C_card">http://top.baidu.com/?fr=mhd\_card</a>‘<br>    res &#x3D; requests.get(url, headers&#x3D;headers)<br>    res.encoding &#x3D; ‘gb2312’<br>    html &#x3D; etree.HTML(res.text)<br>    top10_title &#x3D; html.xpath(‘&#x2F;&#x2F;*[@id&#x3D;”hot-list”]&#x2F;li&#x2F;a[1]&#x2F;@title’)<br>    top10_link &#x3D; html.xpath(‘&#x2F;&#x2F;*[@id&#x3D;”hot-list”]&#x2F;li&#x2F;a[1]&#x2F;@href’)<br>    return top10_link, top10_title</p>
<p>def get_weibotop10():<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://s.weibo.com/top/summary">https://s.weibo.com/top/summary</a>‘<br>    res &#x3D; requests.get(url)<br>    res.encoding &#x3D; ‘utf-8’<br>    html &#x3D; etree.HTML(res.text)<br>    top10_link &#x3D; html.xpath(‘&#x2F;&#x2F;*[@id&#x3D;”pl_top_realtimehot”]&#x2F;table&#x2F;tbody&#x2F;tr[position()&lt;&#x3D;11]&#x2F;td[2]&#x2F;a&#x2F;@href’)<br>    top10_title &#x3D; html.xpath(‘&#x2F;&#x2F;*[@id&#x3D;”pl_top_realtimehot”]&#x2F;table&#x2F;tbody&#x2F;tr[position()&lt;&#x3D;11]&#x2F;td[2]&#x2F;a&#x2F;text()’)<br>    top10_link &#x3D; list(map(lambda x: ‘<a target="_blank" rel="noopener" href="https://s.weibo.com/'+x">https://s.weibo.com/&#39;+x</a>, top10_link))<br>    return top10_link, top10_title</p>
<p>def get_huputop10():<br>    headers_hupu &#x3D; {<br>        ‘Sec-Fetch-Dest’: ‘document’,<br>        ‘Sec-Fetch-Mode’: ‘navigate’,<br>        ‘Sec-Fetch-Site’: ‘none’,<br>        ‘Sec-Fetch-User’: ‘?1’,<br>        ‘Upgrade-Insecure-Requests’: ‘1’,<br>        ‘User-Agent’: ‘Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.182 Safari&#x2F;537.36 Edg&#x2F;88.0.705.81’<br>    }<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://bbs.hupu.com/all-gambia">https://bbs.hupu.com/all-gambia</a>‘<br>    res &#x3D; requests.get(url, headers&#x3D;headers_hupu)<br>    res.encoding &#x3D; ‘utf-8’<br>    html &#x3D; etree.HTML(res.text)<br>    top10_title &#x3D; html.xpath(‘&#x2F;&#x2F;div[@class&#x3D;”bbsHotPit”]&#x2F;div&#x2F;ul&#x2F;li[position()&lt;&#x3D;3]&#x2F;span[1]&#x2F;a&#x2F;@title’)[:10]<br>    top10_link &#x3D; html.xpath(‘&#x2F;&#x2F;div[@class&#x3D;”bbsHotPit”]&#x2F;div&#x2F;ul&#x2F;li[position()&lt;&#x3D;3]&#x2F;span[1]&#x2F;a&#x2F;@href’)[:10]<br>    top10_link &#x3D; list(map(lambda x: ‘<a target="_blank" rel="noopener" href="https://bbs.hupu.com'+x/">https://bbs.hupu.com&#39;+x</a>, top10_link))<br>    return top10_link, top10_title</p>
<p>def get_ezutop10():<br>    headers &#x3D; {<br>        ‘Host’: ‘<a target="_blank" rel="noopener" href="http://www.douban.com/">www.douban.com</a>‘,<br>        ‘Referer’: ‘<a target="_blank" rel="noopener" href="https://www.douban.com/group/blabla/?type=elite">https://www.douban.com/group/blabla/?type=elite</a>‘,<br>        ‘Sec-Fetch-Dest’: ‘document’,<br>        ‘Sec-Fetch-Mode’: ‘navigate’,<br>        ‘Sec-Fetch-Site’: ‘same-origin’,<br>        ‘Sec-Fetch-User’: ‘?1’,<br>        ‘Upgrade-Insecure-Requests’: ‘1’,<br>        ‘User-Agent’: ‘Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.182 Safari&#x2F;537.36 Edg&#x2F;88.0.705.81’<br>    }<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://www.douban.com/group/blabla/?type=essence">https://www.douban.com/group/blabla/?type=essence</a>‘<br>    res &#x3D; requests.get(url, headers&#x3D;headers)<br>    res.encoding &#x3D; ‘utf-8’<br>    html &#x3D; etree.HTML(res.text)<br>    top10_title &#x3D; html.xpath(‘&#x2F;&#x2F;table[@class&#x3D;”olt”]&#x2F;tr[position()&lt;&#x3D;11]&#x2F;td[1]&#x2F;a&#x2F;@title’)<br>    top10_link &#x3D; html.xpath(‘&#x2F;&#x2F;table[@class&#x3D;”olt”]&#x2F;tr[position()&lt;&#x3D;11]&#x2F;td[1]&#x2F;a&#x2F;@href’)<br>    return top10_link, top10_title</p>
<p>def get_rmtop10(date):<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="http://www.people.com.cn/GB/59476/review/'+date+'.html">http://www.people.com.cn/GB/59476/review/&#39;+date+&#39;.html</a>‘<br>    res &#x3D; requests.get(url)<br>    res.encoding &#x3D; ‘gb2312’<br>    html &#x3D; etree.HTML(res.text)<br>    top10_link &#x3D; html.xpath(‘&#x2F;&#x2F;table[@id&#x3D;”ta_1”]&#x2F;tr&#x2F;td&#x2F;li&#x2F;a&#x2F;@href’)<br>    top10_title &#x3D; html.xpath(‘&#x2F;&#x2F;table[@id&#x3D;”ta_1”]&#x2F;tr&#x2F;td&#x2F;li&#x2F;a&#x2F;text()’)<br>    return top10_link, top10_title</p>
<p>def get_todayhistory(month, day): # month和day是字符串格式，带零。（‘03’，’08‘）<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://baike.baidu.com/cms/home/eventsOnHistory/%7B%7D.json'.format(month)">https://baike.baidu.com/cms/home/eventsOnHistory/{}.json&#39;.format(month)</a><br>    headers &#x3D; {<br>        ‘Host’: ‘baike.baidu.com’,<br>        ‘Referer’: ‘<a target="_blank" rel="noopener" href="https://baike.baidu.com/calendar/">https://baike.baidu.com/calendar/</a>‘,<br>        ‘Sec-Fetch-Dest’: ‘empty’,<br>        ‘Sec-Fetch-Mode’: ‘cors’,<br>        ‘Sec-Fetch-Site’: ‘same-origin’,<br>        ‘User-Agent’: ‘Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;88.0.4324.182 Safari&#x2F;537.36 Edg&#x2F;88.0.705.81’,<br>        ‘X-Requested-With’: ‘XMLHttpRequest’<br>    }<br>    res &#x3D; requests.get(url, headers&#x3D;headers)<br>    content &#x3D; json.loads(res.text)<br>    history_list &#x3D; []<br>    for each in content[month][month+day]:<br>        year &#x3D; each[‘year’]<br>        title &#x3D; ‘’.join(re.findall(r’[\u4e00-\u9fa5]‘, each[‘title’]))<br>        history_list.append([year, title])<br>    return history_list</p>
<p>def get_randomsentence():<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://v2.jinrishici.com/sentence">https://v2.jinrishici.com/sentence</a>‘<br>    headers &#x3D; {<br>        ‘cookie’: ‘X-User-Token&#x3D;9cA&#x2F;6FT0nadkWlwpBAMfp8tVqHOihW0m’,<br>    }<br>    res &#x3D; requests.get(url, headers&#x3D;headers)<br>    content &#x3D; json.loads(res.text)<br>    note &#x3D; content[“data”][“content”]+’        ‘+’————‘+’《’+content[“data”][“origin”][“title”]+’》, ‘+content[“data”][“origin”][“author”]+’, ‘+content[“data”][“origin”][“dynasty”]<br>    return note</p>
<p>def get_fastival(date): #日期格式：xx月xx日，3月8日,不带零<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="http://www.jieriya.com/">http://www.jieriya.com/</a>‘<br>    res &#x3D; requests.get(url)<br>    res.encoding &#x3D; ‘gb2312’<br>    url_list &#x3D; re.findall(‘&lt;li class&#x3D;\“sj\“&gt;%s</li>&lt;li class&#x3D;\“jr\“&gt;&lt;a target&#x3D;\“_blank\“ href&#x3D;\“..&#x2F;(.*?)\“&gt;’%(date), res.text)[:3]<br>    if (len(url_list)&#x3D;&#x3D;0):<br>        return [],[],””<br>    name_list &#x3D; re.findall(‘&lt;li class&#x3D;\“sj\“&gt;%s</li>&lt;li class&#x3D;\“jr\“&gt;&lt;a target&#x3D;\“_blank\“ href&#x3D;\“..&#x2F;jieri.asp\?id&#x3D;[0-9]*\“&gt;(.*?)</a>‘%(date), res.text)[:3]<br>    page_url &#x3D; url+url_list[0]<br>    page_res &#x3D; requests.get(page_url)<br>    page_res.encoding &#x3D; ‘gb2312’<br>    html &#x3D; etree.HTML(page_res.text)<br>    text_list &#x3D; html.xpath(‘&#x2F;&#x2F;*[@id&#x3D;”content”]&#x2F;div[2]&#x2F;p&#x2F;text()’)<br>    for each in text_list:<br>        if (len(each)&gt;&#x3D;40):<br>            return url_list, name_list, each.strip()</p>
<p>def get_thing():<br>    url &#x3D; ‘<a target="_blank" rel="noopener" href="https://sbike.cn/">https://sbike.cn/</a>‘<br>    res &#x3D; requests.get(url)<br>    res.encoding &#x3D; ‘utf-8’<br>    order &#x3D; int(12*random.random())+1<br>    html &#x3D; etree.HTML(res.text)<br>    title &#x3D; html.xpath(‘&#x2F;&#x2F;li[%s]&#x2F;h3[1]&#x2F;a&#x2F;text()’%(order))[0]<br>    describe &#x3D; html.xpath(‘&#x2F;&#x2F;li[%s]&#x2F;h4&#x2F;text()’%(order))<br>    img_url &#x3D; url[:-1] + html.xpath(‘&#x2F;&#x2F;li[%s]&#x2F;a&#x2F;img&#x2F;@src’%(order))[0]<br>    return title, describe, img_url</p>
<p>def write_email():<br>    today &#x3D; datetime.datetime.today()<br>    week_day_dict &#x3D; {<br>        0 : ‘星期一’,<br>        1 : ‘星期二’,<br>        2 : ‘星期三’,<br>        3 : ‘星期四’,<br>        4 : ‘星期五’,<br>        5 : ‘星期六’,<br>        6 : ‘星期天’,<br>    }<br>    week &#x3D; week_day_dict[today.weekday()]<br>    year &#x3D; time.strftime(“%Y”, time.localtime())<br>    month &#x3D; time.strftime(“%m”, time.localtime())<br>    day &#x3D; time.strftime(“%d”, time.localtime())<br>    md_date &#x3D; ‘%d月%d日’%(int(month), int(day))<br>    #with open(‘today_info’+’ ‘+today.strftime(‘%Y-%m-%d’)+’.txt’, ‘a’) as f:<br>    weather_list &#x3D; get_weather()<br>    todayhistory_list &#x3D; get_todayhistory(month, day)<br>    wbtop_list_url, wbtop_list  &#x3D; get_weibotop10()<br>    hptop_list_url, hptop_list &#x3D; get_huputop10()<br>    ezutop_list_url, ezutop_list &#x3D; get_ezutop10()<br>    bdtop_list_url, bdtop_list &#x3D; get_baidutop10()<br>    rmtop_list_url, rmtop_list &#x3D; get_rmtop10(year+month+’0’*(2-len(str(int(day))))+str(int(day)-1))<br>    fastival_list_url, fastival_list, text &#x3D; get_fastival(md_date)<br>    sentence &#x3D; get_randomsentence()<br>    thing_title, thing_describe, thing_img_url &#x3D; get_thing()<br>    html &#x3D; ‘’<br>    html +&#x3D; htmlHead()<br>    html +&#x3D; h1title(‘今日要闻’)<br>    html +&#x3D; plaintext(‘今天是%d年%d月%d日，’%(int(year), int(month), int(day))+week+’。’)<br>    html +&#x3D; ‘<br>‘<br>    if (len(fastival_list) !&#x3D; 0):<br>        html +&#x3D; plaintext(‘今天是<b>%s</b>。’%(fastival_list[0])+text)<br>    html +&#x3D; quote(sentence)<br>    html +&#x3D; br()</p>
<pre><code>html += h2title(&#39;今日天气&#39;)
html += table(\[&#39;时间&#39;,&#39;天气&#39;,&#39;温度&#39;,&#39;风向&#39;,&#39;风级&#39;\], weather\_list)
html += br()

html += h2title(&#39;今日热点&#39;)
html += h3title(&#39;百度新闻&#39;)
html += ul(bdtop\_list\_url, bdtop\_list)
html += h3title(&#39;人民网&#39;)
html += ul(rmtop\_list\_url, rmtop\_list)
html += h3title(&#39;微博热搜&#39;)
html += ul(wbtop\_list\_url, wbtop\_list)
#html += h3title(&#39;虎扑步行街&#39;)
#html += ul(hptop\_list\_url, hptop\_list)
#html += h3title(&#39;豆瓣鹅组&#39;)
#html += ul(ezutop\_list\_url, ezutop\_list)
html += br()

html += h2title(&#39;每日百科&#39;)
html += h3title(&#39;历史上的今天&#39;)
html += table(\[&#39;年份&#39;,&#39;事件&#39;\], todayhistory\_list)
html += h3title(&#39;每日识物：&#39;+thing\_title)
html += insertImg(thing\_img\_url)
for each in thing\_describe:
    html += plaintext(each)
    html += &#39;&lt;br&gt;&#39;

html += htmlEnd()
return html
</code></pre>
<p>def main():<br>    html &#x3D; write_email()<br>    #today &#x3D; datetime.datetime.today()<br>    #with open(‘today_info’+’ ‘+today.strftime(‘%Y-%m-%d’)+’.txt’, ‘a’) as f:<br>    with open(‘&#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;today_info.html’, ‘a’) as f:<br>        f.write(html)</p>
<p>main()</p>
<p>整体没有什么特别难的，除了中国天气网总是抽风，以及动物百科页面有时候图片不对。后来把虎扑和豆瓣两个去掉了，只剩下人民网、百度、微博。虎扑和豆瓣鹅组热榜实在没什么营养。</p>
<h2 id="邮件编写"><a href="#邮件编写" class="headerlink" title="邮件编写"></a>邮件编写</h2><p>如果只是发文字的话，邮件实在是不太好看。好在邮件可以支持比较基础的html，但是不支持表外样式，也就是说必须把样式嵌入到html中，邮件才可以读出来。我使用mutt连接到qq邮箱的STPM进行发送，qq邮箱也只能识别一部分的css样式。一番尝试后，写了一个脚本来对一般文字、超链接、图片、列表、表格、各级标题进行邮件排版。</p>
<p>def h1title(string):<br>    html &#x3D; ‘<h1 style="color: var(--title-color); box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 2; margin: 6rem 0px 3rem; padding: 0px; width: inherit; position: relative; font-size: 3rem; font-family: SimSun; font-weight: 800; line-height: 3rem; text-align: center; text-transform: uppercase;">{}</h1>‘.format(string)<br>    return html</p>
<p>def h2title(string):<br>    html &#x3D; ‘<h2 style="color: var(--title-color); box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 2; padding: 0px; width: inherit; position: relative; font-size: 2rem; margin: 4rem auto; font-family: SimSun; font-weight: 800; line-height: 3rem; text-align: center; text-transform: uppercase;">{}</h2>‘.format(string)<br>    return html</p>
<p>def h3title(string):<br>    html &#x3D; ‘<h4 style="color: var(--title-color); box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 2; padding: 0px; width: inherit; position: relative; font-size: 1.5rem; margin: 3rem 0px; font-family: SimSun; font-weight: 600;">{}</h4>‘.format(string)<br>    return html</p>
<p>def plaintext(string):<br>    html &#x3D; ‘<p style="color: var(--text-color); box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px; padding: 0px; white-space: pre-wrap; width: inherit; position: relative;">{}</p>‘.format(string)<br>    return html</p>
<p>def urltext(string, url):<br>    html &#x3D; ‘<p style="color: var(--text-color); box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px; padding: 0px; white-space: pre-wrap; width: inherit; position: relative;"><a href="{}">{}</a></p>‘.format(url, string)<br>    return html</p>
<p>def quote(string):<br>    html &#x3D;’<blockquote style="margin: 0.8em 0px 0.8em 2em; padding: 0px 0px 0px 0.7em; border-left: 2px solid rgb(221, 221, 221);" formatblock="1"><i style=""><font color="#999999">{}</font></i></blockquote>‘.format(string)<br>    return html</p>
<p>def tablehead(thead):<br>    html &#x3D; ‘’<br>    head &#x3D; ‘<thead style="box-sizing: border-box; display: table-header-group;"><tr style="box-sizing: border-box; break-inside: avoid; break-after: auto;">‘<br>    end &#x3D; ‘</tr></thead>‘<br>    html +&#x3D; head<br>    trtemple &#x3D; ‘<th style="box-sizing: border-box; margin: 0; border-bottom: 0px; padding: .5rem 1rem; background: var(--thead-bg); border: 1px solid var(--thead-bg);">{}</th>‘<br>    for each in thead:<br>        html +&#x3D; trtemple.format(each)<br>    html +&#x3D; end<br>    return html</p>
<p>def tablebody(tbody):<br>    html &#x3D; ‘’<br>    head &#x3D; ‘<tbody style="box-sizing: border-box;">‘<br>    end &#x3D; ‘</tbody>‘<br>    html +&#x3D; head<br>    tdtemple &#x3D; ‘<td bgcolor="var(--tbody-bg)" style="box-sizing: border-box; margin: 0; position: relative; overflow: hidden; padding: 0.5rem 1rem; background-color: var(--tbody-bg); border: 1px solid var(--thead-bg); color: var(--text-color);">{}</td>‘<br>    for row in tbody:<br>        html +&#x3D; ‘<tr style="box-sizing: border-box; break-inside: avoid; break-after: auto;">‘<br>        for each in row:<br>            html +&#x3D; tdtemple.format(each)<br>        html +&#x3D; ‘</td>‘<br>    html +&#x3D; end<br>    return html</p>
<p>def table(thead, tbody): #tablehead是一个一维数组，tablebody是一个二维数组<br>    html &#x3D; ‘’<br>    head &#x3D; ‘<figure style="color: var(--text-color); box-sizing: border-box; overflow-x: auto; margin: 0px; padding: 0px; display: block;"><table align="left" style="box-sizing: border-box; border-collapse: collapse; border-spacing: 0; overflow: auto; break-inside: auto; text-align: left; margin: 1.5rem auto; width: 98%;" width="98%">‘<br>    end &#x3D; ‘</table></figure>‘<br>    html +&#x3D; head<br>    html +&#x3D; tablehead(thead)<br>    html +&#x3D; tablebody(tbody)<br>    html +&#x3D; end<br>    return html</p>
<p>def ul(urllist, stringlist):<br>    head &#x3D; ‘<ul style="color: var(--text-color); box-sizing: border-box; margin: 1.5rem auto 1.5rem 1.5rem; padding: 0px; position: relative; list-style: disc;">‘<br>    end &#x3D; ‘</ul>‘<br>    html &#x3D; ‘’<br>    html +&#x3D; head<br>    for each in zip(urllist, stringlist):<br>        html +&#x3D; li(each[0], each[1])<br>    html +&#x3D; end<br>    return html</p>
<p>def li(url, string):<br>    if url &#x3D;&#x3D; ‘’:<br>        html &#x3D; ‘<li style="box-sizing: border-box; margin: 0; position: relative; padding: 0; white-space: pre-wrap; margin-left: 1rem;">{}</li>‘.format(string)<br>    else:<br>        html &#x3D; ‘<li style="box-sizing: border-box; margin: 0; position: relative; padding: 0; white-space: pre-wrap; margin-left: 1rem;"><a href="{}">{}</a></li>‘.format(url, string)<br>    return html</p>
<p>def br():<br>    return ‘<hr style="box-sizing: border-box;">‘</p>
<p>def insertImg(url):<br>    html &#x3D; ‘<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin-top: 1rem; margin-bottom: 1rem; padding: 0; margin: 1rem auto; white-space: pre-wrap; width: inherit; position: relative;"><img src="{}" referrerpolicy="no-referrer" style="box-sizing: border-box; max-width: 100%; vertical-align: middle; border: 0; display: block; margin: 1.5rem auto; box-shadow: var(--img-shadow); border-radius: 5px;"></p>‘.format(url)<br>    return html</p>
<p>def htmlHead():<br>    return ‘<div id="original-content"><div class="is-node" id="write" style="box-sizing: border-box; margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; font-family: var(--base-font); font-weight: 400; font-size: 1rem; line-height: 2rem; background: var(--write-bg); max-width: 914px; text-align: justify;">‘</p>
<p>def htmlEnd():<br>    return ‘</div></div>‘</p>
<p>看看效果如何：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/image-1024x678.png"></p>
<h2 id="使用mutt发送邮件"><a href="#使用mutt发送邮件" class="headerlink" title="使用mutt发送邮件"></a>使用mutt发送邮件</h2><p>接下来需要配置mutt，使其可以自动发送邮件。mutt的配置过程网上教程很多，不做赘述。使用云服务器的需要注意，为了防止有人用云服务器发垃圾邮件，阿里、腾讯这些商家默认封掉了25号端口，没有解封前是无法使用mutt的。解封方式一般都是到云服务器的控制台页面操作。</p>
<p>使用mutt发送html格式的邮件，句法如下：</p>
<p>cat &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;today_info.html  mutt -s “今日天气与要文” -e ‘set content_type&#x3D;”text&#x2F;html”‘ $YOURADDRESS$</p>
<p>加上一个参数-e ‘set content_type&#x3D;”text&#x2F;html”‘即可。接下来制作一个sh脚本，首先运行python脚本，然后发送html文件，最后删掉html文件节省空间。</p>
<p>&#x2F;usr&#x2F;bin&#x2F;python3 &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;everydaynews.py<br>cat &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;today_info.html  mutt -s “今日天气与要文” -e ‘set content_type&#x3D;”text&#x2F;html”‘ $YOURADDRESS$<br>rm &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;today_info.html</p>
<h2 id="使用crontab定时发送邮件"><a href="#使用crontab定时发送邮件" class="headerlink" title="使用crontab定时发送邮件"></a>使用crontab定时发送邮件</h2><p>crontab是一个定时执行任务的系统功能。输入<code>crontab -e</code> 来添加定时任务，如下：</p>
<p>30 07 * * * bash &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;everydaynews.sh &gt; &#x2F;home&#x2F;ubuntu&#x2F;DayEmail&#x2F;log.txt 2&gt;&amp;1 &amp;</p>
<p>crontab的定时方法网上有很多解释。后面的部分是为了将脚本的输出放到一个log文件里，否则如果sh有输出却无法写入，crontab会报错，&amp;意味着这个过程放在后台进行，控制台上不显示sh的输出。</p>
<p>**还有一点非常重要：如果使用crontab，请确保你在crontab、bash、python中与文件相关的操作都使用绝对路径！**crontab无法读取相对路径，网上有一些通过修改系统环境来使得crontab能够读取相对路径的方法，如果只是简单的操作，还是使用绝对路径相对方便一些。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/ifc%E4%B8%AD%E6%9E%84%E4%BB%B6%E4%B8%8A%E6%B4%9E%E5%8F%A3%E7%9A%84%E8%A1%A8%E8%BE%BE%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/ifc%E4%B8%AD%E6%9E%84%E4%BB%B6%E4%B8%8A%E6%B4%9E%E5%8F%A3%E7%9A%84%E8%A1%A8%E8%BE%BE%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">IFC中构件上洞口的表达方式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:34:03" itemprop="dateCreated datePublished" datetime="2021-04-09T13:34:03+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/" itemprop="url" rel="index"><span itemprop="name">bim</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/IFC/" itemprop="url" rel="index"><span itemprop="name">IFC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这一篇随笔的例子如下：<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210226161517579-1765810054.png"><br>可以看到，标高为2的楼板有一个缺口。那么这块楼板在IFC中是如何表示的呢？往下看：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210226161517579-1765810054-1024x482.png"></p>
<h2 id="楼板形状的表示方式"><a href="#楼板形状的表示方式" class="headerlink" title="楼板形状的表示方式"></a>楼板形状的表示方式</h2><p>在Python中用ifcopenshell打开IFC文件，输入</p>
<p>import ifcopenshell<br>f &#x3D; ifcopenshell.open(‘project1_ifc4.ifc’)<br>slab_list &#x3D; f.by_type(‘ifcslab’)<br>slab_list[1].ObjectPlacement.PlacementRelTo.RelativePlacement.Location.Coordinates<br>(0.0, 0.0, 4000.0)</p>
<p>可以看到这块楼板的相对坐标参照点是(0.0, 0.0, 4000.0)，也就是标高2的位置。说明<code>slab_list[1]</code>就是我们想要找到的楼板。随后查看楼板的形状：</p>
<p>In [27]: slab_list[1].Representation.Representations<br>Out[27]:<br>(#973&#x3D;IfcShapeRepresentation(#120,’Body’,’SweptSolid’,(#963)),<br> #986&#x3D;IfcShapeRepresentation(#122,’FootPrint’,’Curve2D’,(#984)))</p>
<p>可以看出楼板的形态是通过两类IfcShapeRepresentation组成的。SweptSolid说明其Body是一个拉伸体；Curve2D说明其FootPrint（草图）是一个2D曲线。接下来分别查看这两个Individual的属性：</p>
<p>In [67]: slab_list[1].Representation.Representations[1].Items[0].Points #查看Curve2D的坐标点<br>Out[67]:<br>(#978&#x3D;IfcCartesianPoint((0.,20200.)),<br> #980&#x3D;IfcCartesianPoint((20200.,20200.)),<br> #982&#x3D;IfcCartesianPoint((20200.,0.)),<br> #10&#x3D;IfcCartesianPoint((0.,0.)),<br> #978&#x3D;IfcCartesianPoint((0.,20200.)))<br>In [75]: slab_list[1].Representation.Representations[0].Items[0].SweptArea #查看SweptArea的拉伸横截面区域<br>Out[75]: #959&#x3D;IfcRectangleProfileDef(.AREA.,$,#958,20200.,20200.0000000001)</p>
<p>可以看出，Curve2D中的点组成了一个闭环，构成楼板的草图；楼板的SweptArea的Xdim与Ydim则与楼板的长宽对应（如果楼板不是矩形会如何呢？之后再做研究）。然而，我们并没有看到洞口的信息在里面出现。</p>
<h2 id="洞口的信息"><a href="#洞口的信息" class="headerlink" title="洞口的信息"></a>洞口的信息</h2><p>显然，洞口的信息并不包括在楼板中。那么洞口会在哪里呢？在Protege中打开转换后的IFC文件，在IfcProduct下找，很快就可以找到了：<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210226163232286-1568754367.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210226163232286-1568754367-1024x993.png"></p>
<p>原来洞口属于IfcOpeningElement类。接下来用ifcopenshell进一步查看这个实例的属性：</p>
<p>In [98]: open_list &#x3D; f.by_type(‘IfcOpeningElement’)</p>
<p>In [99]: open_list<br>Out[99]: [#1012&#x3D;IfcOpeningElement(‘2dW1x8jJT85xQnO5ksAdUC’,#42,’楼板:常规 - 150mm:334036:2’,$,’Opening’,#1010,#1004,’334036’,$)]</p>
<p>In [100]: open_list[0].Representation.Representations<br>Out[100]: (#1002&#x3D;IfcShapeRepresentation(#120,’Body’,’SweptSolid’,(#996)),)</p>
<p>发现洞孔只存在一个SweptSolid作为形状的表示，猜测可能是因为洞口的形状是简单的矩形，因此只需要SweptSolid就可以表示了（不确定）。进一步查看洞口的其他属性：</p>
<p>In [114]: open_list[0].Representation.Representations[0].Items[0].Depth<br>Out[114]: 150.0</p>
<p>In [128]: open_list[0].ObjectPlacement.RelativePlacement.Location.Coordinates<br>Out[128]: (13000.0, 13000.0, 150.0)</p>
<p>In [136]: open_list[0].Representation.Representations[0].Items[0].SweptArea<br>Out[136]: #994&#x3D;IfcRectangleProfileDef(.AREA.,$,#993,4000.,4000.)</p>
<p>洞口深度为150，位置在(13000.0, 13000.0, 150.0)，SweptArea面积为（4000.,4000.)。这与我们的洞口是完全一致的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/ifc%E4%B8%AD%E6%9E%84%E4%BB%B6%E4%BD%8D%E7%BD%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/ifc%E4%B8%AD%E6%9E%84%E4%BB%B6%E4%BD%8D%E7%BD%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">IFC中构件位置的表示方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:32:09" itemprop="dateCreated datePublished" datetime="2021-04-09T13:32:09+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/" itemprop="url" rel="index"><span itemprop="name">bolgs</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/BIM/" itemprop="url" rel="index"><span itemprop="name">BIM</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/" itemprop="url" rel="index"><span itemprop="name">bim</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/IFC/" itemprop="url" rel="index"><span itemprop="name">IFC</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/IFC/%E6%9C%AC%E4%BD%93/" itemprop="url" rel="index"><span itemprop="name">本体</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>以STEP格式呈现的IFC文件可读性不强，但是转化为OWL后，可以在Protege中可视化IFC的组织模式。下面将通过Protege的OntoGragph功能显示一个墙实例是如何在IFC中进行位置表示的。</p>
<p>IFC通过相对位置来表示物体的位置：<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210222141600579-1518141270.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210222141600579-1518141270-1024x501.png"></p>
<p>可以看出，IfcWallStandardCase_278通过以下相对位置确定：Wall相对BuildingStorey（楼层）的位置——BuildingStorey相对Building的位置——Building相对Site的位置。那么相对位置的数值是如何表示的呢？如图：<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210222142042165-1372247468.png"><br>物体的位置通过IfcAxis2Placement3D来表示。IfcAxis2Placement3D提供在三维空间中放置项目的位置和方向。Axis定义Z方向，RefDirection定义X方向，Y方向通过右手定则得到。不过Wall278不存在Axis和RefDirection两个Object Properties，如果未给出Axis和RefDirection的属性值，则放置默认为P[1]（x轴）为[1,0,0.]，P[2]（y轴）为[0,1,0.]，P[3]（z轴）为[0,0,1]。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210222142042165-1372247468-1024x478.png"></p>
<p>进一步地，Location的属性通过笛卡尔点来表示。笛卡尔点的含义是：An IfcCartesianPoint defines a point by coordinates in an orthogonal, right-handed Cartesian coordinate system.也就是常规意义上的坐标点。不过在转化为OWL后，失去了直接表示一对多关系的能力，因此OWL通过一个类似链表的数据结构来表示这样一个三维坐标点，每个点保存在IfcLengthMeasureList中，前一个通过hasNext链接下一个。<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210222142816443-280782701.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210222142816443-280782701-1024x417.png"></p>
<p>通过相对位置关系和坐标点，其实也就可以推出物体在绝对坐标系下的位置了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/ifc%E8%BD%AC%E6%8D%A2%E4%B8%BArdf%E5%B9%B6%E5%9C%A8protege%E4%B8%AD%E6%9F%A5%E7%9C%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/ifc%E8%BD%AC%E6%8D%A2%E4%B8%BArdf%E5%B9%B6%E5%9C%A8protege%E4%B8%AD%E6%9F%A5%E7%9C%8B/" class="post-title-link" itemprop="url">IFC转换为RDF并在Protege中查看</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:30:32" itemprop="dateCreated datePublished" datetime="2021-04-09T13:30:32+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/" itemprop="url" rel="index"><span itemprop="name">bolgs</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bolgs/BIM/" itemprop="url" rel="index"><span itemprop="name">BIM</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/" itemprop="url" rel="index"><span itemprop="name">bim</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/IFC/" itemprop="url" rel="index"><span itemprop="name">IFC</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/IFC/%E6%9C%AC%E4%BD%93/" itemprop="url" rel="index"><span itemprop="name">本体</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>IFC为建筑信息模型的存储提供了一个准则。IFC文件有许多表述模式，例如STEP、RDF、OWL。理论上来说，这些格式都是可以互相转化的。STEP的可读性不佳，但是转化成RDF&#x2F;OWL后，就可以在Protege中进行查看，从而进一步了解IFC文件的组织格式。</p>
<h2 id="创建一个IFC文件并导出"><a href="#创建一个IFC文件并导出" class="headerlink" title="创建一个IFC文件并导出"></a>创建一个IFC文件并导出</h2><p>最快捷的方式：在Revit中创建一个项目并导出为IFC，这个模型包括四面墙，两个自定义族，导出格式为IFC2X3。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208143314485-610428827-1024x487.png"></p>
<h2 id="IFC2RDF"><a href="#IFC2RDF" class="headerlink" title="IFC2RDF"></a>IFC2RDF</h2><p><a target="_blank" rel="noopener" href="https://github.com/pipauwel/IFCtoRDF">https://github.com/pipauwel/IFCtoRDF</a> 提供了一个将IFC转化为RDF的工具。这个工具可以将.IFC后缀的文件转化为.TTL，支持以下IFC格式：</p>
<ul>
<li>IFC2X3_TC1</li>
<li>IFC4_ADD1</li>
<li>IFC4_ADD2</li>
<li>IFC4_ADD2_TC1</li>
<li>IFC4x1</li>
<li>IFC4</li>
<li>IFC4x3_RC1<br>下载其jar包后，与ifc文件放在同一目录下，打开当前目录的cmd输入：<br><code>java -jar .\IFCtoRDF-0.4-shaded.jar .\test.ifc .\testrdf.ttl</code><br>即在目录下生成了RDF文件。</li>
</ul>
<h2 id="在Protege下查看RDF文件"><a href="#在Protege下查看RDF文件" class="headerlink" title="在Protege下查看RDF文件"></a>在Protege下查看RDF文件</h2><p>用Protege打开RDF文件后，可以看到此文件包含的类与属性。</p>
<h3 id="IFC2RDF：消失的属性"><a href="#IFC2RDF：消失的属性" class="headerlink" title="IFC2RDF：消失的属性"></a>IFC2RDF：消失的属性</h3><p>在类下可以看到该文件包括的所有ifc类，以及它们的实例。如IfcWallStandardCase就有四个实例，对应四堵墙：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208143807637-1159831714-1024x534.png"></p>
<p>然而看不到任何的Object properties和Data properties。所以所有的properties都以Annotation properties的方式呈现，如图：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208153404433-1654703081-1024x534.png"></p>
<h3 id="IFC中原先定义了Object和data-properties吗？"><a href="#IFC中原先定义了Object和data-properties吗？" class="headerlink" title="IFC中原先定义了Object和data properties吗？"></a>IFC中原先定义了Object和data properties吗？</h3><p>答案是肯定的。从buildingSMART中下载ISO标准版本、TTL格式的IFC文档并用Protege打开，可以看到各类属性。首先是Data Property：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208153603799-1783262978-1024x534.png"></p>
<p>以及Object Properties：<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210208153624263-2072343321.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208153624263-2072343321-1024x534.png"></p>
<p>那么就有一个问题：IFC2RDF得到的RDF文件，annotation properties和标准版本的IFC中是否是一一对应的呢？</p>
<h2 id="IFC2RDF的缺陷，是否能够改正？"><a href="#IFC2RDF的缺陷，是否能够改正？" class="headerlink" title="IFC2RDF的缺陷，是否能够改正？"></a>IFC2RDF的缺陷，是否能够改正？</h2><h3 id="Data-properties的对应"><a href="#Data-properties的对应" class="headerlink" title="Data properties的对应"></a>Data properties的对应</h3><p>首先是hasInteger一类的Data properties，答案是：yes。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208154048037-1726307516-1024x534.png"></p>
<h3 id="Object-properties的对应"><a href="#Object-properties的对应" class="headerlink" title="Object properties的对应"></a>Object properties的对应</h3><p>Object properties的对应稍微复杂一点。以ifwallstandardcase中一堵墙的objectPlacement_IfcProduct作为例子，返回在IFC标准文件的Object properties搜索对应项。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210208154348812-118908687-1024x362.png"></p>
<p>我们发现，确实有一项称为ObjectPlacement的object properties，其domain为IfcProduct，Ranges为IfcObjectPlacement。<br>其他的properites大抵相同，也就是说_之前的是该object properties的URI，_之后的是该properties的domain。了解了这一点之后，我们就可以知道如何将IFC2RDF产生的文件进一步转化为OWL了。</p>
<h2 id="问题排查"><a href="#问题排查" class="headerlink" title="问题排查"></a>问题排查</h2><h3 id="问题之一：错误的前缀"><a href="#问题之一：错误的前缀" class="headerlink" title="问题之一：错误的前缀"></a>问题之一：错误的前缀</h3><p>IFC2RDF错误地使用了前缀，经过转换后，ttl文件中会有这样的前缀声明：</p>
<p># baseURI: <a target="_blank" rel="noopener" href="http://linkedbuildingdata.net/ifc/resources20210221/_142133/">http://linkedbuildingdata.net/ifc/resources20210221\_142133/</a></p>
<h1 id="imports-http-standards-buildingsmart-org-IFC-DEV-IFC2x3-TC1-OWL"><a href="#imports-http-standards-buildingsmart-org-IFC-DEV-IFC2x3-TC1-OWL" class="headerlink" title="imports: http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL"></a>imports: <a target="_blank" rel="noopener" href="http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL">http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL</a></h1><p>@prefix ifc:  <a target="_blank" rel="noopener" href="http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#">http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#</a> .<br>@prefix inst:  <a target="_blank" rel="noopener" href="http://linkedbuildingdata.net/ifc/resources20210221/_142133/">http://linkedbuildingdata.net/ifc/resources20210221\_142133/</a> .<br>@prefix list:  <a target="_blank" rel="noopener" href="https://w3id.org/list#">https://w3id.org/list#</a> .<br>@prefix express:  <a target="_blank" rel="noopener" href="https://w3id.org/express#">https://w3id.org/express#</a> .<br>@prefix rdf:  <a target="_blank" rel="noopener" href="http://www.w3.org/1999/02/22-rdf-syntax-ns#">http://www.w3.org/1999/02/22-rdf-syntax-ns#</a> .<br>@prefix xsd:  <a target="_blank" rel="noopener" href="http://www.w3.org/2001/XMLSchema#">http://www.w3.org/2001/XMLSchema#</a> .<br>@prefix owl:  <a target="_blank" rel="noopener" href="http://www.w3.org/2002/07/owl#">http://www.w3.org/2002/07/owl#</a> .</p>
<p>需要注意的是<code>@prefix ifc: &lt;http://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#&gt; .</code>在官方的IFCOWL定义中，其URI为<code>https://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#</code>。http和https的差别会使得预先定义好的OWL无法被导入。结局方法是把遗漏的“s”加上。</p>
<h3 id="问题之二：遗漏的导入"><a href="#问题之二：遗漏的导入" class="headerlink" title="问题之二：遗漏的导入"></a>问题之二：遗漏的导入</h3><p>IFC2RDF使用了<code>@prefix expr: &lt;https://w3id.org/express#&gt; .</code>这个模块，但是没有进行导入。这个问题可以通过手动添加导入解决，如果能够成功导入<a target="_blank" rel="noopener" href="https://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#">https://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#</a>的话，由于后者对前者存在依赖，也会间接导入。</p>
<h3 id="问题之三：无法从网络资源导入"><a href="#问题之三：无法从网络资源导入" class="headerlink" title="问题之三：无法从网络资源导入"></a>问题之三：无法从网络资源导入</h3><p>在导入<a target="_blank" rel="noopener" href="https://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#">https://standards.buildingsmart.org/IFC/DEV/IFC2x3/TC1/OWL#</a>时报错。这可能是对方服务器导致的，结局方法是从SMARTbuiding上保存TTL格式的IFC文件到本地，然后在Protege中进行手动导入。<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210221213033660-2081728904.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210221213033660-2081728904-1024x551.png"></p>
<p>以上步骤完成后，可以看到Object Properties和Data Properties都能正确地显示了。<br><img src="https://img2020.cnblogs.com/blog/2289857/202102/2289857-20210221213220995-1870717529.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210221213220995-1870717529-1024x322.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/protege%E4%B8%AD%E6%8E%A8%E7%90%86%E5%BC%95%E6%93%8E%E7%9A%84%E6%B5%8B%E8%AF%95%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/protege%E4%B8%AD%E6%8E%A8%E7%90%86%E5%BC%95%E6%93%8E%E7%9A%84%E6%B5%8B%E8%AF%95%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">Protege中推理引擎的测试使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:25:27" itemprop="dateCreated datePublished" datetime="2021-04-09T13:25:27+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/" itemprop="url" rel="index"><span itemprop="name">bim</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bim/%E6%9C%AC%E4%BD%93/" itemprop="url" rel="index"><span itemprop="name">本体</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Hermit简介"><a href="#Hermit简介" class="headerlink" title="Hermit简介"></a>Hermit简介</h2><p>（以下来自百度翻译）</p>
<blockquote>
<p>HermiT是使用Web本体语言（OWL）编写本体的推理机。给定一个OWL文件，HermiT可以确定本体是否一致，识别类之间的包容关系，等等。<br>HermiT是第一个公开的OWL推理机，它基于一个新的“hypertableau”演算，提供了比任何已知算法更有效的推理。以前需要几分钟或几小时来分类的本体通常可以在几秒钟内被HermiT分类，而HermiT是第一个能够对许多本体进行分类的推理者，这些本体以前被证明过于复杂，任何可用的系统都无法处理。<br>HermiT使用直接语义，并通过了所有owl2对直接语义推理器的一致性测试。</p>
</blockquote>
<p>HermiT是由牛津大学计算机科学数据与知识研究组开发的一款基于OWL的本体推理机。官网位于<a target="_blank" rel="noopener" href="http://www.hermit-reasoner.com/">http://www.hermit-reasoner.com/</a>。你可以通过Protege使用HermiT，这是最简单的方式；也可以使用HermiT提供的Java API来开发你自己的程序。这里主要展示如何在Protege中简单地使用HermiT进行推理。</p>
<h2 id="安装HermiT"><a href="#安装HermiT" class="headerlink" title="安装HermiT"></a>安装HermiT</h2><p>在最新版本的Protege中，HermiT是随Protege安装的，不需要手动安装。</p>
<h2 id="创建一个本体"><a href="#创建一个本体" class="headerlink" title="创建一个本体"></a>创建一个本体</h2><p>在测试集中，我建立了一个简单的亲属关系本体来进行测试。这个本体描述了几个人之间的亲属关系，以及年龄属性。我希望HermiT能基于规则（Rule）做到：</p>
<ol>
<li>推断并填补关系（Object properties），例如B是A的弟弟，A是C的母亲，则B是C的舅舅；</li>
<li>推断并赋予属性（Data properties），例如B的年龄是43（40-55），则B的年龄段是中年；<br>这个本体的视图如下：</li>
</ol>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210205230031604-2045046453-1024x687.png"></p>
<h2 id="SWRL"><a href="#SWRL" class="headerlink" title="SWRL"></a>SWRL</h2><p>SWRL（Semantic Web Rule Language）是由以语义的方式呈现规则的一种语言，SWRL的规则部分概念是由RuleML所演变而来，再结合OWL本体论形成。SWRL已经是W3C规范中的一员。SWRL相关的内容在中文网上比较难找到，最完善的学习资料是w3c自己在2004年发布的<a target="_blank" rel="noopener" href="https://www.w3.org/Submission/SWRL/">SWRL语言指导</a>。一段SWRL语言通过简单的“IF-THEN”语句来定义一串规则，其中IF和THEN都是通过Atom组成的，Atom描述了最为简单的一种假设，例如“XX是XX”、“XX的YY是ZZ”等。SWRL提供了七种Atom，分别是：</p>
<ol>
<li>描述，对应class；description ‘(‘ i-object ‘)’</li>
<li>数据，dataRange ‘(‘ d-object ‘)’</li>
<li>实体关系，对应Object properties；individualvaluedPropertyID ‘(‘ i-object i-object ‘)’</li>
<li>数据属性，对应Data properties；datavaluedPropertyID ‘(‘ i-object d-object ‘)’</li>
<li>相同，sameAs ‘(‘ i-object i-object ‘)’</li>
<li>相异，differentFrom ‘(‘ i-object i-object ‘)’</li>
<li>其他内建功能，builtIn ‘(‘ builtinID { d-object } ‘)’<br>内建功能提供了一些针对数字、字符串、日期的基础操作，在SWRL文档的8.1节有详细描述，这里不再赘述。（注意！HermiT不支持builtIn SWRL，所以虽然前面说了用HermiT，其实使用的是Drools一般推理引擎，前面懒得再修改了）</li>
</ol>
<p>SWRL的格式遵从<code>rule ::= &#39;Implies(&#39; [ URIreference ] &#123; annotation &#125; antecedent consequent &#39;)&#39;</code>的格式，其中atom之间通过‘&amp;’连接，antecedent和consequent之间用‘-&gt;’连接。一个例子如下：<br><code>hasParent(?x1,?x2) ∧ hasBrother(?x2,?x3) ⇒ hasUncle(?x1,?x3)</code><br>他描述了x1有x2作为家长，并且x2有x3作为兄弟，则x1有x3作为uncle（国外的uncle可以代表伯叔舅丈）。</p>
<h2 id="SWRL在Protege中的使用"><a href="#SWRL在Protege中的使用" class="headerlink" title="SWRL在Protege中的使用"></a>SWRL在Protege中的使用</h2><p>Protege内建了SWRLtab页面，在window-tab-swrltab中打开即可。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210206110931283-1723409561-1024x576.png"></p>
<p>选择new新建一个规则（年龄在40-55之间的年龄段为中年）：</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210206111715881-395938940-1024x792.png"></p>
<p>依次点击OWL+SRWL-&gt;Doorls，Run Doorls，Drools-&gt;OWL。分别执行了解析SRWL语言、推断和将知识保存到原来的知识图谱中。在知识图谱中，可以看到成功推断出王德法的年龄段是中年，作为男人也是人，龙傲天是小明的舅舅（同时也是亲属）等等。</p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210206111924837-2100724845-1024x551.png"></p>
<p><img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210206111933016-1796700196-1024x551.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/java%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%BC%96%E5%86%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/java%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%BC%96%E5%86%99/" class="post-title-link" itemprop="url">Java网络爬虫编写</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:17:56" itemprop="dateCreated datePublished" datetime="2021-04-09T13:17:56+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我最初刚学习Python时，对编程基本一窍不通，当时的想法很简单，只是为了学点简单的编程方便自己做点小玩意儿。当时自己编写的第一个应用就是爬虫，写完之后对Python的语法、模块安装、数据结构（虽然Python就不存在什么数据结构）等各种方面都有了入门级的了解。我个人认为，直接从一个项目开始学习比按部就班地按照课程学习会来的快得多，当然这是比较功利的，如果是真的想好好掌握Java这门语言的，应当还是按照课程慢慢学习。这篇文章主要参考了<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36146275/article/details/54974359">https://blog.csdn.net/weixin_36146275&#x2F;article&#x2F;details&#x2F;54974359</a>。</p>
<h2 id="新建一个Java项目"><a href="#新建一个Java项目" class="headerlink" title="新建一个Java项目"></a>新建一个Java项目</h2><p>在vscode中新建一个Java项目，会看到选择项目类型这个下拉框，里面有几种类型：Maven、Spring Boot、Quarkus、MicroProfile。他们的解释如下：</p>
<ul>
<li>Maven：Apache Maven是一个软件项目管理的综合工具。基于项目对象模型（POM）的概念，提供了帮助管理构建、文档、报告、依赖、发布等方法，Maven简化和标准化项目建设过程。Maven的基本原理是采用远程仓库和本地仓库以及一个核心的配置文件pom.xml，pom.xml中定义的jar文件从远程仓库下载到本地仓库，各个项目使用同一个本地仓库的jar，同一个版本的jar只需下载一次，而且避免每个应用都去拷贝jar。同时它采用了现在流行的插件体系架构，所以maven的核心非常的小，只有几兆大小的文件，在执行maven任务时，才会自动下载需要的插件。</li>
<li>Spring Boot：是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。Spring的一个最大的目的就是使JAVA EE开发更加容易。JavaEE：全称Java平台企业版（Java Platform Enterprise Edition），是Sun公司为企业级应用推出的标准平台。JavaEE是个大杂烩，包括Applet、EJB、JDBC、JNDI、Servlet、JSP等技术的标准，运行在一个完整的应用服务器上，用来开发大规模、分布式、健壮的网络应用。</li>
<li>Quarkus：一个针对OpenJDK HotSpot和GraalVM量身定制的Kubernetes本机Java堆栈，它是从最佳Java库和标准中精制而成的。</li>
<li>Eclipse MicroProfile：和Spring类似，是一个Jave EE的微服务框架。</li>
</ul>
<p>实际上初学者应该迟一些再接触这些框架。这里选择Maven进入下一步，Maven介绍和入门<a target="_blank" rel="noopener" href="https://www.cnblogs.com/OverloadBachPunk/p/14339962.html">传送门在这里</a>。</p>
<h2 id="Java模块（Jsoup）安装与导入"><a href="#Java模块（Jsoup）安装与导入" class="headerlink" title="Java模块（Jsoup）安装与导入"></a>Java模块（Jsoup）安装与导入</h2><p>Jsoup可以用于编写Java网络爬虫。官方介绍：Open source Java HTML parser, with the best of HTML5 DOM methods and CSS selectors, for easy data extraction.</p>
<p>在Maven+vscode的开发环境下中导入外部包非常方便。同样参照<a target="_blank" rel="noopener" href="https://www.cnblogs.com/OverloadBachPunk/p/14339962.html">Maven介绍和入门</a>。</p>
<h2 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h2><p>简便起见，将所有的功能都先写在main方法里。</p>
<h3 id="连接目标网页并获取内容"><a href="#连接目标网页并获取内容" class="headerlink" title="连接目标网页并获取内容"></a>连接目标网页并获取内容</h3><p>链接目标网页通过Jsoup的connect方法实现，参数为网页的url。Connection 接口还提供一个方法链来解决特殊请求，具体如下：</p>
<p> Document doc &#x3D; Jsoup.connect(“<a target="_blank" rel="noopener" href="http://example.com/">http://example.com</a>“;)<br>  .data(“query”, “Java”)<br>  .userAgent(“Mozilla”)<br>  .cookie(“auth”, “token”)<br>  .timeout(3000)<br>  .post();</p>
<p>最简单的例子（也是此爬虫使用的例子如下）：<br><code>Document doc = Jsoup.connect(&quot;http://news.sohu.com/&quot;).get();</code><br>这里需要使用到Jsoup的Document类。Document是一个装载html的文档类，它是Jsoup一个非常重要的类。所有的HTML文件都应该被声明为Document类才能被Jsoup进一步处理。</p>
<h4 id="Java的异常处理机制"><a href="#Java的异常处理机制" class="headerlink" title="Java的异常处理机制"></a>Java的异常处理机制</h4><p>注意，因为get取得和解析一个HTML文件。如果从该URL获取HTML时发生错误，便会抛出 IOException，应适当处理。处理的方法之一是在定义方法时，将这个异常抛出，如下：<br><code>public static void main( String[] args ) throws IOException</code><br>这种方法在方法签名中，用于声明该方法可能抛出的异常。还有其他的异常处理机制有：</p>
<ol>
<li>try：它里面放置可能引发异常的代码</li>
<li>catch：后面对应异常类型和一个代码块，用于表明该catch块用于处理这种类型的代码块，可以有多个catch块。</li>
<li>finally：主要用于回收在try块里打开的物力资源（如数据库连接、网络连接和磁盘文件），异常机制总是保证finally块总是被执行。只有finally块，执行完成之后，才会回来执行try或者catch块中的return或者throw语句，如果finally中使用了return或者 throw等终止方法的语句，则就不会跳回执行，直接停止。</li>
<li>throw：用于抛出一个实际的异常，可以单独作为语句使用，抛出一个具体的异常对象。</li>
</ol>
<h3 id="检索HTML内容"><a href="#检索HTML内容" class="headerlink" title="检索HTML内容"></a>检索HTML内容</h3><p>示例如下：<br><code>Elements newATags = doc.select(&quot;div.main-right&quot;).select(&quot;div.list16&quot;).select(&quot;ul&quot;).select(&quot;li&quot;).select(&quot;a&quot;);</code><br>Element类似Python中lxml通过xpath解析得到的“Elements”，在Jsoup中，可以通过select这个更为强大的方法直接获得所有满足检索条件的标签。这些标签被存在属于Elements类的newATags中，可以通过get方法来获取所需索引的Element，也可以通过for进行遍历。除此之外，比较常用的方法是attr()，获得相应属性名的属性值；text()获得标签内的文字。</p>
<h3 id="Java文件读写"><a href="#Java文件读写" class="headerlink" title="Java文件读写"></a>Java文件读写</h3><p>Java中最简单的写入文件方法是通过FileWriter类，如下：</p>
<pre><code>public void writeToFile( String str) &#123;
    try &#123;
        FileWriter out = new FileWriter(&quot;foobar.txt&quot;, true);
        out.write(str);
        out.close();
    &#125; catch (IOException e) &#123;
    &#125;
&#125;
</code></pre>
<p>调用这个方法，就可以以附加的形式逐条写入爬取内容。如果不加参数true，默认是false，即每次写入都会覆盖上一次的记录。</p>
<p>整体程序如下：</p>
<p>package lx;</p>
<p>import java.io.BufferedWriter;<br>import java.io.FileWriter;<br>import java.io.IOException;<br>import java.io.OutputStreamWriter;</p>
<p>import org.jsoup.Jsoup;<br>import org.jsoup.nodes.Document;<br>import org.jsoup.nodes.Element;<br>import org.jsoup.select.Elements;<br>&#x2F;**<br> * Hello world!<br> *<br> *&#x2F;<br>public class MyScrapy<br>{<br>    public void writeToFile( String str) {<br>        try {<br>            FileWriter out &#x3D; new FileWriter(“foobar.txt”, true);<br>            out.write(str);<br>            out.close();<br>        } catch (IOException e) {<br>        }<br>    }<br>    public static void main( String[] args ) throws IOException<br>    {<br>        MyScrapy scrapy &#x3D; new MyScrapy();<br>        Document doc &#x3D; Jsoup.connect(“<a target="_blank" rel="noopener" href="http://news.sohu.com/%22).get()">http://news.sohu.com/&quot;).get()</a>;<br>        Elements newATags &#x3D; doc.select(“div.main-right”).select(“div.list16”).select(“ul”).select(“li”).select(“a”);<br>        for (Element element:newATags){<br>            String url &#x3D; element.attr(“href”);<br>            if(url.indexOf(“&#x2F;&#x2F;“)&#x3D;&#x3D;0  url.indexOf(“<a target="_blank" rel="noopener" href="http://www.sohu.com/a/">http://www.sohu.com/a/</a>“)&lt;0){<br>                continue;<br>            }<br>            String title &#x3D; element.attr(“title”);<br>            Document dm &#x3D; Jsoup.connect(url).get();<br>            Elements em &#x3D; dm.select(“p”).select(“img”);<br>            if(em&#x3D;&#x3D;null  em.size()&lt;1){<br>                continue;<br>            }<br>            String img &#x3D; em.get(0).attr(“src”);<br>            if(img.indexOf(“&#x2F;&#x2F;“)&#x3D;&#x3D;0){<br>                img &#x3D; img.substring(2);<br>            }<br>            String output &#x3D; “url: “+url+” title: “+title + “ image: “+img;<br>            System.out.println(output);<br>            scrapy.writeToFile(output+’\n’);<br>        }<br>    }<br>}</p>
<h3 id="编译、运行、打包"><a href="#编译、运行、打包" class="headerlink" title="编译、运行、打包"></a>编译、运行、打包</h3><p>输入命令<code>mvn clean package</code>，然后在&#x2F;target&#x2F;classes目录下运行命令<code>java lx.MyScrapy</code>，却发现报错：</p>
<p>Exception in thread “main” java.lang.NoClassDefFoundError: org&#x2F;jsoup&#x2F;Jsoup<br>        at lx.MyScrapy.main(MyScrapy.java:29)<br>Caused by: java.lang.ClassNotFoundException: org.jsoup.Jsoup<br>        at java.base&#x2F;jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:606)<br>        at java.base&#x2F;jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:168)<br>        at java.base&#x2F;java.lang.ClassLoader.loadClass(ClassLoader.java:522)<br>        … 1 more</p>
<p>而在maven下直接编译运行java文件是可以运行的。经过一番搜索，发现这是因为maven在打包时就不会把外部依赖也打包进去，防止其他人在使用你的jar包时产生依赖冲突。stackoverflow上给出了通过在POM中加入插件项的解决办法，不过在vscode下，有更简单的方式将外部依赖打包到jar包中。</p>
<ol>
<li>首先用maven进行package，生成classes</li>
<li>在左侧窗口的JAVA PROJECT中，点击导出到jar文件<img src="http://82.156.1.75/wp-content/uploads/2021/04/2289857-20210128212727521-1250703072.png"></li>
<li>再运行<code>java -jar .\scrapy.jar</code>，此时jar文件可以运行。</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过这个爬虫教程，主要学习以下基础知识：</p>
<ol>
<li>Maven+VScode的基本使用方法；</li>
<li>Maven导入外部依赖包的基础方式；</li>
<li>Java中异常的处理方法；</li>
<li>Jsoup包的基本使用方式；</li>
<li>Java中基础的文件读写操作；</li>
<li>在VScode下对Java进行打包的简单方式。</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/%E4%BD%8D%E8%BF%90%E7%AE%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E4%BD%8D%E8%BF%90%E7%AE%97/" class="post-title-link" itemprop="url">位运算</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:05:49" itemprop="dateCreated datePublished" datetime="2021-04-09T13:05:49+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="位运算是什么"><a href="#位运算是什么" class="headerlink" title="位运算是什么"></a>位运算是什么</h2><p>位运算符主要针对二进制，它包括了：“与”、“非”、“或”、“异或”。从表面上看似乎有点像逻辑运算符，但逻辑运算符是针对两个关系运算符来进行逻辑运算，而位运算符主要针对两个二进制数的位进行逻辑运算。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = 0011 1100</span><br><span class="line">B = 0000 1101</span><br><span class="line">-----------------</span><br><span class="line">A&amp;B = 0000 1100</span><br><span class="line">A  B = 0011 1101</span><br><span class="line">A ^ B = 0011 0001</span><br><span class="line">~A= 1100 0011</span><br></pre></td></tr></table></figure>

<p>在这个例子中，A和B都用二进制表示，在十进制下，a &#x3D; 60，b &#x3D; 13。位运算符的定义如下：</p>
<p>符号</p>
<p>说明</p>
<p>示例</p>
<p>＆</p>
<p>按位与操作符，当且仅当两个操作数的某一位都非0时候结果的该位才为1。</p>
<p>（A＆B），得到12，即0000 1100</p>
<p>按位或操作符，只要两个操作数的某一位有一个非0时候结果的该位就为1。</p>
<p>（A B）得到61，即 0011 1101</p>
<p>^</p>
<p>按位补运算符翻转操作数的每一位。</p>
<p>（〜A）得到-61，即1100 0011</p>
<p>&lt;&lt;</p>
<p>按位左移运算符。左操作数按位左移右操作数指定的位数。</p>
<p>A &lt;&lt; 2得到240，即 1111 0000</p>
<p>&gt;&gt;</p>
<p>按位右移运算符。左操作数按位右移右操作数指定的位数。</p>
<p>A &gt;&gt; 2得到15即 1111</p>
<p>&gt;&gt;&gt;</p>
<p>按位右移补零操作符。左操作数的值按右操作数指定的位数右移，移动得到的空位以零填充。</p>
<p>A&gt;&gt;&gt;2得到15即0000 1111</p>
<h2 id="位运算有什么用"><a href="#位运算有什么用" class="headerlink" title="位运算有什么用"></a>位运算有什么用</h2><p>在计算机上，位运算的效率要高于普通运算，因为计算机本身是基于二进制的。在某些特殊算法中，位运算可以提升程序效率。下面是几个应用场景的例子。</p>
<ol>
<li>左移<code>&lt;&lt;</code>，如果是10进制向左移动一位，就成了10倍，移两位乘100倍。所以在数字没有溢出的前提下，对于正数和负数，二进制左移左移n位就相当于乘以2的n次方。</li>
<li><code>＆</code>运算，将一个单元与0进行位与运算结果为零；判断奇偶性：用if ((a &amp; 1) &#x3D;&#x3D; 0) 代替 if (a % 2 &#x3D;&#x3D; 0)来判断a是不是偶数。</li>
<li><code>&gt;&gt;</code>右移，右移常被用来做 &#x2F; (2 ^ n)的运算，因为直接基于二进制运算，所以右移效率比 &#x2F; (2 ^ n)高。</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/04/09/wordpress%E6%9B%B4%E6%94%B9%E5%9B%BA%E5%AE%9A%E8%BF%9E%E6%8E%A5%E5%90%8E%E9%A1%B5%E9%9D%A2404/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/wordpress%E6%9B%B4%E6%94%B9%E5%9B%BA%E5%AE%9A%E8%BF%9E%E6%8E%A5%E5%90%8E%E9%A1%B5%E9%9D%A2404/" class="post-title-link" itemprop="url">Wordpress更改固定连接后页面404</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 12:53:23" itemprop="dateCreated datePublished" datetime="2021-04-09T12:53:23+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/" itemprop="url" rel="index"><span itemprop="name">tech</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E8%B4%B4/" itemprop="url" rel="index"><span itemprop="name">技术贴</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/wordpress/" itemprop="url" rel="index"><span itemprop="name">wordpress</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>固定连接可以让wordpress的url显得更为美观。但是修改固定连接后，却发现原来的文章都无法访问，显示404。这是由于伪静态没有设置好造成的。</p>
<p>伪静态也可以理解成是一个对url重写的过程，这个过程会消耗CPU资源。所以访问人数比较多的时候，还是不要用伪静态的为好。但是我这个个人博客估计没有什么人会看，所以设置一个让自己看着舒服一点也没什么所谓。</p>
<p>环境布置如下：</p>
<ol>
<li>腾讯云1核2GB云服务器</li>
<li>ubuntu18.04</li>
<li>apache2</li>
<li>php7.2</li>
<li>wordpress5.7</li>
</ol>
<p>网上有很多针对apache的解决方法，但是apache2的方法会有一些不同。主要操作如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite #开启重写功能</span><br><span class="line">sudo nano /etc/apache2/apache2.conf</span><br><span class="line">#####在conf文件中找到下列语句</span><br><span class="line">&lt;Directory /&gt;</span><br><span class="line">        Options FollowSymLinks</span><br><span class="line">        AllowOverride None</span><br><span class="line">        Require all denied</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /usr/share&gt;</span><br><span class="line">        AllowOverride None</span><br><span class="line">        Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /var/www/&gt;</span><br><span class="line">        Options Indexes FollowSymLinks</span><br><span class="line">        AllowOverride None</span><br><span class="line">        Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#####把None改成All</span><br><span class="line">&lt;Directory /&gt;</span><br><span class="line">        Options FollowSymLinks</span><br><span class="line">        AllowOverride All</span><br><span class="line">        Require all denied</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /usr/share&gt;</span><br><span class="line">        AllowOverride All</span><br><span class="line">        Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /var/www/&gt;</span><br><span class="line">        Options Indexes FollowSymLinks</span><br><span class="line">        AllowOverride All</span><br><span class="line">        Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>

<p>完成后，输入<code>sudo systemctl restart apache2.service</code> 重启apache，问题解决，可以访问404的页面了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xiao Lin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">162</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/linxiaoshaw@foxmail.com" title="E-Mail → linxiaoshaw@foxmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Lin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
