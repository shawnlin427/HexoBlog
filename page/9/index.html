<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wonderful-sea-04900b000.6.azurestaticapps.net","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Shawn Lin&#39;s Blog">
<meta property="og:url" content="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/9/index.html">
<meta property="og:site_name" content="Shawn Lin&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Xiao Lin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/page/9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Shawn Lin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Shawn Lin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/11/06/excel%E4%B8%AD%E7%9A%84%E5%8C%B9%E9%85%8D%E5%87%BD%E6%95%B0%EF%BC%9Avlookup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/06/excel%E4%B8%AD%E7%9A%84%E5%8C%B9%E9%85%8D%E5%87%BD%E6%95%B0%EF%BC%9Avlookup/" class="post-title-link" itemprop="url">Excel中的匹配函数：VLOOKUP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-06 16:20:16" itemprop="dateCreated datePublished" datetime="2021-11-06T16:20:16+08:00">2021-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/" itemprop="url" rel="index"><span itemprop="name">tech</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/Office/" itemprop="url" rel="index"><span itemprop="name">Office</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>VLOOKUP有点像数据库中的join操作。例如，Sheet1中，A列数据是姓名，B列数据是导师名字；Sheet2中A列数据是姓名，B列数据是报告标题，两张表的排序还不一样，那么怎么把他们合起来呢？</p>
<p>只要在sheet1中的C列开头，写一行函数就够了：&#x3D;VLOOKUP(A1,Sheet2!A:B,2,0)</p>
<p>其中，A1就是姓名，Sheet2!A:B意思是在Sheet2中的A到B列查找与A1匹配的项（也就是【姓名：报告标题】），2指的是返回第二列的值也就是B列（报告标题）的值，0指的是精确查找。然后，一路拖到最后一行就可以了。</p>
<p>信息涉敏，就不做演示了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/11/05/ros2%E5%BC%80%E5%8F%91%E4%BD%93%E4%BC%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/05/ros2%E5%BC%80%E5%8F%91%E4%BD%93%E4%BC%9A/" class="post-title-link" itemprop="url">ROS2开发体会</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-05 17:15:52" itemprop="dateCreated datePublished" datetime="2021-11-05T17:15:52+08:00">2021-11-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>用了一段时间的ROS2，对它也有了更深的体会。</p>
<p>首先，如果想了解机器人，学ROS是没有用的。学习ROS的前提是你了解机器人学的最最基础的知识，比如正逆运动学推算，各类传感器，PID控制等等。如果对这些知识都基本了解，实际上，不需要ROS2也可以开发出一个可以实现功能的机器人。比如说，我们想开发一个可以自动跟随前方物体的机器人Dolly，那么想法可能就是接受激光雷达的数据，然后控制电机运动。接受激光雷达数据和控制电机运动，ROS都不是它们的前置条件。再比如，载人航天、飞行器，这些都涉及到控制，一定程度上也可以看作是机器人，但是大多都没有使用到ROS（不过NASA有计划之后使用ROS）。所以说，ROS之于机器人，就好像树莓派之于嵌入式开发，学会了树莓派，完全不同于学会了嵌入式开发，相反可能只能算摸到了门槛；而学会了ROS，也只是摸到了机器人开发的门槛。不过，如果学会了树莓派，可能可以更轻松地做一些嵌入式开发的工作，而学会了ROS，也可以更轻松地做一些机器人开发的工作。</p>
<p>如果决定要学习ROS了，那么以下是我的一些思考：</p>
<h2 id="ROS1还是ROS2？"><a href="#ROS1还是ROS2？" class="headerlink" title="ROS1还是ROS2？"></a>ROS1还是ROS2？</h2><p>ROS2相比ROS1，对多机器人控制的支持更好，并且实时性更好。虽然架构改变较大，但是在用户层面，API的变化并不大，许多ROS1中的教程，在适当修改后还能使用。所以说，如果之前接触过ROS1，学习ROS2并不会花太多时间，ROS2也提供了ROS1-2信息桥来传输信息。</p>
<p>而对于没有基础过ROS的人来说，ROS2无疑是更好的选择。</p>
<h2 id="如何学习？"><a href="#如何学习？" class="headerlink" title="如何学习？"></a>如何学习？</h2><p>我非常不建议在手头没有项目的时候去学习ROS，这样学完之后基本上只会复制粘贴代码。而且学习ROS必然会与硬件打交道，比如各类传感器和电机等，如果仅仅在仿真平台上学习ROS，到真实的开发中会显得捉襟见肘。</p>
<p>至于如何学习，ROS本身就有很完整的文档，可以作为初步入门使用。进一步地，可以在the construct网站上学习，这是一个提供完整ROS环境平台的学习网站，适合入门之后的进阶学习。</p>
<h2 id="平台？"><a href="#平台？" class="headerlink" title="平台？"></a>平台？</h2><p>可以供选择的平台很少，就是Ubuntu20.04.当然你也可以在其他版本的linux上从源码编译ROS2，或者在windows和macos上安装，但是…Why bother？何况windows11也支持wsl，也可以运行ros了。只有在迫不得已的情况下，只能使用其他平台，比如说手头只有Macbook，或者说使用nvidia的jetson系列（jetpack目前只有ubuntu18.04的）。</p>
<h2 id="形象地解释ROS"><a href="#形象地解释ROS" class="headerlink" title="形象地解释ROS"></a>形象地解释ROS</h2><p>有些人可能会疑惑，既然叫做Robot Operation System，那我学会了，我就可以operate robot了咯？实际上差的很远。就好像你是一个中世纪时期投石车的小队长，手下有几个小兵，有的负责装石头，有的负责转绞盘，有的负责拉引绳。这些小兵，有的是你一手培养的（自己写的与硬件交互的功能代码），有的是外面雇佣来的（第三方代码）。未了让这些小兵都乖乖听话，你发明了一套叫ROS（Rock-catapult Operation System）的系统。方法就是，每个小兵都配一个对讲机（不要问对讲机是从哪里来的），由你发号施令，小兵们按照命令进行操作。当然了，为了让小兵们能够执行你的命令，他们也要按照ROS的要求进行一定的学习（控制节点要能够接受ROS消息）。</p>
<p>那你可能就说了，好家伙，我这学了半天，原来就学了个发号施令？没有错，ROS就是一套消息收发机制。所以说学了ROS也不代表就能开发机器人了；甚至，不需要这一套机制也能开发机器人。</p>
<h2 id="ROS2开发的一些原则"><a href="#ROS2开发的一些原则" class="headerlink" title="ROS2开发的一些原则"></a>ROS2开发的一些原则</h2><ol>
<li>spin()会阻断任何后面的命令，除非被手动终止。所以要根据不同的情况使用spin_once和spin_until_future_complete；</li>
<li>每个节点执行的任务应当尽可能少。虽然可以让一个节点同时读取多个传感器的命令并发送到不同的topic上，但是这可能会导致传感器数据时间不统一；</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/11/04/ros2realsense/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/04/ros2realsense/" class="post-title-link" itemprop="url">ROS2+Realsense</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-04 11:05:50" itemprop="dateCreated datePublished" datetime="2021-11-04T11:05:50+08:00">2021-11-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ROS2-Package-for-Intel®-RealSense™-Devices"><a href="#ROS2-Package-for-Intel®-RealSense™-Devices" class="headerlink" title="ROS2 Package for Intel® RealSense™ Devices"></a>ROS2 Package for Intel® RealSense™ Devices</h1><h2 id="Supported-Devices"><a href="#Supported-Devices" class="headerlink" title="Supported Devices"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#supported-devices"></a>Supported Devices</h2><ul>
<li>Intel® RealSense™ Camera D400-Series<ul>
<li>Intel® RealSense™ Depth Cameras D415, D435 and D435i</li>
</ul>
</li>
<li>Intel® RealSense™ Tracking Camera T265</li>
</ul>
<h2 id="Installation-Instructions"><a href="#Installation-Instructions" class="headerlink" title="Installation Instructions"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#installation-instructions"></a>Installation Instructions</h2><p>The following instructions were verified with ROS2 Foxy on Ubuntu 20.04. The software is verified with ROS2 Dashing on Ubuntu 18.04 also, with the same instructions replacing “foxy” with “dashing”.</p>
<h3 id="Install-Dependencies"><a href="#Install-Dependencies" class="headerlink" title="Install Dependencies"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#install-dependencies"></a>Install Dependencies</h3><h4 id="1-Install-ROS2-packages-ros-foxy-desktop"><a href="#1-Install-ROS2-packages-ros-foxy-desktop" class="headerlink" title="1. Install ROS2 packages ros-foxy-desktop"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#1-install-ros2-packages-ros-foxy-desktop"></a>1. Install ROS2 packages <a target="_blank" rel="noopener" href="https://index.ros.org/doc/ros2/Installation/Linux-Install-Debians/">ros-foxy-desktop</a></h4><h4 id="2-Install-ROS2-dependences"><a href="#2-Install-ROS2-dependences" class="headerlink" title="2. Install ROS2 dependences"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#2-install-ros2-dependences"></a>2. Install ROS2 dependences</h4><p>Currently, we support librealsense master branch.</p>
<p>sudo apt-get install ros-foxy-librealsense2</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/IntelRealSense/librealsense.git">Intel® RealSense™ SDK 2.0</a></li>
</ul>
<h4 id="3-Install-other-non-ROS-debian-packages"><a href="#3-Install-other-non-ROS-debian-packages" class="headerlink" title="3. Install other non-ROS debian packages"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#3-install-other-non-ros-debian-packages"></a>3. Install other non-ROS debian packages</h4><p>sudo apt-get install -y libssl-dev libusb-1.0-0-dev pkg-config libgtk-3-dev<br>sudo apt-get install -y libglfw3-dev libgl1-mesa-dev libglu1-mesa-dev</p>
<h3 id="Install-ros2-intel-realsense-From-Source"><a href="#Install-ros2-intel-realsense-From-Source" class="headerlink" title="Install ros2_intel_realsense From Source"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#install-ros2_intel_realsense-from-source"></a>Install ros2_intel_realsense From Source</h3><p># fetch code<br>mkdir -p ~&#x2F;ros2_ws&#x2F;src<br>cd ~&#x2F;ros2_ws&#x2F;src<br>git clone <a target="_blank" rel="noopener" href="https://github.com/intel/ros2/_intel/_realsense.git">https://github.com/intel/ros2\_intel\_realsense.git</a><br>cd ros2_intel_realsense<br>git checkout refactor</p>
<h1 id="build"><a href="#build" class="headerlink" title="build"></a>build</h1><p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>cd ~&#x2F;ros2_ws<br>colcon build –symlink-install</p>
<h2 id="Usage-Instructions"><a href="#Usage-Instructions" class="headerlink" title="Usage Instructions"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#usage-instructions"></a>Usage Instructions</h2><h3 id="Start-Camera-Node"><a href="#Start-Camera-Node" class="headerlink" title="Start Camera Node"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#start-camera-node"></a>Start Camera Node</h3><p>Obtain the serial number of your device</p>
<p>rs-enumerate-devices</p>
<p>Change the corresponding yaml file with the specific serial number, e.g. for <a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/blob/refactor/realsense_ros/config/d435.yaml#L3">d435.yaml</a> in line3:</p>
<blockquote>
<p>serial_no: &lt;serial_number_of_your_device&gt; # d435</p>
</blockquote>
<p>To start the camera node in ROS2, plug in the camera, then type the following command:</p>
<h4 id="Single-camera-taking-d435-for-example"><a href="#Single-camera-taking-d435-for-example" class="headerlink" title="Single camera, taking d435 for example:"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#single-camera-taking-d435-for-example"></a>Single camera, taking d435 for example:</h4><p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>source ~&#x2F;ros2_ws&#x2F;install&#x2F;local_setup.bash</p>
<h2 id="using-ros2-run"><a href="#using-ros2-run" class="headerlink" title="using ros2 run"></a>using ros2 run</h2><p>cd ~&#x2F;ros2_ws<br>ros2 run realsense_node realsense_node __params:&#x3D;`ros2 pkg prefix realsense_examples`&#x2F;share&#x2F;realsense_ros&#x2F;config&#x2F;d435.yaml __ns:&#x3D;&#x2F;d435</p>
<h2 id="using-ros2-launch"><a href="#using-ros2-launch" class="headerlink" title="using ros2 launch"></a>using ros2 launch</h2><p>ros2 launch realsense_examples rs_camera.launch.py</p>
<h4 id="Multi-camera-taking-d435-and-t265-for-example"><a href="#Multi-camera-taking-d435-and-t265-for-example" class="headerlink" title="Multi camera, taking d435 and t265 for example:"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#multi-camera-taking-d435-and-t265-for-example"></a>Multi camera, taking d435 and t265 for example:</h4><ul>
<li>Terminal 1:</li>
</ul>
<p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>source ~&#x2F;ros2_ws&#x2F;install&#x2F;local_setup.bash</p>
<p>cd ~&#x2F;ros2_ws<br>ros2 run realsense_node realsense_node __params:&#x3D;`ros2 pkg prefix realsense_examples`&#x2F;share&#x2F;realsense_examples&#x2F;config&#x2F;d435.yaml __ns:&#x3D;&#x2F;d435</p>
<ul>
<li>Terminal 2:</li>
</ul>
<p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>source ~&#x2F;ros2_ws&#x2F;install&#x2F;local_setup.bash</p>
<p>cd ~&#x2F;ros2_ws<br>ros2 run realsense_node realsense_node __params:&#x3D;`ros2 pkg prefix realsense_examples`&#x2F;share&#x2F;realsense_examples&#x2F;config&#x2F;t265.yaml __ns:&#x3D;&#x2F;t265</p>
<ul>
<li>Or using ros2 launch :</li>
</ul>
<p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>source ~&#x2F;ros2_ws&#x2F;install&#x2F;local_setup.bash</p>
<p>cd ~&#x2F;ros2_ws</p>
<h2 id="before-launch-all-the-cameras-serial-number-should-be-set-in-the-launch-file"><a href="#before-launch-all-the-cameras-serial-number-should-be-set-in-the-launch-file" class="headerlink" title="before launch all the cameras, serial number should be set in the launch file"></a>before launch all the cameras, serial number should be set in the launch file</h2><p>ros2 launch realsense_examples rs_multiple_devices.launch.py</p>
<h4 id="Multi-camera-with-tf-transform-taking-d435-and-t265-for-example"><a href="#Multi-camera-with-tf-transform-taking-d435-and-t265-for-example" class="headerlink" title="Multi camera with tf(transform), taking d435 and t265 for example:"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#multi-camera-with-tftransform-taking-d435-and-t265-for-example"></a>Multi camera with tf(transform), taking d435 and t265 for example:</h4><p>source &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;setup.bash<br>source ~&#x2F;ros2_ws&#x2F;install&#x2F;local_setup.bash</p>
<p>cd ~&#x2F;ros2_ws</p>
<h2 id="before-launch-all-the-cameras-serial-number-should-be-set-in-the-launch-file-1"><a href="#before-launch-all-the-cameras-serial-number-should-be-set-in-the-launch-file-1" class="headerlink" title="before launch all the cameras, serial number should be set in the launch file"></a>before launch all the cameras, serial number should be set in the launch file</h2><p>ros2 launch realsense_examples rs_t265_and_d400.launch.py</p>
<p><em><strong>for more usage of these launch files in realsense_examples&#x2F;launch, please refer to our <a target="_blank" rel="noopener" href="https://inte.github.io/robot_devkit">robot devkit</a> project, includes SLAM and navigation etc.</strong></em></p>
<h3 id="Configure-Parameters-at-Runtime"><a href="#Configure-Parameters-at-Runtime" class="headerlink" title="Configure Parameters at Runtime"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#configure-parameters-at-runtime"></a>Configure Parameters at Runtime</h3><p>Currently only support reconfigure parameters by <code>ros2 param</code> at runtime, e.g.</p>
<p>Enable camera stream</p>
<p>ros2 param list<br>ros2 param get &lt;node_name&gt; color0.enabled<br>ros2 param set &lt;node_name&gt; color0.enabled true</p>
<p>Enable aligned depth</p>
<p>ros2 param set &lt;node_name&gt; align_depth true</p>
<p>Enable pointcloud</p>
<p>ros2 param set &lt;node_name&gt; enable_pointcloud true</p>
<h2 id="Contribution-Instructions"><a href="#Contribution-Instructions" class="headerlink" title="Contribution Instructions"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#contribution-instructions"></a>Contribution Instructions</h2><p>Contirbution to this project is welcomed! For any patches pleaes make sure regression tests passed. For new features added please add test cases also.</p>
<h3 id="Run-Colcon-test"><a href="#Run-Colcon-test" class="headerlink" title="Run Colcon test"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#run-colcon-test"></a>Run Colcon test</h3><p># plugin the Realsense device</p>
<h1 id="invoke-colcon-test"><a href="#invoke-colcon-test" class="headerlink" title="invoke colcon test"></a>invoke colcon test</h1><p>colcon test –packages-select realsense_msgs realsense_node realsense_ros realsense_examples</p>
<h1 id="check-test-logs"><a href="#check-test-logs" class="headerlink" title="check test logs"></a>check test logs</h1><p>vim log&#x2F;latest_test&#x2F;&lt;package name as `realsense_xxx`&gt;&#x2F;stdout.log</p>
<h2 id="Published-Topics"><a href="#Published-Topics" class="headerlink" title="Published Topics"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#published-topics"></a>Published Topics</h2><ul>
<li>D435 and D415</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;color&#x2F;image_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;color&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;infra1&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;infra1&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;infra2&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;infra2&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;depth&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;depth&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;aligned_depth_to_color&#x2F;image_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;aligned_depth_to_color&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/PointCloud2.msg">camera&#x2F;pointcloud</a></p>
<ul>
<li>D435i</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;color&#x2F;image_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;color&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;infra1&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;infra1&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;infra2&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;infra2&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;depth&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;depth&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;aligned_depth_to_color&#x2F;image_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;aligned_depth_to_color&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/PointCloud2.msg">camera&#x2F;pointcloud</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Imu.msg">camera&#x2F;gyro&#x2F;sample</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/blob/refactor/realsense_msgs/msg/IMUInfo.msg">camera&#x2F;gyro&#x2F;imu_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Imu.msg">camera&#x2F;accel&#x2F;sample</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/blob/refactor/realsense_msgs/msg/IMUInfo.msg">camera&#x2F;accel&#x2F;imu_info</a></p>
<ul>
<li>T265</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;fisheye1&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;fisheye1&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Image.msg">camera&#x2F;fisheye2&#x2F;image_rect_raw</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/CameraInfo.msg">camera&#x2F;fisheye1&#x2F;camera_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Imu.msg">camera&#x2F;gyro&#x2F;sample</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/blob/refactor/realsense_msgs/msg/IMUInfo.msg">camera&#x2F;gyro&#x2F;imu_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/sensor_msgs/msg/Imu.msg">camera&#x2F;accel&#x2F;sample</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/blob/refactor/realsense_msgs/msg/IMUInfo.msg">camera&#x2F;accel&#x2F;imu_info</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ros2/common_interfaces/blob/master/nav_msgs/msg/Odometry.msg">camera&#x2F;odom&#x2F;sample</a></p>
<h2 id="Known-Issues"><a href="#Known-Issues" class="headerlink" title="Known Issues"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#known-issues"></a>Known Issues</h2><ul>
<li>Don’t support dynamic reconfigure parameters by rqt_reconfigure due to <a target="_blank" rel="noopener" href="https://github.com/ros-visualization/rqt_reconfigure/issues/53">issue#53</a> of rqt_reconfigure, but you still can reconfigure parameters by <code>ros2 param</code>.</li>
<li>We support Ubuntu Linux Bionic Beaver 18.04 on 64-bit, but not support Mac OS X 10.12 (Sierra) and Windows 10 yet.</li>
</ul>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#todo"></a>TODO</h2><ul>
<li>Merge sensor data from gyroscope and accelerator into one topic</li>
<li>Support diagnostics</li>
<li>Support reconfigure parameters by GUI</li>
</ul>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a><a target="_blank" rel="noopener" href="https://github.com/intel/ros2_intel_realsense/tree/refactor#license"></a>License</h2><p>Copyright 2019 Intel Corporation</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this project except in compliance with the License. You may obtain a copy of the License at</p>
<p><a target="_blank" rel="noopener" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>*<em>Other names and brands may be claimed as the property of others</em></p>
<p>Any security issue should be reported using process at <a target="_blank" rel="noopener" href="https://01.org/security">https://01.org/security</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/11/03/ros2%EF%BC%9A%E5%90%8C%E6%97%B6%E8%AE%A2%E9%98%85%E5%A4%9A%E4%B8%AAtopic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/03/ros2%EF%BC%9A%E5%90%8C%E6%97%B6%E8%AE%A2%E9%98%85%E5%A4%9A%E4%B8%AAtopic/" class="post-title-link" itemprop="url">ROS2：同时订阅多个Topic</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-03 00:43:17" itemprop="dateCreated datePublished" datetime="2021-11-03T00:43:17+08:00">2021-11-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有的时候我们需要同时订阅对个topic，比如说我们的tf数据可能来源于多个传感器。一种方法是在一个Node里顺序读取这些传感器，但是可能会造成代码耦合和数据互相干扰的问题。一个比较好的办法是各有一个node负责数据的读取和发送，最后使用一个节点来订阅多个话题来获取这些数据。</p>
<p>为了做到这一点，我们需要使用message_filter。示例代码如下：</p>
<p>from geometry_msgs.msg import TransformStamped<br>from sensor_msgs.msg import Imu<br>from sensor_msgs.msg import Range<br>import rclpy<br>from rclpy.node import Node<br>import math<br>import time<br>import message_filters<br>from tf2_ros import TransformBroadcaster<br>import VL53L0X<br>import tf_transformations<br>from turtlesim.msg import Pose</p>
<p>class FramePublisher(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;cranebot\_frame\_publisher&#39;)
    self.imu\_sub = message\_filters.Subscriber(self, Imu, &#39;/cranebot/imu&#39;)
    self.tof1\_sub = message\_filters.Subscriber(self, Range, &#39;/cranebot/tof1&#39;)
    self.tof2\_sub = message\_filters.Subscriber(self, Range, &#39;/cranebot/tof2&#39;)
    ts = message\_filters.TimeSynchronizer(\[self.imu\_sub, self.tof1\_sub, self.tof2\_sub\], 10)
    ts.registerCallback(self.handle\_cranebot\_pose)
    self.br = TransformBroadcaster(self)

def handle\_cranebot\_pose(self, imu, tof1, tof2):
</code></pre>
<p>message_filter的工作方法是同时订阅多个话题后，接收到一组完整的数据才会执行callback。</p>
<p>不同topic传输的数据会有时间上的差别，TimeSynchronizer则可以让这些数据以近似相同的时间戳被接受。</p>
<p>多个话题的订阅，则需要使用Subscriber方法，其参数分别为Node、消息类型和topic。</p>
<p>最终，需要注册一个callback，也就是registerCallback，参数为回调函数。</p>
<p>回调函数的参数顺序和数量应当和订阅的多个topic的顺序与数量一致。</p>
<p>如上，则完成了对多个话题的订阅。很惊讶居然全网都几乎找不到相关问题的针对ros2的python解决方法。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/29/mathtype6-9%E4%BF%9D%E5%A7%86%E7%BA%A7%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%E4%BA%B2%E6%B5%8B%E5%8F%AF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/29/mathtype6-9%E4%BF%9D%E5%A7%86%E7%BA%A7%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%E4%BA%B2%E6%B5%8B%E5%8F%AF%E7%94%A8/" class="post-title-link" itemprop="url">Mathtype6.9保姆级安装教程亲测可用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-29 16:02:59" itemprop="dateCreated datePublished" datetime="2021-10-29T16:02:59+08:00">2021-10-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Bolgs/" itemprop="url" rel="index"><span itemprop="name">Bolgs</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/390647024">https://zhuanlan.zhihu.com/p/390647024</a></p>
<p>以野兽的心境，向着收费软件的心脏开火，，，</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/25/tf2-lookupexception%E6%9F%A5%E8%AF%A2%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/25/tf2-lookupexception%E6%9F%A5%E8%AF%A2%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">tf2.LookupException查询问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-25 21:25:46" itemprop="dateCreated datePublished" datetime="2021-10-25T21:25:46+08:00">2021-10-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果直接在Python命令行里这样查询TF：</p>
<p>a.tf_buffer.lookup_transform(‘cab’, ‘car’, now, Duration(seconds&#x3D;1.0))</p>
<p>会报错：</p>
<p>Traceback (most recent call last):<br>  File “<stdin>“, line 1, in <module><br>  File “&#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;lib&#x2F;python3.8&#x2F;site-packages&#x2F;tf2_ros&#x2F;buffer.py”, line 112, in lookup_transform<br>    return self.lookup_transform_core(target_frame, source_frame, time)<br>tf2.LookupException: “cab” passed to lookupTransform argument target_frame does not exist.</p>
<p>报错显示，查询的frame不存在。这是因为，now指向的ros时钟不对。如果没有spin过节点，节点时钟未同步过，那么就无法查询到frame。</p>
<p>然而使用了spin_once后，查询其他的节点也报错。这是因为，spin_once仅接受到一条消息，剩下的tf2消息无法收到。因此，查询函数应当这样：</p>
<p>def get_tf(j1, j2, time):<br>    future &#x3D; a.tf_buffer.wait_for_transform_async(j1, j2, time)<br>    rclpy.spin_until_future_complete(a, future)<br>    tf &#x3D;  a.tf_buffer.lookup_transform(j1, j2, time)<br>    return tf</p>
<p>其中，time应当为a.get_clock().now()。这样就解决了这个问题。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/17/calling-parent-class-init-with-multiple-inheritance-whats-the-right-way/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/17/calling-parent-class-init-with-multiple-inheritance-whats-the-right-way/" class="post-title-link" itemprop="url">Calling parent class __init__ with multiple inheritance, what's the right way?</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-17 15:26:07" itemprop="dateCreated datePublished" datetime="2021-10-17T15:26:07+08:00">2021-10-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/" itemprop="url" rel="index"><span itemprop="name">tech</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tech/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/9575409/calling-parent-class-init-with-multiple-inheritance-whats-the-right-way">https://stackoverflow.com/questions/9575409/calling-parent-class-init-with-multiple-inheritance-whats-the-right-way</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/17/ros2%EF%BC%9Aaction%E7%9A%84%E5%8F%96%E6%B6%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/17/ros2%EF%BC%9Aaction%E7%9A%84%E5%8F%96%E6%B6%88/" class="post-title-link" itemprop="url">ROS2：Action的取消</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-17 00:00:16" itemprop="dateCreated datePublished" datetime="2021-10-17T00:00:16+08:00">2021-10-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Action涉及到很多异步操作，尤其是取消Action。如果没有接触过异步操作的（比如我），刚开始上手会很困难。</p>
<p>但是实际上，Action的取消只有两个关键要素：</p>
<ol>
<li>使用send_goal_handle进行取消；</li>
<li>server端要声明cancel_callback&#x3D;self.cancel_callback。</li>
</ol>
<p>我们来看ROS2官方提供的代码：</p>
<h2 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h2><p># Copyright 2018 Open Source Robotics Foundation, Inc.</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="Licensed-under-the-Apache-License-Version-2-0-the-“License”"><a href="#Licensed-under-the-Apache-License-Version-2-0-the-“License”" class="headerlink" title="Licensed under the Apache License, Version 2.0 (the “License”);"></a>Licensed under the Apache License, Version 2.0 (the “License”);</h1><h1 id="you-may-not-use-this-file-except-in-compliance-with-the-License"><a href="#you-may-not-use-this-file-except-in-compliance-with-the-License" class="headerlink" title="you may not use this file except in compliance with the License."></a>you may not use this file except in compliance with the License.</h1><h1 id="You-may-obtain-a-copy-of-the-License-at"><a href="#You-may-obtain-a-copy-of-the-License-at" class="headerlink" title="You may obtain a copy of the License at"></a>You may obtain a copy of the License at</h1><h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1><h1 id="http-www-apache-org-licenses-LICENSE-2-0"><a href="#http-www-apache-org-licenses-LICENSE-2-0" class="headerlink" title="http://www.apache.org/licenses/LICENSE-2.0"></a><a target="_blank" rel="noopener" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></h1><h1 id="-2"><a href="#-2" class="headerlink" title=""></a></h1><h1 id="Unless-required-by-applicable-law-or-agreed-to-in-writing-software"><a href="#Unless-required-by-applicable-law-or-agreed-to-in-writing-software" class="headerlink" title="Unless required by applicable law or agreed to in writing, software"></a>Unless required by applicable law or agreed to in writing, software</h1><h1 id="distributed-under-the-License-is-distributed-on-an-“AS-IS”-BASIS"><a href="#distributed-under-the-License-is-distributed-on-an-“AS-IS”-BASIS" class="headerlink" title="distributed under the License is distributed on an “AS IS” BASIS,"></a>distributed under the License is distributed on an “AS IS” BASIS,</h1><h1 id="WITHOUT-WARRANTIES-OR-CONDITIONS-OF-ANY-KIND-either-express-or-implied"><a href="#WITHOUT-WARRANTIES-OR-CONDITIONS-OF-ANY-KIND-either-express-or-implied" class="headerlink" title="WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."></a>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</h1><h1 id="See-the-License-for-the-specific-language-governing-permissions-and"><a href="#See-the-License-for-the-specific-language-governing-permissions-and" class="headerlink" title="See the License for the specific language governing permissions and"></a>See the License for the specific language governing permissions and</h1><h1 id="limitations-under-the-License"><a href="#limitations-under-the-License" class="headerlink" title="limitations under the License."></a>limitations under the License.</h1><p>import time</p>
<p>from example_interfaces.action import Fibonacci</p>
<p>import rclpy<br>from rclpy.action import ActionServer, CancelResponse, GoalResponse<br>from rclpy.callback_groups import ReentrantCallbackGroup<br>from rclpy.executors import MultiThreadedExecutor<br>from rclpy.node import Node</p>
<p>class MinimalActionServer(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;minimal\_action\_server&#39;)

    self.\_goal\_handle = None

    self.\_action\_server = ActionServer(
        self,
        Fibonacci,
        &#39;fibonacci&#39;,
        execute\_callback=self.execute\_callback,
        callback\_group=ReentrantCallbackGroup(),
        goal\_callback=self.goal\_callback,
        handle\_accepted\_callback=self.handle\_accepted\_callback,
        cancel\_callback=self.cancel\_callback)

def destroy(self):
    self.\_action\_server.destroy()
    super().destroy\_node()

def goal\_callback(self, goal\_request):
    ...

def handle\_accepted\_callback(self, goal\_handle):
    ...

def cancel\_callback(self, goal\_handle):
    &quot;&quot;&quot;Accept or reject a client request to cancel an action.&quot;&quot;&quot;
    self.get\_logger().info(&#39;Received cancel request&#39;)
    return CancelResponse.ACCEPT

def timer\_callback(self):
    ...

async def execute\_callback(self, goal\_handle):
    &quot;&quot;&quot;Execute a goal.&quot;&quot;&quot;
    self.get\_logger().info(&#39;Executing goal...&#39;)

    # Append the seeds for the Fibonacci sequence
    feedback\_msg = Fibonacci.Feedback()
    feedback\_msg.sequence = \[0, 1\]

    # Start executing the action
    for i in range(1, goal\_handle.request.order):
        if goal\_handle.is\_cancel\_requested:
            goal\_handle.canceled()
            self.get\_logger().info(&#39;Goal canceled&#39;)
            return Fibonacci.Result()

        # Update Fibonacci sequence
        feedback\_msg.sequence.append(feedback\_msg.sequence\[i\] + feedback\_msg.sequence\[i-1\])

        self.get\_logger().info(&#39;Publishing feedback: &#123;0&#125;&#39;.format(feedback\_msg.sequence))

        # Publish the feedback
        goal\_handle.publish\_feedback(feedback\_msg)

        # Sleep for demonstration purposes
        time.sleep(1)

    goal\_handle.succeed()

    # Populate result message
    result = Fibonacci.Result()
    result.sequence = feedback\_msg.sequence

    self.get\_logger().info(&#39;Returning result: &#123;0&#125;&#39;.format(result.sequence))

    return result
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>minimal\_action\_server = MinimalActionServer()

# Use a MultiThreadedExecutor to enable processing goals concurrently
executor = MultiThreadedExecutor()

rclpy.spin(minimal\_action\_server, executor=executor)

minimal\_action\_server.destroy()
rclpy.shutdown()
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<p>简单起见，省略了一些函数。想要知道action是如何取消的，首先要了解action的完整传递机制。我们所做的其实是从executing到canceling中间的cancel_goal。结果是会返回一个succeeded，还不太清楚如何让他返回canceled和aborted消息。</p>
<p><img src="http://design.ros2.org/img/actions/goal_state_machine.png" alt="Action Goal State Machine"></p>
<p>下图是另一个更为实际的例子：</p>
<p><img src="http://design.ros2.org/img/actions/interaction_example_1.png" alt="Action Interaction Example 1"></p>
<p>action client首先向server发送goal request，接收后server向client发送response，并向用户自定义的处理方法（控制机器人、返回参数等）发送handle_goal，用户方法会向client发送feedback。</p>
<p>中途，client可以向server发送cancel request，server接收后，向自定义方法发送通知（用一个标识或者啥的），excution method就直接设置result，让server返回给client。这里的result就是succeed的形式。</p>
<h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><p># Copyright 2019 Open Source Robotics Foundation, Inc.</p>
<h1 id="-3"><a href="#-3" class="headerlink" title=""></a></h1><h1 id="Licensed-under-the-Apache-License-Version-2-0-the-“License”-1"><a href="#Licensed-under-the-Apache-License-Version-2-0-the-“License”-1" class="headerlink" title="Licensed under the Apache License, Version 2.0 (the “License”);"></a>Licensed under the Apache License, Version 2.0 (the “License”);</h1><h1 id="you-may-not-use-this-file-except-in-compliance-with-the-License-1"><a href="#you-may-not-use-this-file-except-in-compliance-with-the-License-1" class="headerlink" title="you may not use this file except in compliance with the License."></a>you may not use this file except in compliance with the License.</h1><h1 id="You-may-obtain-a-copy-of-the-License-at-1"><a href="#You-may-obtain-a-copy-of-the-License-at-1" class="headerlink" title="You may obtain a copy of the License at"></a>You may obtain a copy of the License at</h1><h1 id="-4"><a href="#-4" class="headerlink" title=""></a></h1><h1 id="http-www-apache-org-licenses-LICENSE-2-0-1"><a href="#http-www-apache-org-licenses-LICENSE-2-0-1" class="headerlink" title="http://www.apache.org/licenses/LICENSE-2.0"></a><a target="_blank" rel="noopener" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></h1><h1 id="-5"><a href="#-5" class="headerlink" title=""></a></h1><h1 id="Unless-required-by-applicable-law-or-agreed-to-in-writing-software-1"><a href="#Unless-required-by-applicable-law-or-agreed-to-in-writing-software-1" class="headerlink" title="Unless required by applicable law or agreed to in writing, software"></a>Unless required by applicable law or agreed to in writing, software</h1><h1 id="distributed-under-the-License-is-distributed-on-an-“AS-IS”-BASIS-1"><a href="#distributed-under-the-License-is-distributed-on-an-“AS-IS”-BASIS-1" class="headerlink" title="distributed under the License is distributed on an “AS IS” BASIS,"></a>distributed under the License is distributed on an “AS IS” BASIS,</h1><h1 id="WITHOUT-WARRANTIES-OR-CONDITIONS-OF-ANY-KIND-either-express-or-implied-1"><a href="#WITHOUT-WARRANTIES-OR-CONDITIONS-OF-ANY-KIND-either-express-or-implied-1" class="headerlink" title="WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."></a>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</h1><h1 id="See-the-License-for-the-specific-language-governing-permissions-and-1"><a href="#See-the-License-for-the-specific-language-governing-permissions-and-1" class="headerlink" title="See the License for the specific language governing permissions and"></a>See the License for the specific language governing permissions and</h1><h1 id="limitations-under-the-License-1"><a href="#limitations-under-the-License-1" class="headerlink" title="limitations under the License."></a>limitations under the License.</h1><p>from action_msgs.msg import GoalStatus</p>
<p>from example_interfaces.action import Fibonacci</p>
<p>import rclpy<br>from rclpy.action import ActionClient</p>
<p>def feedback_cb(logger, feedback):<br>    logger.info(‘Received feedback:’)</p>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>node = rclpy.create\_node(&#39;fibonacci\_action\_client&#39;)

action\_client = ActionClient(node, Fibonacci, &#39;fibonacci&#39;)

node.get\_logger().info(&#39;Waiting for action server...&#39;)

action\_client.wait\_for\_server()

goal\_msg = Fibonacci.Goal()
goal\_msg.order = 10

node.get\_logger().info(&#39;Sending goal request...&#39;)

send\_goal\_future = action\_client.send\_goal\_async(
    goal\_msg, feedback\_callback=lambda feedback: feedback\_cb(node.get\_logger(), feedback))

rclpy.spin\_until\_future\_complete(node, send\_goal\_future)

goal\_handle = send\_goal\_future.result()

if not goal\_handle.accepted:
    node.get\_logger().info(&#39;Goal rejected :(&#39;)
    action\_client.destroy()
    node.destroy\_node()
    rclpy.shutdown()
    return

node.get\_logger().info(&#39;Goal accepted :)&#39;)


get\_result\_future = goal\_handle.get\_result\_async()


try:
    rclpy.spin\_until\_future\_complete(node, get\_result\_future)
except:
    future = goal\_handle.cancel\_goal\_async()
    cancel\_response = future.result()
    print(&quot;goal canceled&quot;)
    goal\_handle.cancel\_goal()
    action\_client.destroy()
    node.destroy\_node()
    rclpy.shutdown()

result = get\_result\_future.result().result
node.get\_logger().info(&#39;Goal succeeded! Result: &#123;0&#125;&#39;.format(str(result)))

action\_client.destroy()
node.destroy\_node()
rclpy.shutdown()
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<p>这里可以看到，client中在send_goal后，得到了一个send_goal_future。这里要使用rclpy.spin_until_future_complete，确保这个future完成，否则future为NoneType。</p>
<p><img src="http://design.ros2.org/img/actions/interaction_example_1.png" alt="Action Interaction Example 1"></p>
<p>可以看到，goal request完成后，会得到一个handle_goal，在client里，使用goal_handle &#x3D; send_goal_future.result()；这个handle_goal可用于result request、cancel request。</p>
<pre><code>get\_result\_future = goal\_handle.get\_result\_async()


try:
    rclpy.spin\_until\_future\_complete(node, get\_result\_future)
except:
    future = goal\_handle.cancel\_goal\_async()
    cancel\_response = future.result()
    print(&quot;goal canceled&quot;)
    action\_client.destroy()
    node.destroy\_node()
    rclpy.shutdown()
</code></pre>
<p>这里首先发送了result request。在try中，使用rclpy.spin_until_future_complete。它的效果类似于：</p>
<pre><code>def spin\_until\_finished(self, node, future):
    while rclpy.ok():
        rclpy.spin\_once(node)
        if future.done():
            result = future.result().result
            node.get\_logger().info(&#39;Goal succeeded! Result: &#123;0&#125;&#39;.format(result.move\_distance))
            break
</code></pre>
<p>也就是，如果future没有done，就一直rclpy.spin_once。这里插一句，rclpy.spin_once非常的灵活，而rclpy.spin和rclpy.spin_until_future_complete都会阻塞主进程，如果放在qt里就必须使用其他的线程进行。</p>
<p>回到Client的代码上来，try中的 rclpy.spin_until_future_complete 被KeyInterrupt等中断后，就会执行except里的内容。这里使用了goal_handle.cancel_goal_async()，也会得到一个future。这样就终止了任务。</p>
<p>这也是我第一次正式接触python的多线程任务。下面的qt+ros2+action，更是让人头大。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/12/ros2%E5%85%A5%E9%97%A8%E4%B9%8Bacition%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/12/ros2%E5%85%A5%E9%97%A8%E4%B9%8Bacition%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">ROS2入门之Acition操作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-12 17:11:45" itemprop="dateCreated datePublished" datetime="2021-10-12T17:11:45+08:00">2021-10-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/" itemprop="url" rel="index"><span itemprop="name">robotics</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/robotics/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Action简介"><a href="#Action简介" class="headerlink" title="Action简介"></a><strong>Action简介</strong></h2><p>Action字面意义上理解就是“动作”。实际上，是对消息收发机制的一个上层包装。在Dolly避障中，我们让Dolly在没有避开障碍物前，都执行一个恒定的转向动作。实际上这就是一个Action。<br>一个Acition一般由三部分组成：</p>
<ol>
<li>goal,目标</li>
<li>feedback，在action执行过程中的反馈；</li>
<li>result，结果。</li>
</ol>
<p>目标、反馈和结果之间不一定要相同——事实上，他们往往是不同的。例如我们去拿一个苹果，目标是苹果的位置，feedback是手的位置，result是“成功”或“失败”这样一条信息。Action也是类似的。</p>
<p>使用Action的好处主要在于，可以随时终止Action，但保留当前的机器人状态——例如，机器人已经走了一段路，此时遇到障碍物时终止Action。有人可能会说了，用Dolly的时候也没见用Action呀？确实如此，所以说Action是一个上层包装，目的是为了配合server和client让项目架构看起来更简洁，同时feedback功能也便于调试.</p>
<h2 id="创建自己的Action"><a href="#创建自己的Action" class="headerlink" title="创建自己的Action"></a><strong>创建自己的Action</strong></h2><p>根据目标、反馈、结果的不同，action的形式也是多种多样，以至于ROS2难以提前全部预设。因此，往往需要创建自己的action。</p>
<p>如果是使用c++写的ROS2包，换句话说，如果在create package的时候使用了ament_cmake选项的，那么下一步就可以不用继续了。反之，如果当初创建package的时候使用了ament_python，也就是基于python写的ROS2包，那么还需要在当前工作环境下，再使用ament_cmake创建一个c++的ROS2包。原因是，现在ament_python还不支持对自定义Action的编译，只能另外创建一个c++的pkg来编译自定义Action编译。</p>
<p>假设，现在我们使用ament_python创建了一个名为toturial的package，就像图片中你看到的那样：</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image-5.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-5.png"></a></p>
<p>那么现在，将路径切换到src，输入：</p>
<p>ros2 pkg create –build-type ament_cmake my_action</p>
<p>然后，在my_action中创建一个名为action的文件夹，在里面新建一个.action文件，名为Fibonacci.action，也就是斐波那契数列。文件内容如下：</p>
<h2 id="int32-order"><a href="#int32-order" class="headerlink" title="int32 order"></a>int32 order</h2><h2 id="int32-sequence"><a href="#int32-sequence" class="headerlink" title="int32[] sequence"></a>int32[] sequence</h2><p>int32[] partial_sequence</p>
<p>你可以看到，这个action文件由三部分组成，每辆各部分之间用“—”隔开。从上到下，他们分别代表了一个action消息的goal、feedback、result数据类型。在数据类型后的，是数据的名称。类似src和msg的定义，也可以这么写：</p>
<h2 id="int64-aint64-bint64-c"><a href="#int64-aint64-bint64-c" class="headerlink" title="int64 aint64 bint64 c"></a>int64 a<br>int64 b<br>int64 c</h2><h2 id="int32-sequence-1"><a href="#int32-sequence-1" class="headerlink" title="int32[] sequence"></a>int32[] sequence</h2><p>int32[] partial_sequence</p>
<p>值得注意的是，不类似于msg这种有很多预设类型的数据类型，action更多可以理解为是一个函数的输入、调试输出和返回值。恐怕很少有固定输入、调试输出和返回值的函数模板吧。这又一次说明了，为什么我们要自定义action类型。</p>
<p>完成上面的步骤后，文件夹结构应该是这样的：</p>
<p><a target="_blank" rel="noopener" href="http://www.lxshaw.com/wp-content/uploads/2021/10/image-6.png"><img src="http://www.lxshaw.com/wp-content/uploads/2021/10/image-6.png"></a></p>
<p>然后，需要对CMakeLists.txt做一些修改。在最后一行前，插入：</p>
<p>find_package(rosidl_default_generators REQUIRED)</p>
<p>rosidl_generate_interfaces(${PROJECT_NAME}<br>  “action&#x2F;Fibonacci.action”<br>)</p>
<p>并且，在package.xml中，加入：</p>
<p>  <depend>action_msgs</depend></p>
<p>  &lt;member_of_group&gt;rosidl_interface_packages&lt;&#x2F;member_of_group&gt;<br>  &lt;test_depend&gt;ament_lint_auto&lt;&#x2F;test_depend&gt;<br>  &lt;test_depend&gt;ament_lint_common&lt;&#x2F;test_depend&gt;</p>
<p>然后就可以编译了，在workspace的主路径下，输入：</p>
<p>colcon build –packages-select my_action</p>
<p>编译花费的时间会比较长，在我的电脑上花费了一分多钟，比较奇怪。编译完成后，就可以在该工作路径下的其他packages中调用action了。</p>
<h2 id="写一个action-server"><a href="#写一个action-server" class="headerlink" title="写一个action server"></a>写一个action server</h2><p>在toturial包中创建action_server.py，内容：</p>
<p>import rclpy<br>from rclpy.action import ActionServer<br>from rclpy.node import Node<br>import time<br>from my_action.action import Fibonacci</p>
<p>class FibonacciActionServer(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;fibonacci\_action\_server&#39;)
    self.\_action\_server = ActionServer(
        self,
        Fibonacci,
        &#39;fibonacci&#39;,
        self.execute\_callback)

def execute\_callback(self, goal\_handle):
    self.get\_logger().info(&#39;Executing goal...&#39;)

    feedback\_msg = Fibonacci.Feedback()
    feedback\_msg.partial\_sequence = \[0, 1\]

    for i in range(1, goal\_handle.request.order):
        feedback\_msg.partial\_sequence.append(
            feedback\_msg.partial\_sequence\[i\] + feedback\_msg.partial\_sequence\[i-1\])
        self.get\_logger().info(&#39;Feedback: &#123;0&#125;&#39;.format(feedback\_msg.partial\_sequence))
        goal\_handle.publish\_feedback(feedback\_msg)
        time.sleep(1)

    goal\_handle.succeed()

    result = Fibonacci.Result()
    result.sequence = feedback\_msg.partial\_sequence
    return result
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>fibonacci\_action\_server = FibonacciActionServer()

rclpy.spin(fibonacci\_action\_server)
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<h3 id="code-examination"><a href="#code-examination" class="headerlink" title="code examination"></a>code examination</h3><p>开头导入一些包，以及我们自定义的action数据类型。</p>
<p>import rclpy<br>from rclpy.action import ActionServer<br>from rclpy.node import Node<br>import time<br>from my_action.action import Fibonacci</p>
<p>在class中，初始化时，创建一个ActionServer，方式和Subscriber一类的很像，也是指定数据类型、action name（对标topic），以及绑定的函数。</p>
<p>class FibonacciActionServer(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;fibonacci\_action\_server&#39;)
    self.\_action\_server = ActionServer(
        self,
        Fibonacci,
        &#39;fibonacci&#39;,
        self.execute\_callback)
</code></pre>
<p>在绑定的函数execute_callback中，参数为goal_handle，也就是action client传入的数据。首先初始化一个feedback_msg，其类型为Fibonacci.Feedback()。实际上，就是action中三块内容的最后那一块，包含了nt32[] partial_sequence。使用Feedback所包含的数据名词进行赋值。</p>
<pre><code>    feedback\_msg = Fibonacci.Feedback()
    feedback\_msg.partial\_sequence = \[0, 1\]
</code></pre>
<p>接下来，是处理环节。这个server的作用是，接收到一个order后，给出这个数量长度的斐波那契数列。所以，可以看到order中的数据，是通过goal_handle.requests.order给出的。</p>
<p>随后就是斐波那契数列数列的计算过程，不做赘述。</p>
<p>接着，使用goal_handle.publish_feedback这个方法，向action client返回feedback，参数为feedback_msgs。</p>
<pre><code>    for i in range(1, goal\_handle.request.order):
        feedback\_msg.partial\_sequence.append(
            feedback\_msg.partial\_sequence\[i\] + feedback\_msg.partial\_sequence\[i-1\])
        self.get\_logger().info(&#39;Feedback: &#123;0&#125;&#39;.format(feedback\_msg.partial\_sequence))
        goal\_handle.publish\_feedback(feedback\_msg)
        time.sleep(1)
</code></pre>
<p>接下来，当action server成功完成goal后，需要讲goal_handle的状态设置为succeed，否则程序会默认goal被中止了，也就不会返回result。因此完成goal后，需要声明：</p>
<pre><code>    goal\_handle.succeed()
</code></pre>
<p>最后就是返回Result了，因为action中定义的Result类型和Feedback是一样的，都是int32[]，所以可以直接赋值。</p>
<pre><code>    result = Fibonacci.Result()
    result.sequence = feedback\_msg.partial\_sequence
    return result
</code></pre>
<p>在最后，依然是再熟悉不过的main部分。最后加入if部分使得可以直接通过python3运行：</p>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>fibonacci\_action\_server = FibonacciActionServer()

rclpy.spin(fibonacci\_action\_server)
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<h3 id="Server总结"><a href="#Server总结" class="headerlink" title="Server总结"></a>Server总结</h3><p>小小总结一下，一个action server包括：</p>
<ol>
<li>创建ActionServer</li>
<li>创建绑定函数</li>
<li>接收信息后处理</li>
<li>处理时发送feedback，一般用do while</li>
<li>结束后设置goal为succeed，发送result</li>
</ol>
<h2 id="写一个Action-client"><a href="#写一个Action-client" class="headerlink" title="写一个Action client"></a>写一个Action client</h2><p>实际上这里的Action server已经可以用了。运行python3 action_server.py，然后在另一个控制台，输入</p>
<p>ros2 action list</p>
<p>就能看到&#x2F;fibonacci这个action了。那么，该如何向这个action发送命令呢？需要输入：</p>
<p>ros2 action send_goal fibonacci my_action&#x2F;action&#x2F;Fibonacci “{order: 5}”</p>
<p>执行前需要source一下install目录下的setup.bash。过一会儿，就能看到返回结果：</p>
<p>Waiting for an action server to become available…<br>Sending goal:<br>     order: 5</p>
<p>Goal accepted with ID: b8899de227e04067baaa9ffc72f61e65</p>
<p>Result:<br>    sequence:</p>
<ul>
<li>0</li>
<li>1</li>
<li>1</li>
<li>2</li>
<li>3</li>
<li>5</li>
</ul>
<p>Goal finished with status: SUCCEEDED</p>
<p>那问题来了，为什么要用action client呢？原因很简单——这样我们是看不到feedback的。我们当然希望任务执行中能看到feedback，这样如果执行出现机器探测不到但是人能够察觉出的异常，就可以快速中止任务。因此，需要一个能够观察到feedback的action client。</p>
<p>再创建一个action_client.py，内容：</p>
<p>import rclpy<br>from rclpy.action import ActionClient<br>from rclpy.node import Node</p>
<p>from my_action.action import Fibonacci</p>
<p>class FibonacciActionClient(Node):</p>
<pre><code>def \_\_init\_\_(self):
    super().\_\_init\_\_(&#39;fibonacci\_action\_client&#39;)
    self.\_action\_client = ActionClient(self, Fibonacci, &#39;fibonacci&#39;)

def send\_goal(self, order):
    goal\_msg = Fibonacci.Goal()
    goal\_msg.order = order

    self.\_action\_client.wait\_for\_server()

    self.\_send\_goal\_future = self.\_action\_client.send\_goal\_async(goal\_msg, feedback\_callback=self.feedback\_callback)

    self.\_send\_goal\_future.add\_done\_callback(self.goal\_response\_callback)

def goal\_response\_callback(self, future):
    goal\_handle = future.result()
    if not goal\_handle.accepted:
        self.get\_logger().info(&#39;Goal rejected :(&#39;)
        return

    self.get\_logger().info(&#39;Goal accepted :)&#39;)

    self.\_get\_result\_future = goal\_handle.get\_result\_async()
    self.\_get\_result\_future.add\_done\_callback(self.get\_result\_callback)

def get\_result\_callback(self, future):
    result = future.result().result
    self.get\_logger().info(&#39;Result: &#123;0&#125;&#39;.format(result.sequence))
    rclpy.shutdown()

def feedback\_callback(self, feedback\_msg):
    feedback = feedback\_msg.feedback
    self.get\_logger().info(&#39;Received feedback: &#123;0&#125;&#39;.format(feedback.partial\_sequence))
</code></pre>
<p>def main(args&#x3D;None):<br>    rclpy.init(args&#x3D;args)</p>
<pre><code>action\_client = FibonacciActionClient()

action\_client.send\_goal(10)

rclpy.spin(action\_client)
</code></pre>
<p>if __name__ &#x3D;&#x3D; ‘__main__‘:<br>    main()</p>
<h3 id="code-examination-1"><a href="#code-examination-1" class="headerlink" title="code examination"></a>code examination</h3><p>类似的导入暂且不提，直接来看主体部分。首先，声明ActionClient需要action的类型和action topic。</p>
<p>然后，我们定义了一个send_goal函数，这里有一些方法需要解释一下意思。首先是wait_for_server()，这个方法命令client搜寻相应action topic是否被创建，也就是相应的action server是否已经启动。如果没有，则等待。</p>
<p>接下来，使用send_goal_async来发送goal_msg。这个方法会返回一个”future“，这个future描述了当前goal_send的状态。这里还有一个feedback_callback参数，这个下面再说。</p>
<p>再然后，我们先为goal_send声明一个callback，使用add_done_callback这个方法，其参数为一个函数，接下来就会讲到这个goal_response_callback的原理。这个callback指代了goal_send的状态，根据server接受goal的情况，可能是reject或者是accept。</p>
<pre><code>def send\_goal(self, order):
    goal\_msg = Fibonacci.Goal()
    goal\_msg.order = order
</code></pre>
<p>le<br>        self._action_client.wait_for_server()</p>
<pre><code>    self.\_send\_goal\_future = self.\_action\_client.send\_goal\_async(goal\_msg, feedback\_callback=self.feedback\_callback)

    self.\_send\_goal\_future.add\_done\_callback(self.goal\_response\_callback)
</code></pre>
<p>在goal_response_callback里，接受future作为参数。首先，获取当前goal_handle的状态。</p>
<p>然后，根据状态来确定下一步怎么进行。如果goal被拒绝了，则直接return不再继续。如果接受了，那么和前面一块send_goal函数中相似，再创建一个future，不过这个future是描述result的状态的，使用的方法也不同，变为get_result_async()，主体则是goal_handle本身。</p>
<p>类似的，也为result future声明一个callback，来返回处理结果。参数为get_result_callback——是的，又要有一个新的函数了。</p>
<pre><code>def goal\_response\_callback(self, future):
    goal\_handle = future.result()
    if not goal\_handle.accepted:
        self.get\_logger().info(&#39;Goal rejected :(&#39;)
        return

    self.get\_logger().info(&#39;Goal accepted :)&#39;)

    self.\_get\_result\_future = goal\_handle.get\_result\_async()
    self.\_get\_result\_future.add\_done\_callback(self.get\_result\_callback)
</code></pre>
<p>再get_result_callback里，写的就是goal_handle的状态了。future.result()是Fibonacci action，再后面的result则是真正返回的内容，也就是包含了int32[] sequence的action result。</p>
<p>在这个脚本里，设置为完成goal后就关闭该client。</p>
<pre><code>def get\_result\_callback(self, future):
    result = future.result().result
    self.get\_logger().info(&#39;Result: &#123;0&#125;&#39;.format(result.sequence))
    rclpy.shutdown()
</code></pre>
<p>前面提到了feedback，那么我们怎么通过client来获取feedback呢？首先，创建一个函数，其参数内容为feedback_msg。这个feedback_msg的类型是 Fibonacci action 。</p>
<p>下一步，获取feedback数据，也就是feedback_msg.feedback.partial_sequence，partial_sequance是我们自己定义的数据的名称。</p>
<pre><code>def feedback\_callback(self, feedback\_msg):
    feedback = feedback\_msg.feedback
    self.get\_logger().info(&#39;Received feedback: &#123;0&#125;&#39;.format(feedback.partial\_sequence))
</code></pre>
<p>下面的问题是，把这个函数绑定到哪里呢？这一步看起来不太直观，绑定的位置是发送goal的函数参数，也就是self._send_goal_future &#x3D; self._action_client.send_goal_async(goal_msg, feedback_callback&#x3D;self.feedback_callback)。</p>
<pre><code>def feedback\_callback(self, feedback\_msg):
    feedback = feedback\_msg.feedback
    self.get\_logger().info(&#39;Received feedback: &#123;0&#125;&#39;.format(feedback.partial\_sequence))
</code></pre>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>写一个action client似乎比client还要复杂——其实并不，action client基本上是模板化的，修改的地方不多。写一个action client的流程是：</p>
<ol>
<li>创建ActionClient，声明action类型和action topic</li>
<li>创建一个send_goal函数，参数为order，里面要包含：<ol>
<li>声明goal_msg的类型（xxxx.Goal()）</li>
<li>令goal_msg.order &#x3D; order</li>
<li>wait_for_server</li>
<li>使用action client的send_goal_async方法发送goal_msg，返回send_goal_future</li>
<li>为send_goal_future声明callback，绑定callback函数</li>
</ol>
</li>
<li>创建send_goal的callback函数，参数为future<ol>
<li>根据future的结果决定下一步（跳出或继续）</li>
<li>使用goal_handle的get_result_async方法获取result_future</li>
<li>为result_future声明callback，绑定callback函数</li>
</ol>
</li>
<li>创建result_future的callback函数，参数为future<ol>
<li>根据result执行相应命令（打印到控制台或者别的什么）</li>
</ol>
</li>
<li>创建feedback的callback函数，参数为feedback_msg<ol>
<li>根据feedback_msg执行相应命令（中止action等）</li>
<li>绑定到send_goal_async</li>
</ol>
</li>
</ol>
<p>难点主要在，难以分清楚action消息、action消息的组成、action消息各组成的数据。例如：</p>
<ol>
<li>goal_msg是action消息的组成，也就是Fibonacci.Goal()</li>
<li>result的future.result()是action消息。</li>
<li>feedback_msg是action消息。</li>
</ol>
<p>所以应当说这一块ROS2做的不是很好，类型不明显。修改代码的时候，应当注意各参数的类型。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>打开action_server后，使用python3运行该脚本：</p>
<p>[INFO] [1634029628.139290300] [fibonacci_action_client]: Goal accepted :)<br>[INFO] [1634029628.140118300] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1])<br>[INFO] [1634029629.128878500] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2])<br>[INFO] [1634029630.130619100] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3])<br>[INFO] [1634029631.136094700] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5])<br>[INFO] [1634029632.139388800] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5, 8])<br>[INFO] [1634029633.139042600] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5, 8, 13])<br>[INFO] [1634029634.141083400] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5, 8, 13, 21])<br>[INFO] [1634029635.143444400] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5, 8, 13, 21, 34])<br>[INFO] [1634029636.145086200] [fibonacci_action_client]: Received feedback: array(‘i’, [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55])<br>[INFO] [1634029637.150578100] [fibonacci_action_client]: Result: array(‘i’, [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55])</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wonderful-sea-04900b000.6.azurestaticapps.net/2021/10/12/%E9%A2%91%E5%9F%9F%E5%9B%BE%E5%83%8F%E5%8F%98%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Lin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shawn Lin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/12/%E9%A2%91%E5%9F%9F%E5%9B%BE%E5%83%8F%E5%8F%98%E6%8D%A2/" class="post-title-link" itemprop="url">频域图像变换</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-12 11:26:44" itemprop="dateCreated datePublished" datetime="2021-10-12T11:26:44+08:00">2021-10-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-27 15:52:33" itemprop="dateModified" datetime="2025-03-27T15:52:33+08:00">2025-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/" itemprop="url" rel="index"><span itemprop="name">thought</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/thought/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课堂笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>像素点的颜色，实际上是不同频率的光的叠加</p>
<h2 id="傅里叶变换"><a href="#傅里叶变换" class="headerlink" title="傅里叶变换"></a>傅里叶变换</h2><ol>
<li>周期信号可以表示为谐波关系的正弦信号的加权和</li>
<li>非周期信号可以表示为谐波关系的正弦函数的积分的加权和</li>
</ol>
<p>横看成岭侧成峰</p>
<p>在频域中没有位置空间的概念，类似于一束白光打到一幅画上，请问反射的光谱是怎样的。调换像素顺序也不会影响频域。</p>
<p>光谱是连续的，但是傅里叶变换只能是离散的，所以傅里叶变换实际上是一种近似。</p>
<p>在物理上光谱是一维的，但是数学上傅里叶变换完全可以用二维的，对应图像的x和y轴。</p>
<p>主要在统计上有意义。</p>
<h2 id="傅里叶变换的性质"><a href="#傅里叶变换的性质" class="headerlink" title="傅里叶变换的性质"></a>傅里叶变换的性质</h2><ol>
<li>平移定理</li>
<li>移中性</li>
<li>旋转性：频域跟着空域转</li>
<li>尺度性：频域和空域成反比（一个*a另一个*1&#x2F;a）</li>
<li>均值性</li>
<li>卷积定理，2D下也成立</li>
</ol>
<p>变换到频域空间后，根据需求（去除高频&#x2F;低频），得到滤波器后，再变换回到空域空间。在频域空间下指导空域空间的滤波器设计。</p>
<h2 id="频域增强"><a href="#频域增强" class="headerlink" title="频域增强"></a>频域增强</h2><ol>
<li>噪声一般是高频的</li>
<li>用于去除周期性的噪声（什么时候有周期性的噪声）</li>
<li>低通&#x2F;高通滤波</li>
</ol>
<h2 id="处理步骤"><a href="#处理步骤" class="headerlink" title="处理步骤"></a>处理步骤</h2><ol>
<li>转换到频域<ol>
<li>中心变换</li>
<li>计算出傅里叶变换</li>
</ol>
</li>
<li>在频域滤波<ol>
<li>选择一个变换函数H(u, v)，也就是滤波器</li>
<li>计算出函数的反傅里叶变换</li>
</ol>
</li>
<li>转换回空域<ol>
<li>用(-1)^(x+y)乘以上面结果的实部，得到目标图像</li>
</ol>
</li>
</ol>
<h2 id="低通滤波：平滑"><a href="#低通滤波：平滑" class="headerlink" title="低通滤波：平滑"></a>低通滤波：平滑</h2><p>高频对图像通道贡献很小，但是对细节贡献很大</p>
<p>Butterworth低通滤波器（BLPF）</p>
<ol>
<li>物理上可实现</li>
<li>减少振铃效应（波纹）</li>
</ol>
<p>高斯低通滤波器</p>
<ol>
<li>频域和空域都是高斯函数</li>
<li>没有振铃效应</li>
<li>优于Butterworth</li>
</ol>
<h3 id="应用："><a href="#应用：" class="headerlink" title="应用："></a>应用：</h3><ol>
<li>字符识别</li>
<li>平滑</li>
</ol>
<h2 id="高通滤波：锐化"><a href="#高通滤波：锐化" class="headerlink" title="高通滤波：锐化"></a>高通滤波：锐化</h2><h2 id="带通和带阻滤波"><a href="#带通和带阻滤波" class="headerlink" title="带通和带阻滤波"></a>带通和带阻滤波</h2><h2 id="陷波滤波器"><a href="#陷波滤波器" class="headerlink" title="陷波滤波器"></a>陷波滤波器</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xiao Lin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">173</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Lin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
